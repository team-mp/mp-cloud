{
  "Name": "工事見積依頼リマインド処理",
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.SaveLoad.DailyScheduleTriggerSaveData, ServerDesignerCommon",
      "StartDateTime": 45905.833333333336,
      "ScheduleRunInDebugServer": false
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "設計待ちST",
      "TableValue": {
        "TableName": "m_construction_estimate_status",
        "TableValueType": 1,
        "BindingInfos": [
          {
            "GUID": "b6b343c3-4a20-433e-990a-6f079e2dc689",
            "BindingInfo": {
              "TableName": "m_construction_estimate_status",
              "ColumnName": "construction_estimate_status_id",
              "GUID": "f0497f5e-62b9-44cc-ba37-1f9e13f3983a"
            },
            "ColumnName": "工事見積ステータスID"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
          "ColumnBindingInfo": {
            "TableName": "m_construction_estimate_status",
            "ColumnName": "design_wait_flg",
            "GUID": "e99f6fe7-2e10-4629-a2d9-e225a87ef2ae"
          },
          "Value": "1"
        }
      },
      "ID": "5cf6c2ba2ab14679979a2f5e98e6abdb"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "工事見積情報",
      "TableValue": {
        "TableName": "t_object_construction_estimate",
        "BindingInfos": [
          {
            "GUID": "ff31b04d-1f1f-4c2e-9539-52fcaaea2437",
            "BindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "construction_estimate_id",
              "GUID": "eec48647-7e90-4623-ad4a-80165ca6267a"
            },
            "ColumnName": "工事見積ID"
          },
          {
            "GUID": "4cbdb38a-957a-4f61-81d6-1492b4633b9c",
            "BindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "construction_customer_id",
              "GUID": "4f6ef513-00d7-41c7-94e7-f71a9973f220",
              "RelationBinding": {
                "RelatedTable": "m_customer",
                "RelatedColumn": "customer_id",
                "DisplayColumn": "customer_name"
              }
            },
            "ColumnName": "工事見積会社名"
          },
          {
            "GUID": "deb5513d-0c68-408c-adf8-288bc01f9303",
            "BindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "estimate_reminder_date",
              "GUID": "750bbe63-4fb2-442e-b519-c6265cab2f92"
            },
            "ColumnName": "見積リマインド日"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "SubConditions": [
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "object_order_id",
                "GUID": "578f2080-679e-4f7f-a45c-8e0f752f93bc",
                "RelationBinding": {
                  "RelatedTable": "t_object_order",
                  "RelatedColumn": "object_order_id",
                  "DisplayColumn": "order_status_id",
                  "NextRelationBinding": {
                    "RelatedTable": "m_order_status",
                    "RelatedColumn": "order_status_id",
                    "DisplayColumn": "complete_flg"
                  }
                }
              },
              "Value": "0"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "object_order_id",
                "GUID": "99660f5f-35c8-48cb-a0cd-fcab6af797fc",
                "RelationBinding": {
                  "RelatedTable": "t_object_order",
                  "RelatedColumn": "object_order_id",
                  "DisplayColumn": "active_flg"
                }
              },
              "Value": "1"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "estimate_reminder_flg",
                "GUID": "05d7907c-104b-4fe0-bc93-e9366411a83c"
              },
              "Value": "1"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "estimate_reminder_date",
                "GUID": "d79596be-aaa2-4efa-a9e6-e2c662cf386c"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=TODAY()"
              }
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "construction_estimate_status_id",
                "GUID": "8ffb2ead-6313-4b5d-823e-d962b33af16c"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=設計待ちST.工事見積ステータスID"
              }
            }
          ]
        },
        "OrderBySqlCondition": {
          "OrderByColumns": [
            {
              "ColumnBindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "construction_customer_id",
                "GUID": "1e08c3ef-e8df-409e-9afd-34ff8b811ce7"
              },
              "Order": 0
            }
          ]
        }
      },
      "ID": "7b183fc0232f40f898a07703478e3a21"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "見積催促中ST",
      "TableValue": {
        "TableName": "m_construction_estimate_status",
        "TableValueType": 1,
        "BindingInfos": [
          {
            "GUID": "89dff273-d719-4cb6-ab40-c095153fdaf9",
            "BindingInfo": {
              "TableName": "m_construction_estimate_status",
              "ColumnName": "construction_estimate_status_id",
              "GUID": "77cce5b2-2ce4-45e5-ae0f-e87af3cdc54a"
            },
            "ColumnName": "工事見積ステータスID"
          },
          {
            "GUID": "5ae495b7-c265-4387-8b5c-a7c4d3d6f0fb",
            "BindingInfo": {
              "TableName": "m_construction_estimate_status",
              "ColumnName": "construction_status_id",
              "GUID": "8d4b0560-de13-445c-a76b-a60b547509f0"
            },
            "ColumnName": "工事ステータスID"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
          "ColumnBindingInfo": {
            "TableName": "m_construction_estimate_status",
            "ColumnName": "estimate_reminder_flg",
            "GUID": "ce95ddfa-a161-40d9-bed8-0db50f078405"
          },
          "Value": "1"
        },
        "NullFormulaValueQueryPolicy": 0
      },
      "ID": "7b9c57ceb3a145aea61b41166aefd15a"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "依頼テンプレートID1",
      "TableValue": {
        "TableName": "m_mail_template",
        "OnlyGetValue": true,
        "TableValueType": 0,
        "BindingInfos": [
          {
            "GUID": "0833125b-bb6c-467e-a66f-36bff4bd1b14",
            "BindingInfo": {
              "TableName": "m_mail_template",
              "ColumnName": "template_id",
              "GUID": "c9b50b5a-bb4d-4d34-9d62-a89f80bc9d4c"
            },
            "ColumnName": "template_id"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
          "ColumnBindingInfo": {
            "TableName": "m_mail_template",
            "ColumnName": "system_button_name",
            "GUID": "983805d0-2dc7-4638-846c-45f57b4fb7bc"
          },
          "Value": "他社施工見積依頼通知ボタン"
        },
        "NullFormulaValueQueryPolicy": 0
      },
      "ID": "9ce606346f464a77bf93e7542b9c6b82",
      "Comments": "他社施工用"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "依頼テンプレートID2",
      "TableValue": {
        "TableName": "m_mail_template",
        "OnlyGetValue": true,
        "TableValueType": 0,
        "BindingInfos": [
          {
            "GUID": "1828ba0b-1a2b-4d49-a0d4-5c1cdf6328b3",
            "BindingInfo": {
              "TableName": "m_mail_template",
              "ColumnName": "template_id",
              "GUID": "c9b50b5a-bb4d-4d34-9d62-a89f80bc9d4c"
            },
            "ColumnName": "template_id"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
          "ColumnBindingInfo": {
            "TableName": "m_mail_template",
            "ColumnName": "system_button_name",
            "GUID": "983805d0-2dc7-4638-846c-45f57b4fb7bc"
          },
          "Value": "工事請負見積依頼通知ボタン"
        },
        "NullFormulaValueQueryPolicy": 0
      },
      "ID": "394e5f5eec8542a8a2e4cfd031e5fe8d",
      "Comments": "工事請負用"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "催促テンプレート",
      "TableValue": {
        "TableName": "m_mail_template",
        "TableValueType": 1,
        "BindingInfos": [
          {
            "GUID": "6c0df9d2-a0a4-49ac-aae4-7bd859e56628",
            "BindingInfo": {
              "TableName": "m_mail_template",
              "ColumnName": "template_id",
              "GUID": "9120df82-2f70-40d7-9a68-ea4db19c79a7"
            },
            "ColumnName": "テンプレートID"
          },
          {
            "GUID": "0b51a6b5-4eaa-4dfb-b519-1b62eff5251d",
            "BindingInfo": {
              "TableName": "m_mail_template",
              "ColumnName": "post_type",
              "GUID": "1f3c1265-391d-48d2-bb2b-2baaba449f66"
            },
            "ColumnName": "宛先区分"
          },
          {
            "GUID": "a12975de-e58d-41a0-a0fd-2af941655ce0",
            "BindingInfo": {
              "TableName": "m_mail_template",
              "ColumnName": "subject",
              "GUID": "c1094fde-e3f1-4fca-8c24-49386c3eb854"
            },
            "ColumnName": "件名"
          },
          {
            "GUID": "fe9ca810-d062-47a2-8da5-1b08c39ae6e5",
            "BindingInfo": {
              "TableName": "m_mail_template",
              "ColumnName": "body",
              "GUID": "9148655b-a385-4709-8ea5-b17b387ea508"
            },
            "ColumnName": "本文"
          },
          {
            "GUID": "6a44d044-c2c4-41a2-a74e-e68f802416d2",
            "BindingInfo": {
              "TableName": "m_mail_template",
              "ColumnName": "signature_id",
              "GUID": "025debb9-4bd6-4ab2-b68a-7bad3644df8a",
              "RelationBinding": {
                "RelatedTable": "m_mail_signature",
                "RelatedColumn": "signature_id",
                "DisplayColumn": "signature"
              }
            },
            "ColumnName": "署名"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
          "ColumnBindingInfo": {
            "TableName": "m_mail_template",
            "ColumnName": "system_button_name",
            "GUID": "dbb8c833-ce99-43cb-8b14-7d4127f98ce6"
          },
          "Value": "工事見積リマインド通知ボタン"
        },
        "NullFormulaValueQueryPolicy": 0
      },
      "ID": "06ecb753b61f4445887a678b178dfd1a"
    },
    {
      "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
      "ServerCommandName": "営業日取得",
      "Parameters": [
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_指定日",
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=TODAY()"
          }
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_日数",
          "Value": "1"
        }
      ],
      "ReturnPropertiesTo": [
        {
          "ResultPropertyName": "R_営業日",
          "ResultTo": {
            "SerializeProperty": "V_翌営業日"
          },
          "Remark": "営業日計算後の日付が返却される"
        }
      ],
      "RefreshAfterFinish": true,
      "CheckDataValidation": true
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "V_翌リマインド日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(V_翌営業日,\"yyyy年mm月dd日\")"
      },
      "ID": "8cdc962d7be44ab297b332a8e588509f",
      "Comments": "テキスト形式に変換"
    },
    {
      "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
      "LoopInfo": {
        "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
        "LoopCount": {
          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
          "SerializeProperty": "=工事見積情報"
        },
        "LoopItemParamName": "Item"
      },
      "CommandList": [
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "工事見積依頼メール履歴",
          "TableValue": {
            "TableName": "t_mail_history",
            "TableValueType": 1,
            "BindingInfos": [
              {
                "GUID": "b25ce1b7-4b12-433f-afa1-a40525ba954a",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "sender_type",
                  "GUID": "c4eac3ad-3f01-4ad7-a086-b093881a6300"
                },
                "ColumnName": "送信元区分"
              },
              {
                "GUID": "a0d6052b-1161-41db-a75e-a46e42cb85d6",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "post_type",
                  "GUID": "8742fb0e-3e08-4ed0-afc1-1fea8f882216"
                },
                "ColumnName": "宛先区分"
              },
              {
                "GUID": "8fafce38-24b0-4985-92c4-65a15c91ebcc",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "sender_address",
                  "GUID": "d39f7f7b-33d5-4fe1-8d68-c72c49d9cdeb"
                },
                "ColumnName": "差出人アドレス"
              },
              {
                "GUID": "fd7140a5-ef47-4bb8-8121-6a8f908e5ca1",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "to_user_ids",
                  "GUID": "39558130-41e5-48ce-b933-e5375e744df8"
                },
                "ColumnName": "TOユーザーIDs"
              },
              {
                "GUID": "0b95eb38-302e-44e6-a139-454d6fec3586",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "to_add_address",
                  "GUID": "56968c79-cde1-4dcb-94aa-02cdf78aea0e"
                },
                "ColumnName": "TO追加アドレス"
              },
              {
                "GUID": "e0e3d829-85d7-4387-9f28-413205a72151",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "to_address",
                  "GUID": "32d9346c-6c04-4e89-aea1-1ba3264e6302"
                },
                "ColumnName": "宛先TO"
              },
              {
                "GUID": "af92cb5d-c58f-4e10-8a80-6cb9270fc053",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "cc_user_ids",
                  "GUID": "66953327-d5a6-4623-ba74-173043684923"
                },
                "ColumnName": "CCユーザーIDs"
              },
              {
                "GUID": "175e8e5f-dbf5-4127-b17c-e44a3db0f0c6",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "cc_add_address",
                  "GUID": "f8b5857a-d1d6-4d52-820c-56d9a853f227"
                },
                "ColumnName": "CC追加アドレス"
              },
              {
                "GUID": "087fa974-37b8-44c7-a6dc-67d657da68d1",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "cc_address",
                  "GUID": "332ea7c0-2a22-474d-8a6b-35aaffb19261"
                },
                "ColumnName": "宛先CC"
              },
              {
                "GUID": "2d42a7c0-a83f-4f47-a0a0-59347b9a3e5d",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "subject",
                  "GUID": "8e7a4380-8660-4747-9276-6badc2b98152"
                },
                "ColumnName": "件名"
              },
              {
                "GUID": "6e446056-353f-4b6f-91fe-3a1d74698fa8",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "body",
                  "GUID": "5943a2fc-747d-4fab-a0fd-a3a1d1afcfdd"
                },
                "ColumnName": "本文"
              },
              {
                "GUID": "5fb4ad96-4b32-463c-a961-4d457b041366",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "template_id",
                  "GUID": "e14d290f-ac6a-44ac-b299-b9e78f400024"
                },
                "ColumnName": "テンプレートID"
              },
              {
                "GUID": "9f8a20b2-4f6f-478a-9054-3aed48dc1e0c",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "object_order_id",
                  "GUID": "1dc4da32-3b11-4bbe-82c6-eb286a7dfb4d"
                },
                "ColumnName": "申込ID"
              },
              {
                "GUID": "4325eb04-f0e5-4918-9127-9c96727a8884",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "survey_id",
                  "GUID": "d5fad4f9-971e-46b0-80e0-3907f5c4dae2"
                },
                "ColumnName": "調査ID"
              },
              {
                "GUID": "49964ac0-b5a7-4e7b-acde-d9d9f1f37ec9",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "surveying_id",
                  "GUID": "fc0a9a68-3cd6-4ebf-9a94-85d49d1f47a6"
                },
                "ColumnName": "測量ID"
              },
              {
                "GUID": "1fa4e354-832e-441e-8884-1bf11e9c8053",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "analysis_id",
                  "GUID": "cde9b45e-669a-49b2-a140-38e0cef4c7e6"
                },
                "ColumnName": "解析ID"
              },
              {
                "GUID": "d0d4d031-3710-44fe-b8b1-c294740e7c4a",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "compaction_id",
                  "GUID": "31981ff5-ea01-4c02-a8c3-bfaf37013f24"
                },
                "ColumnName": "転圧ID"
              },
              {
                "GUID": "4051bf63-2731-4d62-a1ee-d7fe63642ac2",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "construction_estimate_id",
                  "GUID": "428654b9-1604-40ea-89c4-a54478067e56"
                },
                "ColumnName": "工事見積ID"
              },
              {
                "GUID": "4572c77a-306e-4510-80c5-f31ae3ea6266",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "construction_id",
                  "GUID": "729220e4-3237-49ea-b13d-a165e4c094b6"
                },
                "ColumnName": "工事ID"
              },
              {
                "GUID": "1dfd5fc2-bab9-4abb-bc6c-3cefab0432d3",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "warranty_id",
                  "GUID": "332cf355-876b-45b1-ba69-562cf6ebd476"
                },
                "ColumnName": "保証ID"
              },
              {
                "GUID": "955475ef-9263-428d-b68a-c0c7e3f8b689",
                "BindingInfo": {
                  "TableName": "t_mail_history",
                  "ColumnName": "external_id",
                  "GUID": "093ac824-0d61-4089-bc54-9c5c5feddb19"
                },
                "ColumnName": "外販ID"
              }
            ],
            "SqlCondition": {
              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
              "SubConditions": [
                {
                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                  "ColumnBindingInfo": {
                    "TableName": "t_mail_history",
                    "ColumnName": "construction_estimate_id",
                    "GUID": "352d1f21-7a45-4ac9-b051-e86e6957ce27"
                  },
                  "Value": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=Item.工事見積ID"
                  }
                },
                {
                  "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                  "SubConditions": [
                    {
                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                      "ColumnBindingInfo": {
                        "TableName": "t_mail_history",
                        "ColumnName": "template_id",
                        "GUID": "5a5f5750-bdf1-49a3-82ea-91b3dd6d2215"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=依頼テンプレートID1"
                      },
                      "LeftBracket": 1
                    },
                    {
                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                      "ColumnBindingInfo": {
                        "TableName": "t_mail_history",
                        "ColumnName": "template_id",
                        "GUID": "ae84cb75-30f4-45da-aee1-760902b924f0"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=依頼テンプレートID2"
                      }
                    },
                    {
                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                      "ColumnBindingInfo": {
                        "TableName": "t_mail_history",
                        "ColumnName": "template_id",
                        "GUID": "ae84cb75-30f4-45da-aee1-760902b924f0"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=催促テンプレート.テンプレートID"
                      },
                      "RightBracket": 1
                    }
                  ],
                  "RelationType": 1
                }
              ]
            },
            "TopCount": "1",
            "OrderBySqlCondition": {
              "OrderByColumns": [
                {
                  "ColumnBindingInfo": {
                    "TableName": "t_mail_history",
                    "ColumnName": "mail_history_id",
                    "GUID": "cab13616-711a-4616-9060-31aa55f80431"
                  },
                  "Order": 1
                }
              ]
            }
          },
          "ID": "29dcbf7cc0454f98839ff229b517af70"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=工事見積依頼メール履歴"
                  }
                },
                "value": "%Null%",
                "compareType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "V_件名",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=催促テンプレート.件名&工事見積依頼メール履歴.件名"
                  },
                  "ID": "482730d2e3b0489db4f55a3ffff2d69e"
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "V_本文",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=催促テンプレート.本文&CHAR(10)&\"↓\"&CHAR(10)&CHAR(10)&工事見積依頼メール履歴.本文"
                  },
                  "ID": "8207e322f07f4aebbfaa939eb40f7de8"
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "V_本文",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=SUBSTITUTE(V_本文,\"%construction_estimate_company_name%\",Item.工事見積会社名)"
                  },
                  "ID": "3954e8f4e1f547dfb114b3ca2c944b07",
                  "Comments": "工事見積会社名の変換"
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "V_本文",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=SUBSTITUTE(V_本文,\"%Next reminder date%\",V_翌リマインド日)"
                  },
                  "ID": "8974e1124af9466183390cc55c1d9561",
                  "Comments": "翌リマインド日の変換"
                },
                {
                  "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
                  "ServerCommandName": "メール送信処理",
                  "Parameters": [
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_差出人アドレス",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.差出人アドレス"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_送信元区分",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.送信元区分"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_宛先区分",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.宛先区分"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_ユーザーグループKEYs"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_TOユーザーIDs",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.TOユーザーIDs"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_TO追加アドレス",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.TO追加アドレス"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_宛先TO",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.宛先TO"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_CCユーザーIDs",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.CCユーザーIDs"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_CC追加アドレス",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.CC追加アドレス"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_宛先CC",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.宛先CC"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_件名",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=V_件名"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_本文",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=V_本文"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_添付ファイル"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_テンプレートID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=催促テンプレート.テンプレートID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_請求番号"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_申込ID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.申込ID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_調査ID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.調査ID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_測量ID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.測量ID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_解析ID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.解析ID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_転圧ID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.転圧ID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_工事見積ID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.工事見積ID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_工事ID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.工事ID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_保証ID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.保証ID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_外販ID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=工事見積依頼メール履歴.外販ID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_送信ユーザーID"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_ダウンロードリンクリスト"
                    }
                  ],
                  "RefreshAfterFinish": true,
                  "CheckDataValidation": true
                },
                {
                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                  "TableName": "t_object_construction_estimate",
                  "ShowConfirm": false,
                  "RowsToUpdate": 1,
                  "RowsToUpdateCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "t_object_construction_estimate",
                      "ColumnName": "construction_estimate_id",
                      "GUID": "c3c6b5a2-f312-46a1-856d-c9e31e4b70e1"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=Item.工事見積ID"
                    }
                  },
                  "UpdateBindingValues": [
                    {
                      "BindingInfo": {
                        "TableName": "t_object_construction_estimate",
                        "ColumnName": "construction_estimate_status_id",
                        "GUID": "34f97708-bb21-4d33-869a-afb0588d3925"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=見積催促中ST.工事見積ステータスID"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_construction_estimate",
                        "ColumnName": "decline_end_schedule_date",
                        "GUID": "ae0ba7b6-e60d-4867-b5d2-6aa39db21768"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=V_翌営業日"
                      }
                    }
                  ],
                  "Comments": "工事見積ステータスを見積催促中に更新"
                }
              ],
              "ID": "52cb83c9-9e41-4661-a2f1-433e5c3cecd0"
            }
          ]
        }
      ]
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "辞退終了ST",
      "TableValue": {
        "TableName": "m_construction_estimate_status",
        "TableValueType": 1,
        "BindingInfos": [
          {
            "GUID": "26cd8417-6e64-4bef-8535-43ce8ff8ead7",
            "BindingInfo": {
              "TableName": "m_construction_estimate_status",
              "ColumnName": "construction_estimate_status_id",
              "GUID": "6a3b41b3-a1c9-432f-ac60-8f742312348e"
            },
            "ColumnName": "工事見積ステータスID"
          },
          {
            "GUID": "bbbf5f9f-6af9-4a0a-94dd-46a8d8469d97",
            "BindingInfo": {
              "TableName": "m_construction_estimate_status",
              "ColumnName": "construction_status_id",
              "GUID": "39bc2e25-1ff3-4795-89d8-b8a4bb8023d6"
            },
            "ColumnName": "工事ステータスID"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
          "ColumnBindingInfo": {
            "TableName": "m_construction_estimate_status",
            "ColumnName": "Decline_end_flg",
            "GUID": "cb169975-c698-4bdf-aa8e-76da1d25aa29"
          },
          "Value": "1"
        },
        "NullFormulaValueQueryPolicy": 0
      },
      "ID": "c61cbbc6e80e4751a4291f8e71128c43"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "V_辞退処理日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TODAY()-1"
      },
      "ID": "0c19bb5f649b4573bb960d2f56f30dfd"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "辞退予定リスト",
      "TableValue": {
        "TableName": "t_object_construction_estimate",
        "BindingInfos": [
          {
            "GUID": "593e6e7d-070e-4a75-a64a-b0dcdfcf05be",
            "BindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "construction_estimate_id",
              "GUID": "48b2da11-5c49-4975-99f3-5e2a40a5e276"
            },
            "ColumnName": "工事見積ID"
          },
          {
            "GUID": "ebeea937-5b3f-4074-98c6-87919006d5fb",
            "BindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "object_order_id",
              "GUID": "e1cfa2d2-0ee0-4287-a2b3-e8d8d682f51d"
            },
            "ColumnName": "申込ID"
          },
          {
            "GUID": "925dc576-3509-4f40-a8c4-9c3ca5b415b9",
            "BindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "object_order_id",
              "GUID": "09cf43ab-c98c-4101-9623-317dda8acbe1",
              "RelationBinding": {
                "RelatedTable": "t_object_order",
                "RelatedColumn": "object_order_id",
                "DisplayColumn": "latest_construction_id"
              }
            },
            "ColumnName": "最新工事ID"
          },
          {
            "GUID": "f91ee13b-6db6-46f7-a58b-e9c38fda4b11",
            "BindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "object_order_id",
              "GUID": "44189948-3ca6-459d-ad1d-3012718bf2d6",
              "RelationBinding": {
                "RelatedTable": "t_object_order",
                "RelatedColumn": "object_order_id",
                "DisplayColumn": "latest_construction_id",
                "NextRelationBinding": {
                  "RelatedTable": "t_object_construction",
                  "RelatedColumn": "construction_id",
                  "DisplayColumn": "construction_status_id",
                  "NextRelationBinding": {
                    "RelatedTable": "m_construction_status",
                    "RelatedColumn": "construction_status_id",
                    "DisplayColumn": "construction_complete_flg"
                  }
                }
              }
            },
            "ColumnName": "工事完了フラグ"
          },
          {
            "GUID": "c90d1aed-ec21-4c84-8d5c-1f6399da790c",
            "BindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "object_order_id",
              "GUID": "80f62af2-3ab8-4c04-8822-93c350a9ffde",
              "RelationBinding": {
                "RelatedTable": "t_object_order",
                "RelatedColumn": "object_order_id",
                "DisplayColumn": "object_id",
                "NextRelationBinding": {
                  "RelatedTable": "t_object",
                  "RelatedColumn": "object_id",
                  "DisplayColumn": "物件番号"
                }
              }
            },
            "ColumnName": "物件番号"
          },
          {
            "GUID": "33ff840a-8d19-46f4-9f82-b4a39c06a4c7",
            "BindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "object_order_id",
              "GUID": "603b9d66-7438-4355-95be-966bf4a3e8dc",
              "RelationBinding": {
                "RelatedTable": "t_object_order",
                "RelatedColumn": "object_order_id",
                "DisplayColumn": "object_id",
                "NextRelationBinding": {
                  "RelatedTable": "t_object",
                  "RelatedColumn": "object_id",
                  "DisplayColumn": "物件名"
                }
              }
            },
            "ColumnName": "物件名"
          },
          {
            "GUID": "6058caa0-29c7-4749-b1e1-2b539267b596",
            "BindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "object_order_id",
              "GUID": "0014318f-8637-4181-8b53-d10a9a94cd41",
              "RelationBinding": {
                "RelatedTable": "t_object_order",
                "RelatedColumn": "object_order_id",
                "DisplayColumn": "builder_id",
                "NextRelationBinding": {
                  "RelatedTable": "m_customer",
                  "RelatedColumn": "customer_id",
                  "DisplayColumn": "内部顧客名"
                }
              }
            },
            "ColumnName": "住宅事業者名"
          },
          {
            "GUID": "ae0cda9d-f4a1-4b08-8bc3-3a588f9cf928",
            "BindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "internal_notes",
              "GUID": "50205094-a2a0-4c95-b2aa-59086a49f3ab"
            },
            "ColumnName": "社内備考"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "SubConditions": [
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "construction_estimate_status_id",
                "GUID": "95d750a8-a4cd-4426-9138-233017551225"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=見積催促中ST.工事見積ステータスID"
              }
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 5,
              "ColumnBindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "decline_end_schedule_date",
                "GUID": "4d2c4080-7a70-4f24-b71d-0e15f6f35f77"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=TODAY()"
              }
            }
          ]
        }
      },
      "ID": "2880129eef3041a6835ea6880ad79b7c",
      "Comments": "辞退予定リストを先に作成"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "工事チームグループKEY",
      "TableValue": {
        "TableName": "m_user_group",
        "OnlyGetValue": true,
        "TableValueType": 0,
        "BindingInfos": [
          {
            "GUID": "662b779a-c08b-4d71-acd8-7afca6cd241a",
            "BindingInfo": {
              "TableName": "m_user_group",
              "ColumnName": "user_group_key",
              "GUID": "8d8fc108-b209-4bef-a1ee-42f73a3754ef"
            },
            "ColumnName": "user_group_key"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
          "ColumnBindingInfo": {
            "TableName": "m_user_group",
            "ColumnName": "construction_user_flg",
            "GUID": "20d257e8-7388-4945-815b-ddb95066c2f1"
          },
          "Value": "1"
        }
      },
      "ID": "60d967f6b0934c468854336111a87b6f"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "工事チーム宛先リスト",
      "TableValue": {
        "TableName": "m_user",
        "BindingInfos": [
          {
            "GUID": "eda2d1a9-3632-4da6-9dec-0d47ca620db2",
            "BindingInfo": {
              "TableName": "m_user",
              "ColumnName": "user_id",
              "GUID": "38c296b6-c873-49b8-81bc-ffa0e0dc19c0"
            },
            "ColumnName": "ユーザーID"
          },
          {
            "GUID": "29c8efc0-27b6-4db8-beb8-c48aafb2158a",
            "BindingInfo": {
              "TableName": "m_user",
              "ColumnName": "mail_address",
              "GUID": "9979e610-fafc-4c7c-a4a9-82d043e6a1cb"
            },
            "ColumnName": "メールアドレス"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "SubConditions": [
            {
              "$type": "ForguncyDataAccess.TextCESqlCondition, ForguncyDataAccess",
              "CompareType": 6,
              "ColumnBindingInfo": {
                "TableName": "m_user",
                "ColumnName": "user_group_keys",
                "GUID": "018403ce-a9e8-4db5-8562-9100a044bf7b"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=工事チームグループKEY"
              }
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "m_user",
                "ColumnName": "active_flg",
                "GUID": "b7f852c3-cc86-4257-b1fb-f2875afc865c"
              },
              "Value": "1"
            }
          ]
        },
        "OrderBySqlCondition": {
          "OrderByColumns": [
            {
              "ColumnBindingInfo": {
                "TableName": "m_user",
                "ColumnName": "user_id",
                "GUID": "09be9392-3d80-45b9-9187-d72d9996d232"
              },
              "Order": 0
            }
          ]
        }
      },
      "ID": "15d32b561b734e129fd690d191b95ed2"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "V_宛先TO",
      "ID": "559b7f3c71dc4b1faabce949ad60d388"
    },
    {
      "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
      "LoopInfo": {
        "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
        "LoopCount": {
          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
          "SerializeProperty": "=工事チーム宛先リスト"
        },
        "LoopItemParamName": "Item"
      },
      "CommandList": [
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=V_宛先TO"
                  }
                },
                "value": "%Null%"
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "V_宛先TO",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=Item.メールアドレス"
                  },
                  "ID": "b4844915c09f45cfa18e46b32d05cc18"
                }
              ],
              "ID": "f26d7d6f-7eaf-4fcb-9128-fdf33eadc5ff"
            },
            {
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "V_宛先TO",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=V_宛先TO&\",\"&Item.メールアドレス"
                  },
                  "ID": "cccc5530572340e49346ebae9681f6f5"
                }
              ],
              "ID": "0c9c7e77-0d56-4417-85a5-4e5e48f66031"
            }
          ]
        }
      ]
    },
    {
      "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
      "LoopInfo": {
        "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
        "LoopCount": {
          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
          "SerializeProperty": "=辞退予定リスト"
        },
        "LoopItemParamName": "Item"
      },
      "CommandList": [
        {
          "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
          "TableName": "t_object_construction_estimate",
          "ShowConfirm": false,
          "RowsToUpdate": 1,
          "RowsToUpdateCondition": {
            "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
            "ColumnBindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "construction_estimate_id",
              "GUID": "8228e2aa-fc32-4fc5-b5c0-885b09866669"
            },
            "Value": {
              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
              "SerializeProperty": "=Item.工事見積ID"
            }
          },
          "UpdateBindingValues": [
            {
              "BindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "construction_estimate_status_id",
                "GUID": "79d3a470-f9ed-4cb8-8969-c668f5faacee"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=辞退終了ST.工事見積ステータスID"
              }
            },
            {
              "BindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "decline_end_date",
                "GUID": "4d74812b-1e33-4066-a3f2-d07b1ee1779b"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=TODAY()"
              }
            },
            {
              "BindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "decline_end_flg",
                "GUID": "236c2829-38b6-4309-b19c-47f8c02d8e19"
              },
              "Value": "1"
            },
            {
              "BindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "internal_notes",
                "GUID": "188d16d1-b27c-4534-ae2b-c72d85e9c628"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=IF(Item.社内備考<>\"\",Item.社内備考&CHAR(10)&TEXT(TODAY(),\"yyyy/mm/dd\")&\" 自動終了\",TEXT(TODAY(),\"yyyy/mm/dd\")&\" 自動終了\")"
              }
            }
          ],
          "Comments": "見積催促中を辞退終了に更新する"
        }
      ]
    },
    {
      "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
      "LoopInfo": {
        "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
        "LoopCount": {
          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
          "SerializeProperty": "=辞退予定リスト"
        },
        "LoopItemParamName": "Item"
      },
      "CommandList": [
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "V_有効見積業者数",
          "ParameterValue": "0",
          "ID": "2fb31829b33e4af28780fd418a40fba3"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
          "ServerCommandName": "工事見積最大ステータス更新処理",
          "Parameters": [
            {
              "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
              "ParamName": "P_申込ID",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=Item.申込ID"
              }
            },
            {
              "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
              "ParamName": "P_工事ID",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=Item.最新工事ID"
              }
            },
            {
              "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
              "ParamName": "P_工事完了フラグ",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=Item.工事完了フラグ"
              }
            }
          ],
          "ReturnPropertiesTo": [
            {
              "ResultPropertyName": "R_有効見積業者数",
              "ResultTo": {
                "SerializeProperty": "V_有効見積業者数"
              }
            }
          ],
          "RefreshAfterFinish": true,
          "CheckDataValidation": true
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                "SubConditions": [
                  {
                    "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                    "param": {
                      "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                      "ParamObject": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=V_有効見積業者数"
                      }
                    },
                    "value": "0"
                  },
                  {
                    "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                    "param": {
                      "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                      "ParamObject": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=V_宛先TO"
                      }
                    },
                    "value": "%Null%",
                    "compareType": 1
                  }
                ]
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "V_件名",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=\"見積業者無効に関するお知らせ\""
                  },
                  "ID": "bf6a6472cd79442191c6f0bf0e567b6d"
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "V_本文",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=\"以下の物件は、見積リマインド後の辞退終了により、全工事見積業者が無効となりました。\"&CHAR(10)&\"ご確認の上、見積の再手配の確認をお願いします。\"&CHAR(10)&CHAR(10)&\"・物件番号：\"&Item.物件番号&CHAR(10)&\"・物件名：\"&Item.物件名&CHAR(10)&\"・住宅事業者名：\"&Item.住宅事業者名"
                  },
                  "ID": "23326a8a33224913a9666c077f604864"
                },
                {
                  "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
                  "ServerCommandName": "メール送信処理",
                  "Parameters": [
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_差出人アドレス"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_送信元区分",
                      "Value": "1"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_宛先区分",
                      "Value": "1"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_ユーザーグループKEYs"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_TOユーザーIDs"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_TO追加アドレス"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_宛先TO",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=V_宛先TO"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_CCユーザーIDs"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_CC追加アドレス"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_宛先CC"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_件名",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=V_件名"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_本文",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=V_本文"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_添付ファイル"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_テンプレートID"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_請求番号"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_申込ID"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_調査ID"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_測量ID"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_解析ID"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_転圧ID"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_工事見積ID"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_工事ID"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_保証ID"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_外販ID"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_送信ユーザーID"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_ダウンロードリンクリスト"
                    }
                  ],
                  "RefreshAfterFinish": true,
                  "CheckDataValidation": true
                }
              ],
              "ID": "9604de57-5d18-48d8-8eed-83d028ea4de5"
            }
          ]
        }
      ]
    }
  ]
}