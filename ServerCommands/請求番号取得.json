{
  "Name": "請求番号取得",
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.SaveLoad.PostRequestTriggerSaveData, ServerDesignerCommon",
      "Permission": {
        "PermissionData": {
          "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionData, Forguncy.RbacPermission.Core",
          "permissionResource": {
            "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionResource, Forguncy.RbacPermission.Core"
          },
          "permissionBindings": [
            {
              "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionBinding, Forguncy.RbacPermission.Core",
              "roleNames": [
                "FGC_LoginUser"
              ]
            }
          ]
        }
      },
      "Parameters": [
        {
          "Name": "P_請求先ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_物件ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_物件担当者ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_請求日",
          "DataValidationInfo": {}
        }
      ]
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon",
      "IsolationLevel": 256,
      "CommandList": [
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "請求先マスタ",
          "TableValue": {
            "TableName": "m_customer",
            "TableValueType": 1,
            "BindingInfos": [
              {
                "GUID": "ba95762e-96ab-4368-92ab-88168b120496",
                "BindingInfo": {
                  "TableName": "m_customer",
                  "ColumnName": "invoice_issue_unit_id",
                  "GUID": "eb60afc0-e242-4260-916c-b4f38fa07cf2"
                },
                "ColumnName": "請求書発行単位"
              }
            ],
            "SqlCondition": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "m_customer",
                "ColumnName": "customer_id",
                "GUID": "8acd6158-b961-486e-b156-12a0e7ccdafe"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_請求先ID"
              }
            }
          },
          "ID": "b968d339c0b44639bb4bbf243c261691"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "請求年月",
          "ParameterValue": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=TEXT(P_請求日,\"yyyymm\")"
          },
          "ID": "c70bbca29a13447d9307e220ce8ffe2a"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "最終請求連番",
          "ParameterValue": "0",
          "ID": "633cb3e7b74f4eebbcae86754504cb37"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "請求番号",
          "ID": "29b48c5bc8c541b7beeefe0960bb3367"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=請求先マスタ.請求書発行単位"
                  }
                },
                "value": "1"
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "同一請求番号",
                  "TableValue": {
                    "TableName": "t_sales",
                    "TableValueType": 1,
                    "BindingInfos": [
                      {
                        "GUID": "deabf5f8-9728-4e53-9d9a-a84c2e7efa48",
                        "BindingInfo": {
                          "TableName": "t_sales",
                          "ColumnName": "billing_no",
                          "GUID": "f3a31ad9-a05f-4d4f-9dc3-fcb138e647b0"
                        },
                        "ColumnName": "請求番号"
                      }
                    ],
                    "SqlCondition": {
                      "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                      "SubConditions": [
                        {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "ColumnBindingInfo": {
                            "TableName": "t_sales",
                            "ColumnName": "billing_comp_id",
                            "GUID": "c3665f2b-cfe5-4d3a-94c7-b7c53b1a9e0e"
                          },
                          "Value": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=P_請求先ID"
                          }
                        },
                        {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "ColumnBindingInfo": {
                            "TableName": "t_sales",
                            "ColumnName": "billing_date",
                            "GUID": "7c45c238-6778-4ce8-9384-f12a2beeb058"
                          },
                          "Value": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=P_請求日"
                          }
                        }
                      ]
                    },
                    "NullFormulaValueQueryPolicy": 0,
                    "TopCount": "1"
                  },
                  "ID": "8db193eed42147f39bcfd123790727a2"
                },
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=同一請求番号.請求番号"
                          }
                        },
                        "value": "%Null%",
                        "compareType": 1
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "請求番号",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=同一請求番号.請求番号"
                          },
                          "ID": "a65b51c33f2e4751ac2cedb9cac1df26"
                        }
                      ],
                      "ID": "52f2d4a7-9b4e-473f-9ff0-57e787e2c0ba"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "請求連番",
                          "TableValue": {
                            "TableName": "m_billing_no",
                            "TableValueType": 1,
                            "BindingInfos": [
                              {
                                "GUID": "99b1f9a9-fc2f-4f05-af66-2184a83cf45c",
                                "BindingInfo": {
                                  "TableName": "m_billing_no",
                                  "ColumnName": "serial_number",
                                  "GUID": "d49f4150-6a2d-482e-8544-5dfc660e7c09"
                                },
                                "ColumnName": "連番"
                              }
                            ],
                            "SqlCondition": {
                              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                              "ColumnBindingInfo": {
                                "TableName": "m_billing_no",
                                "ColumnName": "billing_yyyymm",
                                "GUID": "22dd08e4-01af-4905-b598-68a2cd7a093f"
                              },
                              "Value": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=請求年月"
                              }
                            },
                            "NullFormulaValueQueryPolicy": 0,
                            "TopCount": "1"
                          },
                          "ID": "ab7ff5b5fe384d84a1b91c13ffa29236"
                        },
                        {
                          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                          "ConditionAndCommandPairList": [
                            {
                              "Condition": {
                                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                                "param": {
                                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                                  "ParamObject": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=請求連番.連番"
                                  }
                                },
                                "value": "%Null%"
                              },
                              "CommandList": [
                                {
                                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                                  "TableName": "m_billing_no",
                                  "UpdateType": "add",
                                  "ShowConfirm": false,
                                  "UpdateBindingValues": [
                                    {
                                      "BindingInfo": {
                                        "TableName": "m_billing_no",
                                        "ColumnName": "billing_yyyymm",
                                        "GUID": "25f521c9-6a6d-4364-9413-d4b24378faa6"
                                      },
                                      "Value": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=請求年月"
                                      }
                                    },
                                    {
                                      "BindingInfo": {
                                        "TableName": "m_billing_no",
                                        "ColumnName": "serial_number",
                                        "GUID": "4eebc86f-88d3-452e-a68e-a53e90e5d910"
                                      },
                                      "Value": "1"
                                    }
                                  ]
                                }
                              ],
                              "ID": "f334f391-5e28-44c7-a751-e824b73984a0"
                            },
                            {
                              "CommandList": [
                                {
                                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                                  "ParameterName": "最終請求連番",
                                  "ParameterValue": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=請求連番.連番"
                                  },
                                  "ID": "e841e3b60b5643e9a09837f14450a183"
                                },
                                {
                                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                                  "TableName": "m_billing_no",
                                  "ShowConfirm": false,
                                  "RowsToUpdate": 1,
                                  "RowsToUpdateCondition": {
                                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                    "ColumnBindingInfo": {
                                      "TableName": "m_billing_no",
                                      "ColumnName": "billing_yyyymm",
                                      "GUID": "cea789c6-a052-42de-9fcc-f59a2b56ffd9"
                                    },
                                    "Value": {
                                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                      "SerializeProperty": "=請求年月"
                                    }
                                  },
                                  "UpdateBindingValues": [
                                    {
                                      "BindingInfo": {
                                        "TableName": "m_billing_no",
                                        "ColumnName": "billing_yyyymm",
                                        "GUID": "0ea0ab9e-70d2-402a-a44a-523b1126e243"
                                      },
                                      "Value": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=請求年月"
                                      }
                                    },
                                    {
                                      "BindingInfo": {
                                        "TableName": "m_billing_no",
                                        "ColumnName": "serial_number",
                                        "GUID": "2e3d423b-d457-46c3-99fa-f5ab86f0bb92"
                                      },
                                      "Value": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=最終請求連番+1"
                                      }
                                    }
                                  ]
                                }
                              ],
                              "ID": "e4747d96-c9d4-4b03-98df-372d71b4b160"
                            }
                          ]
                        }
                      ],
                      "ID": "0baedc19-170c-4389-a3c0-e117f0ce1512"
                    }
                  ]
                }
              ],
              "Comments": "月次一括",
              "ID": "e0c5aceb-4da9-48b4-8c91-69c482701c33"
            },
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=請求先マスタ.請求書発行単位"
                  }
                },
                "value": "2"
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=P_物件ID"
                          }
                        },
                        "value": "%Null%"
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "同一請求番号",
                          "TableValue": {
                            "TableName": "t_sales",
                            "TableValueType": 1,
                            "BindingInfos": [
                              {
                                "GUID": "b570a8df-8111-4ac3-b92a-8b8e17d6eb74",
                                "BindingInfo": {
                                  "TableName": "t_sales",
                                  "ColumnName": "billing_no",
                                  "GUID": "a078284c-3f78-40fe-949c-416ced281387"
                                },
                                "ColumnName": "請求番号"
                              }
                            ],
                            "SqlCondition": {
                              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                              "SubConditions": [
                                {
                                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                  "ColumnBindingInfo": {
                                    "TableName": "t_sales",
                                    "ColumnName": "billing_comp_id",
                                    "GUID": "c57ec507-4ecc-4697-8d02-5a6303ce7512"
                                  },
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=P_請求先ID"
                                  }
                                },
                                {
                                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                  "ColumnBindingInfo": {
                                    "TableName": "t_sales",
                                    "ColumnName": "billing_date",
                                    "GUID": "01ed9972-7d6c-4331-a022-c765dcbb56d8"
                                  },
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=P_請求日"
                                  }
                                },
                                {
                                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                  "ColumnBindingInfo": {
                                    "TableName": "t_sales",
                                    "ColumnName": "object_order_id",
                                    "GUID": "d2a77682-0a0a-4e3a-bb40-1f7e5ec17ed4",
                                    "RelationBinding": {
                                      "RelatedTable": "t_object_order",
                                      "RelatedColumn": "object_order_id",
                                      "DisplayColumn": "object_id"
                                    }
                                  },
                                  "Value": "%Null%"
                                }
                              ]
                            },
                            "TopCount": "1"
                          },
                          "ID": "97c6f237c7384cd389ac75f6951ff7bb"
                        }
                      ],
                      "Comments": "物件IDが無い場合",
                      "ID": "cf8a2a93-0ce7-4d84-a69c-3f9b6b87bb05"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "同一請求番号",
                          "TableValue": {
                            "TableName": "t_sales",
                            "TableValueType": 1,
                            "BindingInfos": [
                              {
                                "GUID": "95fc7232-c384-4255-adaf-9ef094ff04b8",
                                "BindingInfo": {
                                  "TableName": "t_sales",
                                  "ColumnName": "billing_no",
                                  "GUID": "fcdcaf39-094f-4766-a811-67bd291f83fc"
                                },
                                "ColumnName": "請求番号"
                              }
                            ],
                            "SqlCondition": {
                              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                              "SubConditions": [
                                {
                                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                  "ColumnBindingInfo": {
                                    "TableName": "t_sales",
                                    "ColumnName": "billing_comp_id",
                                    "GUID": "d2c3bc68-206a-4cbd-9556-310fda96f74a"
                                  },
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=P_請求先ID"
                                  }
                                },
                                {
                                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                  "ColumnBindingInfo": {
                                    "TableName": "t_sales",
                                    "ColumnName": "billing_date",
                                    "GUID": "0035f7a1-f088-44b9-ae85-ef674e7853ed"
                                  },
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=P_請求日"
                                  }
                                },
                                {
                                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                  "ColumnBindingInfo": {
                                    "TableName": "t_sales",
                                    "ColumnName": "object_order_id",
                                    "GUID": "a178fcac-f372-4f75-bff7-02e8a8f1a22c",
                                    "RelationBinding": {
                                      "RelatedTable": "t_object_order",
                                      "RelatedColumn": "object_order_id",
                                      "DisplayColumn": "object_id"
                                    }
                                  },
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=P_物件ID"
                                  }
                                }
                              ]
                            },
                            "NullFormulaValueQueryPolicy": 0,
                            "TopCount": "1"
                          },
                          "ID": "2a1f760089da40d6b2b920f5517d6ef3"
                        }
                      ],
                      "ID": "72b18cb1-095e-44dc-9597-489e6b617ae4"
                    }
                  ]
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "最終請求連番",
                  "ParameterValue": "0",
                  "ID": "16a87b5037914a85b4b63a07db9cc838"
                },
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=同一請求番号.請求番号"
                          }
                        },
                        "value": "%Null%",
                        "compareType": 1
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "請求番号",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=同一請求番号.請求番号"
                          },
                          "ID": "cfeda16daca64d7394c58201fc887f44"
                        }
                      ],
                      "ID": "be4cf064-99b9-4395-ab5c-d9471c7ce5b8"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "請求連番",
                          "TableValue": {
                            "TableName": "m_billing_no",
                            "TableValueType": 1,
                            "BindingInfos": [
                              {
                                "GUID": "b571ec78-2a6b-4e48-b8d4-40713a957e47",
                                "BindingInfo": {
                                  "TableName": "m_billing_no",
                                  "ColumnName": "serial_number",
                                  "GUID": "7cac5a97-358b-48a5-8095-e5575000ad39"
                                },
                                "ColumnName": "連番"
                              }
                            ],
                            "SqlCondition": {
                              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                              "ColumnBindingInfo": {
                                "TableName": "m_billing_no",
                                "ColumnName": "billing_yyyymm",
                                "GUID": "e2b43d46-5e00-43a8-ab31-7b39969b2b0f"
                              },
                              "Value": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=請求年月"
                              }
                            },
                            "NullFormulaValueQueryPolicy": 0,
                            "TopCount": "1"
                          },
                          "ID": "66b3e3878e624f7985fd679364fd1293"
                        },
                        {
                          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                          "ConditionAndCommandPairList": [
                            {
                              "Condition": {
                                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                                "param": {
                                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                                  "ParamObject": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=請求連番.連番"
                                  }
                                },
                                "value": "%Null%"
                              },
                              "CommandList": [
                                {
                                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                                  "TableName": "m_billing_no",
                                  "UpdateType": "add",
                                  "ShowConfirm": false,
                                  "UpdateBindingValues": [
                                    {
                                      "BindingInfo": {
                                        "TableName": "m_billing_no",
                                        "ColumnName": "billing_yyyymm",
                                        "GUID": "ff81305a-2ad3-4bde-ba88-22ce438eb73a"
                                      },
                                      "Value": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=請求年月"
                                      }
                                    },
                                    {
                                      "BindingInfo": {
                                        "TableName": "m_billing_no",
                                        "ColumnName": "serial_number",
                                        "GUID": "098cf696-3b5d-4e19-bb62-5500529f2171"
                                      },
                                      "Value": "1"
                                    }
                                  ]
                                }
                              ],
                              "ID": "8f3fadb4-4f58-4881-aafb-63aef4b6b835"
                            },
                            {
                              "CommandList": [
                                {
                                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                                  "ParameterName": "最終請求連番",
                                  "ParameterValue": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=請求連番.連番"
                                  },
                                  "ID": "6df1dc21f3bb420380b78737729bf18d"
                                },
                                {
                                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                                  "TableName": "m_billing_no",
                                  "ShowConfirm": false,
                                  "RowsToUpdate": 1,
                                  "RowsToUpdateCondition": {
                                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                    "ColumnBindingInfo": {
                                      "TableName": "m_billing_no",
                                      "ColumnName": "billing_yyyymm",
                                      "GUID": "4a66ddad-1c7d-4072-b167-7156215af385"
                                    },
                                    "Value": {
                                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                      "SerializeProperty": "=請求年月"
                                    }
                                  },
                                  "UpdateBindingValues": [
                                    {
                                      "BindingInfo": {
                                        "TableName": "m_billing_no",
                                        "ColumnName": "billing_yyyymm",
                                        "GUID": "781d229b-526f-4ee7-9736-c82737602d08"
                                      },
                                      "Value": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=請求年月"
                                      }
                                    },
                                    {
                                      "BindingInfo": {
                                        "TableName": "m_billing_no",
                                        "ColumnName": "serial_number",
                                        "GUID": "af63d16c-ba6e-44ca-94fe-92a9f673c678"
                                      },
                                      "Value": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=最終請求連番+1"
                                      }
                                    }
                                  ]
                                }
                              ],
                              "ID": "fac405ac-eb2e-4b39-83e3-b0ca15ff059d"
                            }
                          ]
                        }
                      ],
                      "ID": "dd58df99-58f9-439c-b8a4-d95d19644a72"
                    }
                  ]
                }
              ],
              "Comments": "物件単位",
              "ID": "c507585c-e54e-48cb-8169-52c2afbda3f6"
            },
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=請求先マスタ.請求書発行単位"
                  }
                },
                "value": "3"
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=P_物件担当者ID"
                          }
                        },
                        "value": "%Null%"
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "同一請求番号",
                          "TableValue": {
                            "TableName": "t_sales",
                            "TableValueType": 1,
                            "BindingInfos": [
                              {
                                "GUID": "1cdf4045-0217-494a-9e9a-cd95a170ef28",
                                "BindingInfo": {
                                  "TableName": "t_sales",
                                  "ColumnName": "billing_no",
                                  "GUID": "aa1b78ee-33ae-498d-a24f-b5811e9e7e82"
                                },
                                "ColumnName": "請求番号"
                              }
                            ],
                            "SqlCondition": {
                              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                              "SubConditions": [
                                {
                                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                  "ColumnBindingInfo": {
                                    "TableName": "t_sales",
                                    "ColumnName": "billing_comp_id",
                                    "GUID": "bbc8cdaa-e0f6-4877-b374-cccf81ec45af"
                                  },
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=P_請求先ID"
                                  }
                                },
                                {
                                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                  "ColumnBindingInfo": {
                                    "TableName": "t_sales",
                                    "ColumnName": "billing_date",
                                    "GUID": "f9e94545-0f09-4516-8fc4-ebd285fd4fe9"
                                  },
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=P_請求日"
                                  }
                                },
                                {
                                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                  "ColumnBindingInfo": {
                                    "TableName": "t_sales",
                                    "ColumnName": "object_order_id",
                                    "GUID": "c9c2fbfd-4264-4449-bae4-b563ad5189f6",
                                    "RelationBinding": {
                                      "RelatedTable": "t_object_order",
                                      "RelatedColumn": "object_order_id",
                                      "DisplayColumn": "object_user_id"
                                    }
                                  },
                                  "Value": "%Null%"
                                }
                              ]
                            },
                            "TopCount": "1"
                          },
                          "ID": "46326bed5b874d37be128c7be5718db5"
                        }
                      ],
                      "Comments": "物件IDが無い場合",
                      "ID": "81c45b88-467e-40f0-b659-601a6919c2c7"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "同一請求番号",
                          "TableValue": {
                            "TableName": "t_sales",
                            "TableValueType": 1,
                            "BindingInfos": [
                              {
                                "GUID": "3fc11431-edc9-4ead-bc69-c3ad3e7fa888",
                                "BindingInfo": {
                                  "TableName": "t_sales",
                                  "ColumnName": "billing_no",
                                  "GUID": "41c0157d-5f9d-448f-ab0d-42c31399584a"
                                },
                                "ColumnName": "請求番号"
                              }
                            ],
                            "SqlCondition": {
                              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                              "SubConditions": [
                                {
                                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                  "ColumnBindingInfo": {
                                    "TableName": "t_sales",
                                    "ColumnName": "billing_comp_id",
                                    "GUID": "97494000-a44e-4c9e-8299-f4c613b5f436"
                                  },
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=P_請求先ID"
                                  }
                                },
                                {
                                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                  "ColumnBindingInfo": {
                                    "TableName": "t_sales",
                                    "ColumnName": "billing_date",
                                    "GUID": "e94c7d82-b581-4ffa-bb15-378c8bcf0a79"
                                  },
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=P_請求日"
                                  }
                                },
                                {
                                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                  "ColumnBindingInfo": {
                                    "TableName": "t_sales",
                                    "ColumnName": "object_order_id",
                                    "GUID": "0fb88404-e9e3-4dc1-af38-a0572f7a7b2e",
                                    "RelationBinding": {
                                      "RelatedTable": "t_object_order",
                                      "RelatedColumn": "object_order_id",
                                      "DisplayColumn": "object_user_id"
                                    }
                                  },
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=P_物件担当者ID"
                                  }
                                }
                              ]
                            },
                            "NullFormulaValueQueryPolicy": 0,
                            "TopCount": "1"
                          },
                          "ID": "e0c2977782d445f480498560e637791b"
                        }
                      ],
                      "ID": "da63c749-4ed1-4a1f-9c2c-b40c681f8002"
                    }
                  ]
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "最終請求連番",
                  "ParameterValue": "0",
                  "ID": "d00e6f9b99ca4879be20eea1708f0adf"
                },
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=同一請求番号.請求番号"
                          }
                        },
                        "value": "%Null%",
                        "compareType": 1
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "請求番号",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=同一請求番号.請求番号"
                          },
                          "ID": "7a3120468e7b464c9b48e1ffe27ebe02"
                        }
                      ],
                      "ID": "d83448e5-5cc0-4551-b4e5-54ae91d9ec57"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "請求連番",
                          "TableValue": {
                            "TableName": "m_billing_no",
                            "TableValueType": 1,
                            "BindingInfos": [
                              {
                                "GUID": "21e3794f-eed0-47cd-a6f2-702b753222d7",
                                "BindingInfo": {
                                  "TableName": "m_billing_no",
                                  "ColumnName": "serial_number",
                                  "GUID": "21ff6c3f-503f-44e7-94bf-71c47bdbf37b"
                                },
                                "ColumnName": "連番"
                              }
                            ],
                            "SqlCondition": {
                              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                              "ColumnBindingInfo": {
                                "TableName": "m_billing_no",
                                "ColumnName": "billing_yyyymm",
                                "GUID": "e2b43d46-5e00-43a8-ab31-7b39969b2b0f"
                              },
                              "Value": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=請求年月"
                              }
                            },
                            "NullFormulaValueQueryPolicy": 0,
                            "TopCount": "1"
                          },
                          "ID": "6167c8ed29a44e61851a53a4b15dda1b"
                        },
                        {
                          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                          "ConditionAndCommandPairList": [
                            {
                              "Condition": {
                                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                                "param": {
                                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                                  "ParamObject": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=請求連番.連番"
                                  }
                                },
                                "value": "%Null%"
                              },
                              "CommandList": [
                                {
                                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                                  "TableName": "m_billing_no",
                                  "UpdateType": "add",
                                  "ShowConfirm": false,
                                  "UpdateBindingValues": [
                                    {
                                      "BindingInfo": {
                                        "TableName": "m_billing_no",
                                        "ColumnName": "billing_yyyymm",
                                        "GUID": "9bfaeff5-2463-4082-8752-3e3bd25f7d84"
                                      },
                                      "Value": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=請求年月"
                                      }
                                    },
                                    {
                                      "BindingInfo": {
                                        "TableName": "m_billing_no",
                                        "ColumnName": "serial_number",
                                        "GUID": "e7e79ff4-4fad-42a8-9989-542f53894a2f"
                                      },
                                      "Value": "1"
                                    }
                                  ]
                                }
                              ],
                              "ID": "6eab6542-5676-424f-af18-a564ab3ec3d9"
                            },
                            {
                              "CommandList": [
                                {
                                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                                  "ParameterName": "最終請求連番",
                                  "ParameterValue": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=請求連番.連番"
                                  },
                                  "ID": "df546955b5a44484becd6604a910c96b"
                                },
                                {
                                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                                  "TableName": "m_billing_no",
                                  "ShowConfirm": false,
                                  "RowsToUpdate": 1,
                                  "RowsToUpdateCondition": {
                                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                    "ColumnBindingInfo": {
                                      "TableName": "m_billing_no",
                                      "ColumnName": "billing_yyyymm",
                                      "GUID": "4a66ddad-1c7d-4072-b167-7156215af385"
                                    },
                                    "Value": {
                                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                      "SerializeProperty": "=請求年月"
                                    }
                                  },
                                  "UpdateBindingValues": [
                                    {
                                      "BindingInfo": {
                                        "TableName": "m_billing_no",
                                        "ColumnName": "billing_yyyymm",
                                        "GUID": "60aae6ff-d209-44ef-8905-34b3787c35e9"
                                      },
                                      "Value": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=請求年月"
                                      }
                                    },
                                    {
                                      "BindingInfo": {
                                        "TableName": "m_billing_no",
                                        "ColumnName": "serial_number",
                                        "GUID": "315ba8d8-24fd-4967-a231-251806ecea45"
                                      },
                                      "Value": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=最終請求連番+1"
                                      }
                                    }
                                  ]
                                }
                              ],
                              "ID": "5d25acb9-5693-49be-b09e-b80b02105397"
                            }
                          ]
                        }
                      ],
                      "ID": "f013413b-7572-4d22-ad8b-a44b1ed92ee5"
                    }
                  ]
                }
              ],
              "Comments": "物件担当者単位",
              "ID": "886f2aa0-1e5c-4607-962e-0682949524a5"
            }
          ],
          "Comments": "請求番号取得"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=請求番号"
                  }
                },
                "value": "%Null%"
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "新規請求連番",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=最終請求連番+1"
                  },
                  "ID": "8a1a0897d2554f1eadd003115fa0599b"
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "請求番号",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=\"MC\"&請求年月&TEXT(新規請求連番,\"000\")"
                  },
                  "ID": "0f69cafb3153413687701d08a29e53ff"
                }
              ],
              "ID": "73055a5f-3e54-4cf1-8baa-d46b42ff14e8"
            },
            {
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "新規請求連番",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=VALUE(RIGHT(請求番号,3))"
                  },
                  "ID": "de1be3873c1746368b22e9754382a92f"
                }
              ],
              "ID": "9b0e07fc-30f2-4e72-9177-44796877f23c"
            }
          ]
        }
      ]
    },
    {
      "$type": "Forguncy.Model.ReturnCommand, ServerDesignerCommon",
      "ErrorCode": "0",
      "CustomReturns": [
        {
          "ReturnPropertyName": "R_請求番号",
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=請求番号"
          }
        },
        {
          "ReturnPropertyName": "R_請求連番",
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=新規請求連番"
          }
        }
      ]
    }
  ],
  "ReturnProperties": [
    {
      "Name": "R_請求番号"
    },
    {
      "Name": "R_請求連番"
    }
  ]
}