{
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.ServerCommands.Models.PostRequestTrigger, ServerDesignerCommon",
      "Permission": {
        "AllowRoles": [
          "FGC_LoginUser"
        ]
      },
      "Parameters": [
        {
          "Name": "P_計上確定日"
        },
        {
          "Name": "P_請求先ID"
        },
        {
          "Name": "P_申込ID"
        },
        {
          "Name": "P_物件商品ID"
        },
        {
          "Name": "P_請求商品名"
        },
        {
          "Name": "P_請求備考"
        },
        {
          "Name": "P_請求税抜金額"
        }
      ]
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon",
      "CommandList": [
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "請求先マスタ",
          "TableValue": {
            "TableName": "m_customer",
            "TableValueType": 1,
            "BindingInfos": [
              {
                "BindingInfo": {
                  "TableName": "m_customer",
                  "ColumnName": "billing_issue_unit"
                },
                "ColumnName": "請求書発行単位"
              },
              {
                "BindingInfo": {
                  "TableName": "m_customer",
                  "ColumnName": "closing_date"
                },
                "ColumnName": "請求締日"
              },
              {
                "BindingInfo": {
                  "TableName": "m_customer",
                  "ColumnName": "deposit_month"
                },
                "ColumnName": "入金月"
              },
              {
                "BindingInfo": {
                  "TableName": "m_customer",
                  "ColumnName": "deposit_day"
                },
                "ColumnName": "入金日"
              },
              {
                "BindingInfo": {
                  "TableName": "m_customer",
                  "ColumnName": "deposit_business_day"
                },
                "ColumnName": "入金営業日"
              }
            ],
            "SqlCondition": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "m_customer",
                "ColumnName": "customer_id"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_請求先ID"
              }
            }
          },
          "ID": "f27e2c2821894586a934a64406fe91ba"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "物件申込",
          "TableValue": {
            "TableName": "t_object_order",
            "TableValueType": 1,
            "BindingInfos": [
              {
                "BindingInfo": {
                  "TableName": "t_object_order",
                  "ColumnName": "object_id"
                },
                "ColumnName": "物件ID"
              },
              {
                "BindingInfo": {
                  "TableName": "t_object_order",
                  "ColumnName": "object_id",
                  "RelationBinding": {
                    "RelatedTable": "t_object",
                    "RelatedColumn": "object_id",
                    "DisplayColumn": "物件名"
                  }
                },
                "ColumnName": "物件名"
              },
              {
                "BindingInfo": {
                  "TableName": "t_object_order",
                  "ColumnName": "object_id",
                  "RelationBinding": {
                    "RelatedTable": "t_object",
                    "RelatedColumn": "object_id",
                    "DisplayColumn": "物件住所"
                  }
                },
                "ColumnName": "物件住所"
              },
              {
                "BindingInfo": {
                  "TableName": "t_object_order",
                  "ColumnName": "builder_id"
                },
                "ColumnName": "住宅事業者ID"
              },
              {
                "BindingInfo": {
                  "TableName": "t_object_order",
                  "ColumnName": "builder_id",
                  "RelationBinding": {
                    "RelatedTable": "m_customer",
                    "RelatedColumn": "customer_id",
                    "DisplayColumn": "customer_name"
                  }
                },
                "ColumnName": "住宅事業者名"
              }
            ],
            "SqlCondition": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_order",
                "ColumnName": "object_order_id"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_申込ID"
              }
            }
          },
          "ID": "80d28eec02d4484296c62c15de7d2e51"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "請求番号",
          "ID": "5541b9cfbccf4c71ab624cac679d67cc"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "請求日",
          "ID": "c34d54d12579459da76b401358052bdd"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "回収予定日",
          "ID": "136842d65acc4a109bc69c37e8c1094d"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "最新税率",
          "TableValue": {
            "TableName": "m_tax_rate",
            "OnlyGetValue": true,
            "TableValueType": 0,
            "BindingInfos": [
              {
                "BindingInfo": {
                  "TableName": "m_tax_rate",
                  "ColumnName": "tax_rate"
                },
                "ColumnName": "tax_rate"
              }
            ],
            "SqlCondition": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 5,
              "ColumnBindingInfo": {
                "TableName": "m_tax_rate",
                "ColumnName": "revision_date"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_計上確定日"
              }
            },
            "TopCount": "1",
            "OrderBySqlCondition": {
              "OrderByColumns": [
                {
                  "ColumnBindingInfo": {
                    "TableName": "m_tax_rate",
                    "ColumnName": "revision_date"
                  },
                  "Order": 0
                }
              ]
            }
          },
          "ID": "a2dcb24244ee4b97948c9fa286be6653"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=請求先マスタ.請求締日"
                  }
                },
                "value": "29,30,31",
                "compareType": 12
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "請求日",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=EOMONTH(P_計上確定日,0)"
                  },
                  "ID": "e4adcd80688a4f71a95cfd5cda708692"
                }
              ],
              "Comments": "月末締めの場合",
              "ID": "9c364adc-3533-43b1-9fcb-54fca8b3c535"
            },
            {
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "当月請求日",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=DATE(YEAR(P_計上確定日),MONTH(P_計上確定日),請求先マスタ.請求締日)"
                  },
                  "ID": "86ac848610d54f1e924a0a4959c023d0"
                },
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=P_計上確定日"
                          }
                        },
                        "value": {
                          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                          "SerializeProperty": "=当月請求日"
                        },
                        "compareType": 5
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "請求日",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=当月請求日"
                          },
                          "ID": "1dd5f752798341ae82e537e79a9c69df"
                        }
                      ],
                      "ID": "034892ad-d636-4acd-b67a-c051fc8a1606"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "請求日",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=EDATE(当月請求日,1)"
                          },
                          "ID": "2118ab244a584e2e824d77d70f085937"
                        }
                      ],
                      "ID": "305d12a2-17b1-40b1-a378-3dbd71970266"
                    }
                  ]
                }
              ],
              "ID": "9d995ffd-5b86-4d40-b62e-4f154d642f5e"
            }
          ],
          "Comments": "請求日取得"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=請求先マスタ.入金日"
                  }
                },
                "value": "29,30,31",
                "compareType": 12
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "基準回収予定日",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=EOMONTH(EDATE(請求日,請求先マスタ.入金月),0)"
                  },
                  "ID": "b4103f699f724599b94e8409c5e1015f"
                }
              ],
              "ID": "59bdf79f-6abd-4ac0-8915-91e7c65c6be5"
            },
            {
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "基準回収予定日",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=DATE(YEAR(EDATE(請求日,請求先マスタ.入金月)),MONTH(EDATE(請求日,請求先マスタ.入金月)),請求先マスタ.入金日)"
                  },
                  "ID": "c649fed006444e029a34faff27a64244"
                }
              ],
              "ID": "2904f492-18e8-457d-a9f7-fe839bc5855c"
            }
          ],
          "Comments": "回収予定日取得"
        },
        {
          "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
          "LoopInfo": {
            "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
            "LoopCount": "99",
            "LoopItemParamName": "Item"
          },
          "CommandList": [
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "回収予定日曜日",
              "ParameterValue": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=WEEKDAY(基準回収予定日)"
              },
              "ID": "66ad632411fa4ee8a982ecea2a4de2f5"
            },
            {
              "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
              "ConditionAndCommandPairList": [
                {
                  "Condition": {
                    "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                    "param": {
                      "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                      "ParamObject": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=回収予定日曜日"
                      }
                    },
                    "value": "1,7",
                    "compareType": 12
                  },
                  "CommandList": [
                    {
                      "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                      "ConditionAndCommandPairList": [
                        {
                          "Condition": {
                            "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                            "param": {
                              "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                              "ParamObject": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=請求先マスタ.入金営業日"
                              }
                            },
                            "value": "1"
                          },
                          "CommandList": [
                            {
                              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                              "ParameterName": "基準回収予定日",
                              "ParameterValue": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=基準回収予定日-1"
                              },
                              "ID": "4d6a586f3a9b46beb3ab3ae0b92fd877",
                              "Comments": "前営業日"
                            }
                          ],
                          "ID": "c67cbc3b-fc4e-455a-9a06-1e01864d2957"
                        },
                        {
                          "CommandList": [
                            {
                              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                              "ParameterName": "基準回収予定日",
                              "ParameterValue": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=基準回収予定日+1"
                              },
                              "ID": "61ef6498b37d41ddb783437b515a633d",
                              "Comments": "後営業日"
                            }
                          ],
                          "ID": "38d803e0-31a3-4122-b777-dd929c775ab3"
                        }
                      ]
                    }
                  ],
                  "Comments": "土、日以外",
                  "ID": "11d78831-f15a-477e-ac86-7ad4bb592fb5"
                },
                {
                  "CommandList": [
                    {
                      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                      "ParameterName": "銀行休業日件数",
                      "TableValue": {
                        "TableName": "m_bank_holiday",
                        "TableValueType": 3,
                        "SqlCondition": {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "ColumnBindingInfo": {
                            "TableName": "m_bank_holiday",
                            "ColumnName": "holiday"
                          },
                          "Value": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=基準回収予定日"
                          }
                        }
                      },
                      "ID": "6a33a2abd9014ee69db166d7e51dd0b0"
                    },
                    {
                      "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                      "ConditionAndCommandPairList": [
                        {
                          "Condition": {
                            "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                            "param": {
                              "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                              "ParamObject": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=銀行休業日件数"
                              }
                            },
                            "value": "0",
                            "compareType": 2
                          },
                          "CommandList": [
                            {
                              "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                              "ConditionAndCommandPairList": [
                                {
                                  "Condition": {
                                    "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                                    "param": {
                                      "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                                      "ParamObject": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=請求先マスタ.入金営業日"
                                      }
                                    },
                                    "value": "1"
                                  },
                                  "CommandList": [
                                    {
                                      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                                      "ParameterName": "基準回収予定日",
                                      "ParameterValue": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=基準回収予定日-1"
                                      },
                                      "ID": "5cd1c0043c7a4f58ba716debe705be18",
                                      "Comments": "前営業日"
                                    }
                                  ],
                                  "ID": "a22b4e8c-b1bf-409c-8fa9-7f1b05edfaf3"
                                },
                                {
                                  "CommandList": [
                                    {
                                      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                                      "ParameterName": "基準回収予定日",
                                      "ParameterValue": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=基準回収予定日+1"
                                      },
                                      "ID": "dafb37d6062345ec8ca2070164025f69",
                                      "Comments": "後営業日"
                                    }
                                  ],
                                  "ID": "d4443a24-ddbe-410d-89cc-99f647368eb8"
                                }
                              ]
                            }
                          ],
                          "ID": "acaa6e1a-a301-4ab2-831f-11cf15607401"
                        },
                        {
                          "CommandList": [
                            {
                              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                              "ParameterName": "回収予定日",
                              "ParameterValue": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=基準回収予定日"
                              },
                              "ID": "979790d2af6242c99bc389a856cbd2db",
                              "Comments": "回収予定日をセットして繰り返しを終了"
                            },
                            {
                              "$type": "Forguncy.Model.EndLoopCommand, ServerDesignerCommon"
                            }
                          ],
                          "ID": "c3654451-4be3-4203-8246-9a01285fdb71"
                        }
                      ]
                    }
                  ],
                  "ID": "d302bb43-467f-492e-8384-8b301e7737d7"
                }
              ]
            }
          ],
          "Comments": "回収予定日取得"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "請求年月",
          "ParameterValue": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=TEXT(請求日,\"yyyymm\")"
          },
          "ID": "b471e16e5c1f4d8b905918d1e115bb57"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "最終請求連番",
          "ParameterValue": "0",
          "ID": "5980e0f20f96434992e63bb0eb7dffbd"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=請求先マスタ.請求書発行単位"
                  }
                },
                "value": "1"
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "同一請求件数",
                  "TableValue": {
                    "TableName": "t_sales",
                    "TableValueType": 3,
                    "SqlCondition": {
                      "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                      "Condition1": {
                        "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                        "ColumnBindingInfo": {
                          "TableName": "t_sales",
                          "ColumnName": "billing_comp_id"
                        },
                        "Value": {
                          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                          "SerializeProperty": "=P_請求先ID"
                        }
                      },
                      "Condition2": {
                        "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                        "ColumnBindingInfo": {
                          "TableName": "t_sales",
                          "ColumnName": "billing_date"
                        },
                        "Value": {
                          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                          "SerializeProperty": "=請求日"
                        }
                      }
                    }
                  },
                  "ID": "a9d8afb90cca463980bc7d1c98af9540"
                },
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=同一請求件数"
                          }
                        },
                        "value": "0",
                        "compareType": 2
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "請求番号",
                          "TableValue": {
                            "TableName": "t_sales",
                            "OnlyGetValue": true,
                            "TableValueType": 0,
                            "BindingInfos": [
                              {
                                "BindingInfo": {
                                  "TableName": "t_sales",
                                  "ColumnName": "billing_no"
                                },
                                "ColumnName": "billing_no"
                              }
                            ],
                            "SqlCondition": {
                              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                              "Condition1": {
                                "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                "ColumnBindingInfo": {
                                  "TableName": "t_sales",
                                  "ColumnName": "billing_comp_id"
                                },
                                "Value": {
                                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                  "SerializeProperty": "=P_請求先ID"
                                }
                              },
                              "Condition2": {
                                "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                "ColumnBindingInfo": {
                                  "TableName": "t_sales",
                                  "ColumnName": "billing_date"
                                },
                                "Value": {
                                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                  "SerializeProperty": "=請求日"
                                }
                              }
                            },
                            "TopCount": "1"
                          },
                          "ID": "01bbe90872fd43048c4b63c5563e8016"
                        }
                      ],
                      "ID": "f1bab53f-b304-442e-b0ea-bcda3ebd0dd3"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "請求連番件数",
                          "TableValue": {
                            "TableName": "t_sales",
                            "TableValueType": 3,
                            "SqlCondition": {
                              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                              "ColumnBindingInfo": {
                                "TableName": "t_sales",
                                "ColumnName": "billing_yyyymm"
                              },
                              "Value": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=請求年月"
                              }
                            }
                          },
                          "ID": "7bb6ec7956bf4aa9b1ee4ddb1dfa38ca"
                        },
                        {
                          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                          "ConditionAndCommandPairList": [
                            {
                              "Condition": {
                                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                                "param": {
                                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                                  "ParamObject": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=請求連番件数"
                                  }
                                },
                                "value": "0",
                                "compareType": 2
                              },
                              "CommandList": [
                                {
                                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                                  "ParameterName": "最終請求連番",
                                  "TableValue": {
                                    "TableName": "t_sales",
                                    "OnlyGetValue": true,
                                    "TableValueType": 0,
                                    "BindingInfos": [
                                      {
                                        "BindingInfo": {
                                          "TableName": "t_sales",
                                          "ColumnName": "billing_serial_number"
                                        },
                                        "ColumnName": "billing_serial_number"
                                      }
                                    ],
                                    "SqlCondition": {
                                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                      "ColumnBindingInfo": {
                                        "TableName": "t_sales",
                                        "ColumnName": "billing_yyyymm"
                                      },
                                      "Value": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=請求年月"
                                      }
                                    },
                                    "TopCount": "1",
                                    "OrderBySqlCondition": {
                                      "OrderByColumns": [
                                        {
                                          "ColumnBindingInfo": {
                                            "TableName": "t_sales",
                                            "ColumnName": "billing_serial_number"
                                          },
                                          "Order": 1
                                        }
                                      ]
                                    }
                                  },
                                  "ID": "4b4c448bf67a4b32a3951cc01a668c44"
                                }
                              ],
                              "ID": "6d94a46b-f5c6-4be0-ac7f-bdade2f7fba2"
                            }
                          ]
                        }
                      ],
                      "ID": "f2067e59-3bb2-49c4-b68f-1d28e0c62503"
                    }
                  ]
                }
              ],
              "ID": "97b06587-b81d-4275-9f2f-b866758b0d86"
            },
            {
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "同一請求件数",
                  "TableValue": {
                    "TableName": "t_sales",
                    "TableValueType": 3,
                    "SqlCondition": {
                      "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                      "Condition1": {
                        "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                        "Condition1": {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "ColumnBindingInfo": {
                            "TableName": "t_sales",
                            "ColumnName": "billing_comp_id"
                          },
                          "Value": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=P_請求先ID"
                          }
                        },
                        "Condition2": {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "ColumnBindingInfo": {
                            "TableName": "t_sales",
                            "ColumnName": "billing_date"
                          },
                          "Value": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=請求日"
                          }
                        }
                      },
                      "Condition2": {
                        "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                        "ColumnBindingInfo": {
                          "TableName": "t_sales",
                          "ColumnName": "object_order_id",
                          "RelationBinding": {
                            "RelatedTable": "t_object_order",
                            "RelatedColumn": "object_order_id",
                            "DisplayColumn": "object_id"
                          }
                        },
                        "Value": {
                          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                          "SerializeProperty": "=物件申込.物件ID"
                        }
                      }
                    }
                  },
                  "ID": "b5a441a5f6b848b9b4d32bebc303e0de"
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "最終請求連番",
                  "ParameterValue": "0",
                  "ID": "965c22f00aec4c6bb75dd2d808141c4f"
                },
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=同一請求件数"
                          }
                        },
                        "value": "0",
                        "compareType": 2
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "請求番号",
                          "TableValue": {
                            "TableName": "t_sales",
                            "OnlyGetValue": true,
                            "TableValueType": 0,
                            "BindingInfos": [
                              {
                                "BindingInfo": {
                                  "TableName": "t_sales",
                                  "ColumnName": "billing_no"
                                },
                                "ColumnName": "billing_no"
                              }
                            ],
                            "SqlCondition": {
                              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                              "Condition1": {
                                "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                                "Condition1": {
                                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                  "ColumnBindingInfo": {
                                    "TableName": "t_sales",
                                    "ColumnName": "billing_comp_id"
                                  },
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=P_請求先ID"
                                  }
                                },
                                "Condition2": {
                                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                  "ColumnBindingInfo": {
                                    "TableName": "t_sales",
                                    "ColumnName": "billing_date"
                                  },
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=請求日"
                                  }
                                }
                              },
                              "Condition2": {
                                "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                "ColumnBindingInfo": {
                                  "TableName": "t_sales",
                                  "ColumnName": "object_order_id",
                                  "RelationBinding": {
                                    "RelatedTable": "t_object_order",
                                    "RelatedColumn": "object_order_id",
                                    "DisplayColumn": "object_id"
                                  }
                                },
                                "Value": {
                                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                  "SerializeProperty": "=物件申込.物件ID"
                                }
                              }
                            },
                            "TopCount": "1"
                          },
                          "ID": "b5e63c0bd43946f49b274e74358a99c3"
                        }
                      ],
                      "ID": "b153fc0e-e4eb-4311-8afc-2a8a6eadc6a2"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "請求連番件数",
                          "TableValue": {
                            "TableName": "t_sales",
                            "TableValueType": 3,
                            "SqlCondition": {
                              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                              "ColumnBindingInfo": {
                                "TableName": "t_sales",
                                "ColumnName": "billing_yyyymm"
                              },
                              "Value": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=請求年月"
                              }
                            }
                          },
                          "ID": "7c4954fa22384590aebc2218cc9f33ca"
                        },
                        {
                          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                          "ConditionAndCommandPairList": [
                            {
                              "Condition": {
                                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                                "param": {
                                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                                  "ParamObject": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=請求連番件数"
                                  }
                                },
                                "value": "0",
                                "compareType": 2
                              },
                              "CommandList": [
                                {
                                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                                  "ParameterName": "最終請求連番",
                                  "TableValue": {
                                    "TableName": "t_sales",
                                    "OnlyGetValue": true,
                                    "TableValueType": 0,
                                    "BindingInfos": [
                                      {
                                        "BindingInfo": {
                                          "TableName": "t_sales",
                                          "ColumnName": "billing_serial_number"
                                        },
                                        "ColumnName": "billing_serial_number"
                                      }
                                    ],
                                    "SqlCondition": {
                                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                      "ColumnBindingInfo": {
                                        "TableName": "t_sales",
                                        "ColumnName": "billing_yyyymm"
                                      },
                                      "Value": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=請求年月"
                                      }
                                    },
                                    "TopCount": "1",
                                    "OrderBySqlCondition": {
                                      "OrderByColumns": [
                                        {
                                          "ColumnBindingInfo": {
                                            "TableName": "t_sales",
                                            "ColumnName": "billing_serial_number"
                                          },
                                          "Order": 1
                                        }
                                      ]
                                    }
                                  },
                                  "ID": "7e26e6182a1a4a7c83593c9af156e587"
                                }
                              ],
                              "ID": "ddd37f86-c15d-482c-a733-08875e251b69"
                            }
                          ]
                        }
                      ],
                      "ID": "bac5828c-6eab-46b6-9a16-1857e9e110eb"
                    }
                  ]
                }
              ],
              "ID": "4d46c48b-fca6-411b-af07-032957058494"
            }
          ],
          "Comments": "請求番号取得"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "新規請求連番",
          "ParameterValue": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=最終請求連番+1"
          },
          "ID": "e770afa746d64d9c9506c8403b068096"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "請求番号",
          "ParameterValue": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=\"MP\"&請求年月&TEXT(新規請求連番,\"000\")"
          },
          "ID": "0c085afb995c43aea4e72a8498e4c25d"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "消費税額",
          "ParameterValue": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=ROUNDDOWN(P_請求税抜金額*最新税率,0)"
          },
          "ID": "c4cffd8e2b9f4135be725d4dfc6bb202"
        },
        {
          "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
          "TableName": "t_sales",
          "UpdateType": "add",
          "ShowConfirm": false,
          "ConfirmText": "本当に追加してもよろしいですか？",
          "UpdateValues": [
            {
              "ColumnName": "object_order_id",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_申込ID"
              }
            },
            {
              "ColumnName": "sales_date",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_計上確定日"
              }
            },
            {
              "ColumnName": "sales_type",
              "Value": "1"
            },
            {
              "ColumnName": "billing_no",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=請求番号"
              }
            },
            {
              "ColumnName": "billing_comp_id",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_請求先ID"
              }
            },
            {
              "ColumnName": "billing_date",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=請求日"
              }
            },
            {
              "ColumnName": "billing_yyyymm",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=VALUE(請求年月)"
              }
            },
            {
              "ColumnName": "billing_serial_number",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=VALUE(新規請求連番)"
              }
            },
            {
              "ColumnName": "builder_id",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=物件申込.住宅事業者ID"
              }
            },
            {
              "ColumnName": "builder_name",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=物件申込.住宅事業者名"
              }
            },
            {
              "ColumnName": "object_name",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=物件申込.物件名"
              }
            },
            {
              "ColumnName": "object_address",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=物件申込.物件住所"
              }
            },
            {
              "ColumnName": "tax_rate",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=最新税率"
              }
            },
            {
              "ColumnName": "object_product_id",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_物件商品ID"
              }
            },
            {
              "ColumnName": "excluding_tax_amount",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_請求税抜金額"
              }
            },
            {
              "ColumnName": "tax_amount",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=消費税額"
              }
            },
            {
              "ColumnName": "billing_amount",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_請求税抜金額+消費税額"
              }
            },
            {
              "ColumnName": "billing_product_name",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_請求商品名"
              }
            },
            {
              "ColumnName": "billing_remarks",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_請求備考"
              }
            },
            {
              "ColumnName": "collect_scheduled_date",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=回収予定日"
              }
            }
          ]
        },
        {
          "$type": "Forguncy.Model.ReturnCommand, ServerDesignerCommon",
          "ErrorCode": "0",
          "CustomReturns": []
        }
      ]
    }
  ],
  "Name": "請求データ作成処理"
}