{
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.ServerCommands.Models.PostRequestTrigger, ServerDesignerCommon",
      "Permission": {
        "AllowRoles": [
          "FGC_LoginUser"
        ]
      },
      "Parameters": [
        {
          "Name": "P_物件商品ID"
        }
      ]
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon",
      "CommandList": [
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "物件商品",
          "TableValue": {
            "TableName": "t_object_product",
            "TableValueType": 1,
            "BindingInfos": [
              {
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "object_order_id"
                },
                "ColumnName": "申込ID"
              },
              {
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "product_id"
                },
                "ColumnName": "商品ID"
              },
              {
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "billing_comp_id"
                },
                "ColumnName": "請求先ID"
              },
              {
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "sales_amount"
                },
                "ColumnName": "売上金額"
              },
              {
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "purchase_receipt_date"
                },
                "ColumnName": "発注書受領日"
              },
              {
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "billing_comp_id",
                  "RelationBinding": {
                    "RelatedTable": "m_customer",
                    "RelatedColumn": "customer_id",
                    "DisplayColumn": "customer_name"
                  }
                },
                "ColumnName": "請求先名"
              },
              {
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "billing_comp_id",
                  "RelationBinding": {
                    "RelatedTable": "m_customer",
                    "RelatedColumn": "customer_id",
                    "DisplayColumn": "billing_name"
                  }
                },
                "ColumnName": "請求書宛名"
              },
              {
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "billing_comp_id",
                  "RelationBinding": {
                    "RelatedTable": "m_customer",
                    "RelatedColumn": "customer_id",
                    "DisplayColumn": "closing_date"
                  }
                },
                "ColumnName": "請求締日"
              },
              {
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "billing_comp_id",
                  "RelationBinding": {
                    "RelatedTable": "m_customer",
                    "RelatedColumn": "customer_id",
                    "DisplayColumn": "deposit_month"
                  }
                },
                "ColumnName": "入金月"
              },
              {
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "billing_comp_id",
                  "RelationBinding": {
                    "RelatedTable": "m_customer",
                    "RelatedColumn": "customer_id",
                    "DisplayColumn": "deposit_day"
                  }
                },
                "ColumnName": "入金日"
              },
              {
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "billing_comp_id",
                  "RelationBinding": {
                    "RelatedTable": "m_customer",
                    "RelatedColumn": "customer_id",
                    "DisplayColumn": "deposit_business_day"
                  }
                },
                "ColumnName": "入金営業日"
              }
            ],
            "SqlCondition": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_product",
                "ColumnName": "object_product_id"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_物件商品ID"
              }
            }
          },
          "ID": "36ba6c3f71d14db5a45bc1575b4241b8"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "請求日",
          "ID": "09a56c84455a40559b56a36f5a5c2e94"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "回収予定日",
          "ID": "369d1700676545f09a7aba9501ab0183"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=物件商品.請求締日"
                  }
                },
                "value": "29,30,31",
                "compareType": 12
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "請求日",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=EOMONTH(TODAY(),0)"
                  },
                  "ID": "36e5360fca0042bbb9dc00e93f5c4c86"
                }
              ],
              "Comments": "月末締めの場合",
              "ID": "2141f6ca-2dbf-4012-a4e2-74360e58bc58"
            },
            {
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "当月請求日",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=DATE(YEAR(TODAY()),MONTH(TODAY()),物件商品.請求締日)"
                  },
                  "ID": "7867ff497a2c4066b53fa167387aef9c"
                },
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=TODAY()"
                          }
                        },
                        "value": {
                          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                          "SerializeProperty": "=当月請求日"
                        },
                        "compareType": 5
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "請求日",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=当月請求日"
                          },
                          "ID": "fe65fe70a07d47798028cb5d39c97374"
                        }
                      ],
                      "ID": "f0c9768b-06ee-47e6-9da3-6f0c43e273bc"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "請求日",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=EDATE(当月請求日,1)"
                          },
                          "ID": "6deeb173a3514151b501adea41ddfd9e"
                        }
                      ],
                      "ID": "b344b40e-60bf-4709-a76a-51fbd93743a7"
                    }
                  ]
                }
              ],
              "ID": "3a36fe79-c430-4756-b36f-fcfb4389a947"
            }
          ],
          "Comments": "請求日取得"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=物件商品.入金日"
                  }
                },
                "value": "29,30,31",
                "compareType": 12
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "基準回収予定日",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=EOMONTH(EDATE(請求日,物件商品.入金月),0)"
                  },
                  "ID": "0efd0838cf134ca4842f8fee1f73842e"
                }
              ],
              "ID": "f1bce636-c950-4c74-a640-6fb9544ee481"
            },
            {
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "基準回収予定日",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=DATE(YEAR(EDATE(請求日,物件商品.入金月)),MONTH(EDATE(請求日,物件商品.入金月)),物件商品.入金日)"
                  },
                  "ID": "3e21c507771a47edbaad413cf13df75f"
                }
              ],
              "ID": "904002d8-0327-4509-8e63-d03a6c67a84b"
            }
          ],
          "Comments": "回収予定日取得"
        },
        {
          "$type": "Forguncy.Model.ReturnCommand, ServerDesignerCommon",
          "ErrorCode": "100",
          "Message": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=TEXT(請求日,\"yyyy/mm/dd\")"
          },
          "CustomReturns": []
        }
      ]
    }
  ],
  "Name": "請求データ作成処理"
}