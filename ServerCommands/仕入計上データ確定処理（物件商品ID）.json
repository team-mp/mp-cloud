{
  "Name": "仕入計上データ確定処理（物件商品ID）",
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.SaveLoad.PostRequestTriggerSaveData, ServerDesignerCommon",
      "Permission": {
        "PermissionData": {
          "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionData, Forguncy.RbacPermission.Core",
          "permissionResource": {
            "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionResource, Forguncy.RbacPermission.Core"
          },
          "permissionBindings": [
            {
              "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionBinding, Forguncy.RbacPermission.Core",
              "roleNames": [
                "FGC_LoginUser"
              ]
            }
          ]
        }
      },
      "Parameters": [
        {
          "Name": "P_物件商品ID",
          "DataValidationInfo": {}
        }
      ]
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon",
      "CommandList": [
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "物件商品",
          "TableValue": {
            "TableName": "t_object_product",
            "TableValueType": 1,
            "BindingInfos": [
              {
                "GUID": "a00d0bc3-262d-44be-9bf1-2aecd6c594c6",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "object_order_id",
                  "GUID": "983f3423-29f7-4a0e-89f9-5affca07df72"
                },
                "ColumnName": "申込ID"
              },
              {
                "GUID": "79486a3c-246e-4c4e-9b81-3e2b3371b9c7",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "register_date",
                  "GUID": "33c005eb-a536-40e8-870c-1153598c5d85"
                },
                "ColumnName": "登録日"
              },
              {
                "GUID": "e50c6383-ca98-4c01-a760-02195fd31ea4",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "billing_comp_id",
                  "GUID": "fc4cbb22-6177-486c-ad73-ef9b80d84406"
                },
                "ColumnName": "請求先ID"
              },
              {
                "GUID": "9fea31a5-788b-46f3-abec-940bf9fc381b",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "product_id",
                  "GUID": "170a8e83-54c2-48b3-aeab-1c92726e0a03"
                },
                "ColumnName": "商品ID"
              },
              {
                "GUID": "1be30b7b-8416-43f2-aec5-59b31a48d0e0",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "accounting_type",
                  "GUID": "7eff94a1-b0bf-44f6-bae9-0a08acca1963"
                },
                "ColumnName": "計上区分"
              },
              {
                "GUID": "cb6945a2-ffd7-4a17-8376-7565c13cf3a7",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "product_name",
                  "GUID": "8b78e41a-8e70-4a4f-aade-4c5c82eb5455"
                },
                "ColumnName": "商品名"
              },
              {
                "GUID": "acc306bf-656b-4ea0-9955-e6e9ae3fc7de",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "remarks",
                  "GUID": "2377c011-78a2-47d2-a821-eeb6dda049dd"
                },
                "ColumnName": "備考"
              },
              {
                "GUID": "9ae6bdb0-9c29-4cce-8deb-67e0a6aae3a9",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "remarks2",
                  "GUID": "c8f5ee92-d00f-4085-98a4-e642d80ddd05"
                },
                "ColumnName": "備考2"
              },
              {
                "GUID": "faa325dd-83d9-4700-85bf-499472cca696",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "sales_amount",
                  "GUID": "4faf4a92-3c98-4fb5-bf1b-f724070e1901"
                },
                "ColumnName": "売上金額"
              },
              {
                "GUID": "9e6e7620-18bf-498b-a5a2-699eab3eaa1a",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "dedicated_billing_no",
                  "GUID": "605e44e1-2fb8-491e-b3d4-95b8799cc7f9"
                },
                "ColumnName": "専用請求番号"
              },
              {
                "GUID": "a452e53b-f563-4d29-892c-0dedf6e9c986",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "purchase_required_flg",
                  "GUID": "46669502-9ba8-4404-b803-63cb85e0e8c8"
                },
                "ColumnName": "発注書必要フラグ"
              },
              {
                "GUID": "049dc92f-2433-425e-b225-31f8f26fdd9e",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "purchase_receipt_date",
                  "GUID": "27dc42d4-662b-4e45-a52f-8de62be3628a"
                },
                "ColumnName": "発注書受領日"
              },
              {
                "GUID": "9da1ee94-956c-40ef-89ae-d80af9415298",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "outsourcing_id",
                  "GUID": "f25a9039-9543-47f6-8a1e-4faf15a2509c"
                },
                "ColumnName": "外注先ID"
              },
              {
                "GUID": "13ce914b-ebdf-4c11-a13b-6543d1ece2b2",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "payment_comp_id",
                  "GUID": "ac26a143-c315-4b18-8cf8-c404d51112eb"
                },
                "ColumnName": "支払先ID"
              },
              {
                "GUID": "56a842c9-2fb4-42b4-a66b-4f8fd2ceb9c1",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "purchase_amount",
                  "GUID": "6efff202-d0c2-4551-b4f4-9d82b64d003d"
                },
                "ColumnName": "仕入金額"
              },
              {
                "GUID": "3904cf6e-8f90-4b6c-aeef-1fc88a0ad307",
                "BindingInfo": {
                  "TableName": "t_object_product",
                  "ColumnName": "sales_account_complete_flg",
                  "GUID": "73ed164c-6e7c-4f70-8ee6-8a8979b05e6b"
                },
                "ColumnName": "売上計上確定フラグ"
              }
            ],
            "SqlCondition": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_product",
                "ColumnName": "object_product_id",
                "GUID": "2b1343d3-2732-475b-a263-87b69ede3442"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_物件商品ID"
              }
            }
          },
          "ID": "e625fcdfe3fb481f9d80535e7c1020fb"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "V_計上確定済みステータスID",
          "TableValue": {
            "TableName": "m_account_status",
            "OnlyGetValue": true,
            "TableValueType": 0,
            "BindingInfos": [
              {
                "GUID": "e0adb5a1-a034-495b-b0b2-6e75141c4ad5",
                "BindingInfo": {
                  "TableName": "m_account_status",
                  "ColumnName": "account_status_id",
                  "GUID": "8476efb1-b9b5-4810-a581-5862e6441c46"
                },
                "ColumnName": "account_status_id"
              }
            ],
            "SqlCondition": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "m_account_status",
                "ColumnName": "account_confirm_done_flg",
                "GUID": "1d4bcbf7-5f8d-4a1f-a55b-39189807989f"
              },
              "Value": "1"
            }
          },
          "ID": "89b82dab5b95428eb57e675a0e9be19f"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "V_計上確定フラグ",
          "ParameterValue": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=IF(OR(AND(物件商品.計上区分=1,物件商品.売上計上確定フラグ=1),物件商品.計上区分=3),1,0)"
          },
          "ID": "79aae259f17f43e09a16ce0464c73fb3"
        },
        {
          "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
          "TableName": "t_object_product",
          "ShowConfirm": false,
          "RowsToUpdate": 1,
          "RowsToUpdateCondition": {
            "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
            "ColumnBindingInfo": {
              "TableName": "t_object_product",
              "ColumnName": "object_product_id",
              "GUID": "2b5ddbb0-c129-4695-92b8-3e3855e46339"
            },
            "Value": {
              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
              "SerializeProperty": "=P_物件商品ID"
            }
          },
          "UpdateBindingValues": [
            {
              "BindingInfo": {
                "TableName": "t_object_product",
                "ColumnName": "purchase_account_complete_flg",
                "GUID": "d387f806-8e30-4fff-ac09-3eaef3a515ba"
              },
              "Value": "1"
            },
            {
              "BindingInfo": {
                "TableName": "t_object_product",
                "ColumnName": "purchase_account_complete_date",
                "GUID": "25c642b5-93ae-4ff4-9574-cbf982916b27"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=TODAY()"
              }
            },
            {
              "BindingInfo": {
                "TableName": "t_object_product",
                "ColumnName": "purchase_account_complete_userid",
                "GUID": "b740565b-7465-47dd-8828-0e76be337aac"
              },
              "Value": "%CurrentUser.user_id%"
            },
            {
              "BindingInfo": {
                "TableName": "t_object_product",
                "ColumnName": "purchase_account_status_id",
                "GUID": "681355fa-c125-4b48-8cbe-c89a5aac1939"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=V_計上確定済みステータスID"
              }
            },
            {
              "BindingInfo": {
                "TableName": "t_object_product",
                "ColumnName": "account_complete_flg",
                "GUID": "bb964f5b-e2b5-4187-9e2b-0edfe8ff453d"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=V_計上確定フラグ"
              }
            }
          ],
          "Comments": "計上確定に更新"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=物件商品.計上区分"
                  }
                },
                "value": "2",
                "compareType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
                  "ServerCommandName": "支払データ作成処理",
                  "Parameters": [
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_申込ID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=物件商品.申込ID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_物件商品ID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_物件商品ID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_仕入日",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=TODAY()"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_買掛区分",
                      "Value": "1"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_仕入区分",
                      "Value": "1"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_外注先ID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=物件商品.外注先ID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_支払先ID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=物件商品.支払先ID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_支払商品ID",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=物件商品.商品ID"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_支払商品名",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=物件商品.商品名"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_支払備考"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_税抜金額",
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=物件商品.仕入金額"
                      }
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_消費税額"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_消費税率"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_支払日"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_支払予定日"
                    },
                    {
                      "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                      "ParamName": "P_取消仕入ID"
                    }
                  ],
                  "ResultErrorCodeTo": {
                    "SerializeProperty": "リターコード"
                  },
                  "ResultMessageTo": {
                    "SerializeProperty": "リターンメッセージ"
                  },
                  "RefreshAfterFinish": true,
                  "CheckDataValidation": true
                },
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=リターコード"
                          }
                        },
                        "value": "0",
                        "compareType": 1
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.ReturnCommand, ServerDesignerCommon",
                          "ErrorCode": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=リターコード"
                          },
                          "Message": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=リターンメッセージ"
                          }
                        }
                      ],
                      "ID": "5acdf5a4-c9fe-4a9d-852e-22bd2e096a66"
                    }
                  ]
                }
              ],
              "ID": "f24a8344-795a-4dd2-875c-a0c6670020cd"
            }
          ]
        },
        {
          "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
          "ServerCommandName": "計上未確定発注書待ち件数更新処理",
          "Parameters": [
            {
              "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
              "ParamName": "P_申込ID",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=物件商品.申込ID"
              }
            }
          ],
          "ResultErrorCodeTo": {
            "SerializeProperty": "リターンコード"
          },
          "ResultMessageTo": {
            "SerializeProperty": "リターンメッセージ"
          },
          "RefreshAfterFinish": true,
          "CheckDataValidation": true
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=リターンコード"
                  }
                },
                "value": "0",
                "compareType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.ReturnCommand, ServerDesignerCommon",
                  "ErrorCode": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=リターンコード"
                  },
                  "Message": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=リターンメッセージ"
                  }
                }
              ],
              "ID": "d481ca15-35cf-4982-a702-8cc0872cf60a"
            }
          ]
        }
      ]
    }
  ]
}