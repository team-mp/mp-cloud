{
  "Name": "メール送信処理",
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.SaveLoad.PostRequestTriggerSaveData, ServerDesignerCommon",
      "Permission": {
        "PermissionData": {
          "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionData, Forguncy.RbacPermission.Core",
          "permissionResource": {
            "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionResource, Forguncy.RbacPermission.Core"
          },
          "permissionBindings": [
            {
              "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionBinding, Forguncy.RbacPermission.Core",
              "roleNames": [
                "FGC_LoginUser"
              ]
            }
          ]
        }
      },
      "Parameters": [
        {
          "Name": "P_差出人アドレス",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_送信元区分",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_宛先区分",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_TOユーザーIDs",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_TO追加アドレス",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_宛先TO",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_CCユーザーIDs",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_CC追加アドレス",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_宛先CC",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_件名",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_本文",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_添付ファイル",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_請求番号",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_申込ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_調査ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_測量ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_解析ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_転圧ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_工事見積ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_工事ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_保証ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_外販ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_送信ユーザーID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_ダウンロードリンクフラグ",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_filekey",
          "DataValidationInfo": {}
        }
      ]
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon",
      "CommandList": [
        {
          "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
          "ServerCommandName": "登録更新ラベル取得",
          "ReturnPropertiesTo": [
            {
              "ResultPropertyName": "R_ラベル名",
              "ResultTo": {
                "SerializeProperty": "送信者ラベル"
              }
            }
          ],
          "RefreshAfterFinish": true,
          "CheckDataValidation": true
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_差出人アドレス"
                  }
                },
                "value": "%Null%",
                "compareType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "差出人メールアドレス",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_差出人アドレス"
                  },
                  "ID": "25a670ef5c144ca3af70a6175b851bd6"
                }
              ],
              "ID": "41f33abb-b4a3-49d6-ba69-ce660793091c"
            },
            {
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "差出人メールアドレス",
                  "TableValue": {
                    "TableName": "m_environment",
                    "OnlyGetValue": true,
                    "TableValueType": 0,
                    "BindingInfos": [
                      {
                        "GUID": "98e2ef62-a46f-4d6f-9056-388ed3900b58",
                        "BindingInfo": {
                          "TableName": "m_environment",
                          "ColumnName": "mailsender_address",
                          "GUID": "84fce280-adb7-442a-93f1-215c80d18e75"
                        },
                        "ColumnName": "mailsender_address"
                      }
                    ],
                    "SqlCondition": {
                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                      "ColumnBindingInfo": {
                        "TableName": "m_environment",
                        "ColumnName": "ID",
                        "GUID": "26838ff4-abf9-4c38-adde-f8fbbebf7279"
                      },
                      "Value": "1"
                    }
                  },
                  "ID": "802eb92cc2bc48d48abf0d316e891cc5"
                }
              ],
              "ID": "2c075b7a-b8d5-4fed-8778-cddd0a07ee07"
            }
          ]
        },
        {
          "$type": "Forguncy.Model.CatchExceptionCommand, ServerDesignerCommon",
          "TryCommandPart": {
            "CommandList": [
              {
                "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                "ParameterName": "添付ファイル文字列",
                "ID": "aec97dbbe78e4eeab6f02af48f761400"
              },
              {
                "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                "ParameterName": "添付ファイル数",
                "ParameterValue": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=LEN(P_添付ファイル)-LEN(SUBSTITUTE(P_添付ファイル,\"|\",\"\"))"
                },
                "ID": "42fc8d9737f945d2b4813b9d429e8219"
              },
              {
                "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                "ParameterName": "ファイル名開始位置",
                "ParameterValue": "1",
                "ID": "f0f9261cef784e64b5706557046d7de7"
              },
              {
                "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                "ParameterName": "環境変数",
                "TableValue": {
                  "TableName": "m_environment",
                  "TableValueType": 1,
                  "BindingInfos": [
                    {
                      "GUID": "9e9797e9-aea8-4b91-9f8e-628c61ef49bd",
                      "BindingInfo": {
                        "TableName": "m_environment",
                        "ColumnName": "file_temp_path",
                        "GUID": "73b07991-3c0e-4d7c-8ab8-e229b4715a82"
                      },
                      "ColumnName": "ファイルTempパス"
                    },
                    {
                      "GUID": "a8aaf923-1d3b-4d83-b3c1-e8183505de2d",
                      "BindingInfo": {
                        "TableName": "m_environment",
                        "ColumnName": "app_name",
                        "GUID": "8b7171bc-74d3-4f37-a564-d3fbb431d646"
                      },
                      "ColumnName": "アプリ名"
                    }
                  ],
                  "SqlCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "m_environment",
                      "ColumnName": "ID",
                      "GUID": "20762d4a-c5aa-4149-b0ec-0c05eb099652"
                    },
                    "Value": "1"
                  }
                },
                "ID": "cf6686de06f9447c9f11a13ce5418cd8"
              },
              {
                "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                "ParameterName": "Tempパス名",
                "ParameterValue": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=環境変数.ファイルTempパス&環境変数.アプリ名&\"\\Temp\\\""
                },
                "ID": "bcb20ab776bd4c72bc3b1f49ff6f5e34"
              },
              {
                "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
                "LoopInfo": {
                  "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
                  "LoopCount": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=添付ファイル数"
                  },
                  "LoopIndexParamName": "カウンター",
                  "LoopItemParamName": "Item"
                },
                "CommandList": [
                  {
                    "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                    "ParameterName": "文字数",
                    "ParameterValue": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=IFERROR(FIND(\"|\",P_添付ファイル,ファイル名開始位置),1000)"
                    },
                    "ID": "972b371c10cd4fabba4538e036823730"
                  },
                  {
                    "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                    "ParameterName": "取得ファイル名",
                    "ParameterValue": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=MID(P_添付ファイル,ファイル名開始位置,文字数-ファイル名開始位置)"
                    },
                    "ID": "fd02108d22ad4759b525499191d7952e"
                  },
                  {
                    "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                    "ConditionAndCommandPairList": [
                      {
                        "Condition": {
                          "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                          "param": {
                            "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                            "ParamObject": {
                              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                              "SerializeProperty": "=取得ファイル名"
                            }
                          },
                          "value": "%Null%",
                          "compareType": 1
                        },
                        "CommandList": [
                          {
                            "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                            "ConditionAndCommandPairList": [
                              {
                                "Condition": {
                                  "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                                  "param": {
                                    "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                                    "ParamObject": {
                                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                      "SerializeProperty": "=P_ダウンロードリンクフラグ"
                                    }
                                  },
                                  "value": "1"
                                },
                                "CommandList": [
                                  {
                                    "$type": "OperateFilesCommand.CreateFolderCommand, OperateFilesCommand",
                                    "FolderPath": {
                                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                      "SerializeProperty": "=Download_Server_Path&P_filekey"
                                    }
                                  },
                                  {
                                    "$type": "Forguncy.Model.Commands.ServerImportExportCSVCommand, ServerDesignerCommon",
                                    "CSVOperation": 1,
                                    "FilePath": {
                                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                      "SerializeProperty": "=Download_Server_Path&P_filekey"
                                    },
                                    "TableName": "m_environment",
                                    "Columns": [
                                      {
                                        "BindingColumn": {
                                          "TableName": "m_environment",
                                          "ColumnName": "ID",
                                          "GUID": "41937ef1-841a-4ce1-8cab-bd48ab1f6bda"
                                        },
                                        "CSVColumnNameOrIndex": "ID",
                                        "IsPrimaryKey": true
                                      }
                                    ],
                                    "ImportCSVEncoding": "UTF-8",
                                    "RowDelimiter": "\\r\\n",
                                    "ColumnDelimiter": ",",
                                    "TextQualifier": "\"",
                                    "Comments": "このファイルはfilekeyの作成日時を識別するために一次的に作成します"
                                  },
                                  {
                                    "$type": "OperateFilesCommand.CopyFileCommand, OperateFilesCommand",
                                    "FilePath": {
                                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                      "SerializeProperty": "=Tempパス名&取得ファイル名"
                                    },
                                    "TargetFolderPath": {
                                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                      "SerializeProperty": "=Download_Server_Path&P_filekey"
                                    }
                                  }
                                ],
                                "ID": "a9e48302-e52f-4f94-b53f-7aa81d70968f"
                              }
                            ]
                          },
                          {
                            "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                            "ParameterName": "表示ファイル名",
                            "ParameterValue": {
                              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                              "SerializeProperty": "=MID(取得ファイル名,38,100)"
                            },
                            "ID": "db516deb1e364a9989d50ce82992f4d2"
                          },
                          {
                            "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                            "ConditionAndCommandPairList": [
                              {
                                "Condition": {
                                  "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                                  "param": {
                                    "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                                    "ParamObject": {
                                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                      "SerializeProperty": "=カウンター"
                                    }
                                  },
                                  "value": "1"
                                },
                                "CommandList": [
                                  {
                                    "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                                    "ParameterName": "添付ファイル文字列",
                                    "ParameterValue": {
                                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                      "SerializeProperty": "=\"・\"&表示ファイル名"
                                    },
                                    "ID": "40a4f694aa9445e1b1ca1f18a4801cd5"
                                  }
                                ],
                                "ID": "4e54729c-dfd3-4b15-a640-6ab704387a34"
                              },
                              {
                                "CommandList": [
                                  {
                                    "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                                    "ParameterName": "添付ファイル文字列",
                                    "ParameterValue": {
                                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                      "SerializeProperty": "=添付ファイル文字列&CHAR(10)&\"・\"&表示ファイル名"
                                    },
                                    "ID": "6e32d863d91e47639b9a63199edbcb2d"
                                  }
                                ],
                                "ID": "1aa61f99-428d-4b53-a624-70ed6c1ed53a"
                              }
                            ]
                          }
                        ],
                        "ID": "8c810a96-36d9-4639-bdc3-23b9763e3a91"
                      }
                    ]
                  },
                  {
                    "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                    "ParameterName": "ファイル名開始位置",
                    "ParameterValue": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=文字数+1"
                    },
                    "ID": "9402f60d0cbb48d18febfa8080eaadc1"
                  }
                ]
              },
              {
                "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                "TableName": "t_mail_history",
                "UpdateType": "add",
                "ShowConfirm": false,
                "UpdateBindingValues": [
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "sender_address",
                      "GUID": "75a9d2e1-68c9-407f-bd86-53ff9ea11e21"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=差出人メールアドレス"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "sender_type",
                      "GUID": "561cd6e5-6019-49f1-bb71-29ccb6bfe621"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_送信元区分"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "post_type",
                      "GUID": "412e3ff1-7ed4-4fca-91f1-9594c4d2fa8d"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_宛先区分"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "to_user_ids",
                      "GUID": "85e54d7a-9d8e-4619-b122-7511ad40f84b"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_TOユーザーIDs"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "to_add_address",
                      "GUID": "33c28812-0cf5-4e10-84f8-e885968c7c29"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_TO追加アドレス"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "to_address",
                      "GUID": "71d8baca-2aa9-47a6-a0e2-311971846807"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_宛先TO"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "cc_user_ids",
                      "GUID": "a2a9359f-879d-420e-9b86-e79817e4632e"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_CCユーザーIDs"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "cc_add_address",
                      "GUID": "0eab418d-e5a5-4ffe-9a5b-101d7939fec1"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_CC追加アドレス"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "cc_address",
                      "GUID": "bb785bfb-b9b4-4f33-bc20-1e5bc6806a7f"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_宛先CC"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "subject",
                      "GUID": "cd5fd814-00aa-45cd-af11-4ce3279f0f49"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_件名"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "body",
                      "GUID": "4a0a4dea-0982-43f7-82c9-2a604a1505fc"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_本文"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "attachment_files",
                      "GUID": "cdffbd0f-8b79-4f62-b15c-a2ade6cdbf43"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=添付ファイル文字列"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "billing_no",
                      "GUID": "bdb4c294-38ac-4439-ae0e-ea5e3db127a8"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_請求番号"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "object_order_id",
                      "GUID": "eebb75a4-2073-4a3d-b058-46755c155064"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_申込ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "survey_id",
                      "GUID": "2506202a-80e8-4b02-aaa8-ca0a03514ada"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_調査ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "surveying_id",
                      "GUID": "4bb9ef82-dc6f-4f10-8793-f25135ea1bb6"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_測量ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "analysis_id",
                      "GUID": "e88f483f-731b-4271-8cd3-fc0b07c4793d"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_解析ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "compaction_id",
                      "GUID": "c3ce141f-0150-462b-bde6-1661abdaa162"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_転圧ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "construction_estimate_id",
                      "GUID": "a5315c02-5d04-4c19-a68f-f622a8c3f677"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_工事見積ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "construction_id",
                      "GUID": "b41ab314-74c1-4218-98a1-8d86ae457e1c"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_工事ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "warranty_id",
                      "GUID": "fc1a49ee-d84f-4bd8-8e78-ae823c91a8e8"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_保証ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "external_id",
                      "GUID": "3f1d8b11-4cfe-4bbf-981b-f7127436a931"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_外販ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "send_user_id",
                      "GUID": "f94ffb4b-776e-4121-92c5-a88a37d196ba"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_送信ユーザーID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "send_date",
                      "GUID": "806c5284-cdce-489b-a81e-7e2bf8434667"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=NOW()"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "send_label",
                      "GUID": "b723ee73-7825-4bd0-8c9a-355824be0499"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=送信者ラベル"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "send_error_flg",
                      "GUID": "faf57d7d-d583-43cc-ac17-0d301bc16c1b"
                    },
                    "Value": "0"
                  }
                ]
              },
              {
                "$type": "Forguncy.Model.SendMailCommand, ServerDesignerCommon",
                "From": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=差出人メールアドレス"
                },
                "EnhancedRecipient": {
                  "CommonValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_宛先TO"
                  }
                },
                "Subject": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=P_件名"
                },
                "Content": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=P_本文"
                },
                "EnhancedCC": {
                  "CommonValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_宛先CC"
                  }
                },
                "Attachments": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=IF(P_ダウンロードリンクフラグ=1,\"\",P_添付ファイル)"
                },
                "ID": "b5ba81efd35f4c5985f14a823c86ded1"
              }
            ]
          },
          "CatchCommandPart": {
            "CommandList": [
              {
                "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                "ParameterName": "送信者メールドレス",
                "TableValue": {
                  "TableName": "m_user",
                  "OnlyGetValue": true,
                  "TableValueType": 0,
                  "BindingInfos": [
                    {
                      "GUID": "7c4c3053-b659-41bf-bfb5-5bcf3d8fd243",
                      "BindingInfo": {
                        "TableName": "m_user",
                        "ColumnName": "mail_address",
                        "GUID": "eac77e66-8025-457e-bbf8-9c359d4e7492"
                      },
                      "ColumnName": "mail_address"
                    }
                  ],
                  "SqlCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "m_user",
                      "ColumnName": "user_id",
                      "GUID": "0d15da59-d307-41ae-bbfc-876566336bdc"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_送信ユーザーID"
                    }
                  }
                },
                "ID": "b6fe1f0c2fd948c587ed1d919e1f0b11"
              },
              {
                "$type": "Forguncy.Model.SendMailCommand, ServerDesignerCommon",
                "From": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=差出人メールアドレス"
                },
                "EnhancedRecipient": {
                  "CommonValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=送信者メールドレス"
                  }
                },
                "Subject": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=\"【送信エラー】\"&P_件名"
                },
                "Content": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=\"以下のメール内容については送信エラーとなりました。\"&CHAR(10)&\"設定したメールアドレスに間違いがないかを確認し再送信してください。\"&CHAR(10)&CHAR(10)&P_本文"
                },
                "Attachments": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=P_添付ファイル"
                },
                "ID": "84bd1b9ac4bd4a73a242f129f333322b"
              },
              {
                "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                "TableName": "t_mail_history",
                "UpdateType": "add",
                "ShowConfirm": false,
                "UpdateBindingValues": [
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "sender_address",
                      "GUID": "bcb10de1-4923-4d1d-9c12-95c53fc9e20c"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=差出人メールアドレス"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "sender_type",
                      "GUID": "e36fac25-919a-453e-b366-1633a9305bf1"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_送信元区分"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "post_type",
                      "GUID": "686e86aa-06c9-44d7-8f5e-e7362ff22b67"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_宛先区分"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "to_user_ids",
                      "GUID": "833fedc7-57f1-43c0-8592-ba3ddbf9f2df"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_TOユーザーIDs"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "to_add_address",
                      "GUID": "3a9a80f1-1325-4b4d-8d4a-ddb6252b93d6"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_TO追加アドレス"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "to_address",
                      "GUID": "7b672ddd-f732-45ad-9769-30d1aec5e095"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_宛先TO"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "cc_user_ids",
                      "GUID": "2627eb61-2237-49c6-b083-f010f10a2466"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_CCユーザーIDs"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "cc_add_address",
                      "GUID": "742711ca-aaca-42df-8c87-bdc20c3bcf87"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_CC追加アドレス"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "cc_address",
                      "GUID": "ddbf5d0c-aa3d-4b42-bd9c-db9d360212a2"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_宛先CC"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "subject",
                      "GUID": "6866b9b9-3714-4cb7-979d-c0c2b93ffc05"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_件名"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "body",
                      "GUID": "da8e7fc3-8233-405e-b361-584768308cef"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_本文"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "attachment_files",
                      "GUID": "c9d9b10c-2769-46e9-816b-dbf6087ddb60"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=添付ファイル文字列"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "billing_no",
                      "GUID": "b04cc47c-bfaa-424f-b945-234473996c66"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_請求番号"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "object_order_id",
                      "GUID": "249c5f90-5420-4d75-a3e0-a27f400b277d"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_申込ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "survey_id",
                      "GUID": "78119141-4d5c-43f4-881c-979c25fe1e6a"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_調査ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "surveying_id",
                      "GUID": "bd7428ac-4ef9-483d-acaf-719b1e0eeb3f"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_測量ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "analysis_id",
                      "GUID": "770feb15-1b8e-4c06-9c4a-06809c3d6837"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_解析ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "compaction_id",
                      "GUID": "15787e9e-cee8-45ab-811d-8527306b70ae"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_転圧ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "construction_estimate_id",
                      "GUID": "b7fc1944-13a5-499f-9517-7e4c01e4986e"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_工事見積ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "construction_id",
                      "GUID": "845e107a-4b85-4ea6-b066-a34bc750f2a4"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_工事ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "warranty_id",
                      "GUID": "06d6f650-20f3-4967-b1ad-e953fd50a383"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_保証ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "external_id",
                      "GUID": "deb96825-b63f-48df-8da9-612fa8cb2679"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_外販ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "send_user_id",
                      "GUID": "2f0917a2-19d4-4860-a970-294f53f9b175"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_送信ユーザーID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "send_date",
                      "GUID": "03f969a5-76d7-495f-aa0d-44522d3b6d79"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=NOW()"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "send_label",
                      "GUID": "c9d08969-58c9-4316-9c46-c3abf4ac6ebb"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=送信者ラベル"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "send_error_flg",
                      "GUID": "8cf8e88a-2e5b-4502-961c-41dfe536b302"
                    },
                    "Value": "1"
                  }
                ]
              },
              {
                "$type": "Forguncy.Model.ReturnCommand, ServerDesignerCommon",
                "ErrorCode": "100",
                "Message": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=\"メール送信に失敗しました\"&CHAR(10)&ExceptionMessage"
                }
              }
            ]
          }
        }
      ]
    }
  ]
}