{
  "Name": "見積期限日一括更新処理",
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.SaveLoad.PostRequestTriggerSaveData, ServerDesignerCommon",
      "Permission": {
        "PermissionData": {
          "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionData, Forguncy.RbacPermission.Core",
          "permissionResource": {
            "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionResource, Forguncy.RbacPermission.Core"
          },
          "permissionBindings": [
            {
              "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionBinding, Forguncy.RbacPermission.Core",
              "roleNames": [
                "FGC_LoginUser"
              ]
            }
          ]
        }
      },
      "InvokeTriggerTestData": {
        "UserName": "Administrator"
      }
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "見積情報",
      "TableValue": {
        "TableName": "t_object_construction_estimate",
        "BindingInfos": [
          {
            "GUID": "554d9d8d-ae02-43d6-87ae-ea1f18dcb6f5",
            "BindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "construction_estimate_id",
              "GUID": "e861139d-605f-4ff3-b5c3-c85431e9e8fc"
            },
            "ColumnName": "工事見積ID"
          },
          {
            "GUID": "b2578ba2-f1e4-4305-a601-6004b0b42a50",
            "BindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "estimate_requested_date",
              "GUID": "d3597b01-1c02-45f1-a637-980cabe5b3c8"
            },
            "ColumnName": "見積依頼日"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "SubConditions": [
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "estimate_requested_date",
                "GUID": "a3f598d0-a09d-40f2-aec2-2e4b82212d1c"
              },
              "Value": "%Null%"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "estimate_period_date",
                "GUID": "9827b9f9-fda9-498c-aa25-d70be3e9602c"
              },
              "Value": "%Null%"
            }
          ]
        }
      },
      "ID": "f998e825527447e0adb9917de36ad5a8"
    },
    {
      "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
      "LoopInfo": {
        "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
        "LoopCount": {
          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
          "SerializeProperty": "=見積情報"
        },
        "LoopItemParamName": "Item"
      },
      "CommandList": [
        {
          "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
          "ServerCommandName": "営業日取得",
          "Parameters": [
            {
              "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
              "ParamName": "P_指定日",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=Item.見積依頼日"
              }
            },
            {
              "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
              "ParamName": "P_日数",
              "Value": "3"
            }
          ],
          "ReturnPropertiesTo": [
            {
              "ResultPropertyName": "R_営業日",
              "ResultTo": {
                "SerializeProperty": "営業日"
              },
              "Remark": "営業日計算後の日付が返却される"
            }
          ],
          "RefreshAfterFinish": true,
          "CheckDataValidation": true
        },
        {
          "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
          "TableName": "t_object_construction_estimate",
          "ShowConfirm": false,
          "RowsToUpdate": 1,
          "RowsToUpdateCondition": {
            "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
            "ColumnBindingInfo": {
              "TableName": "t_object_construction_estimate",
              "ColumnName": "construction_estimate_id",
              "GUID": "d8ab55d6-6122-4a7b-9976-ffcbd32ac89c"
            },
            "Value": {
              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
              "SerializeProperty": "=Item.工事見積ID"
            }
          },
          "UpdateBindingValues": [
            {
              "BindingInfo": {
                "TableName": "t_object_construction_estimate",
                "ColumnName": "estimate_period_date",
                "GUID": "1a57c043-53f4-4bf2-8ed0-1d42e5e25311"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=営業日"
              }
            }
          ]
        }
      ]
    }
  ]
}