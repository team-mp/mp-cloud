{
  "Name": "メール送信処理（スケジュールタスク）",
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.SaveLoad.InvokeTriggerSaveData, ServerDesignerCommon",
      "Parameters": [
        {
          "Name": "P_送信元区分",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_宛先区分",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_差出人アドレス",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_ユーザーグループID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_TOユーザーIDs",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_TO追加アドレス",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_宛先TO",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_CCユーザーIDs",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_CC追加アドレス",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_宛先CC",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_件名",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_本文",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_添付ファイル",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_請求番号",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_申込ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_調査ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_測量ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_解析ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_転圧ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_工事見積ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_工事ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_保証ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_外販ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_送信ユーザーID",
          "DataValidationInfo": {}
        }
      ]
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon",
      "CommandList": [
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "差出人メールアドレス",
          "TableValue": {
            "TableName": "m_environment",
            "OnlyGetValue": true,
            "TableValueType": 0,
            "BindingInfos": [
              {
                "GUID": "f855740f-30a9-4e28-bbdd-e872092f4b9e",
                "BindingInfo": {
                  "TableName": "m_environment",
                  "ColumnName": "mailsender_address",
                  "GUID": "00dbac22-9974-48b0-8fbe-a62f2706a143"
                },
                "ColumnName": "mailsender_address"
              }
            ],
            "SqlCondition": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "m_environment",
                "ColumnName": "ID",
                "GUID": "53d13404-7f89-4cd4-a192-eeaa8550f1cc"
              },
              "Value": "1"
            }
          },
          "ID": "fa6a609b6e1145c8955e2d31a8a825bc"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "グループメールアドレスリスト",
          "ID": "01b6ad4c2a9743ba8e207a52f019793e"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "宛先",
          "ID": "ecfe9749cd444a02864bdf7cc3148062"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_ユーザーグループID"
                  }
                },
                "value": "%Null%",
                "compareType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "ユーザー",
                  "TableValue": {
                    "TableName": "m_user",
                    "BindingInfos": [
                      {
                        "GUID": "714cc4f8-29e8-4469-aac2-2eae230591d2",
                        "BindingInfo": {
                          "TableName": "m_user",
                          "ColumnName": "mail_address",
                          "GUID": "fcbbd23d-a345-4dd3-b09b-78260aa03885"
                        },
                        "ColumnName": "メールアドレス"
                      }
                    ],
                    "SqlCondition": {
                      "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                      "SubConditions": [
                        {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "CompareType": 1,
                          "ColumnBindingInfo": {
                            "TableName": "m_user",
                            "ColumnName": "user_group_ids",
                            "GUID": "3fa4c617-6a12-4b8d-b5ab-f99822f25387"
                          },
                          "Value": "%Null%"
                        },
                        {
                          "$type": "ForguncyDataAccess.TextCESqlCondition, ForguncyDataAccess",
                          "CompareType": 6,
                          "ColumnBindingInfo": {
                            "TableName": "m_user",
                            "ColumnName": "user_group_ids",
                            "GUID": "973f41c7-953a-40fb-a0db-65ecab53b1b3"
                          },
                          "Value": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=P_ユーザーグループID"
                          }
                        },
                        {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "ColumnBindingInfo": {
                            "TableName": "m_user",
                            "ColumnName": "active_flg",
                            "GUID": "7deb368f-7e3d-4c44-a76f-66458c5ece81"
                          },
                          "Value": "1"
                        }
                      ]
                    }
                  },
                  "ID": "37119cefa4884195be719adec7c296fc"
                },
                {
                  "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
                  "LoopInfo": {
                    "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
                    "LoopCount": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=ユーザー"
                    },
                    "LoopItemParamName": "Item"
                  },
                  "CommandList": [
                    {
                      "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                      "ConditionAndCommandPairList": [
                        {
                          "Condition": {
                            "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                            "param": {
                              "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                              "ParamObject": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=グループメールアドレスリスト"
                              }
                            },
                            "value": "%Null%"
                          },
                          "CommandList": [
                            {
                              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                              "ParameterName": "グループメールアドレスリスト",
                              "ParameterValue": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=Item.メールアドレス"
                              },
                              "ID": "d7e3ac20018c4ea4afb7bf5abd05b2b7"
                            }
                          ],
                          "ID": "a5b59961-c0ce-460d-ae92-9c5f6886f665"
                        },
                        {
                          "CommandList": [
                            {
                              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                              "ParameterName": "グループメールアドレスリスト",
                              "ParameterValue": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=グループメールアドレスリスト&\",\"&Item.メールアドレス"
                              },
                              "ID": "be80cb865f2d4fa0ad71d6168f245480"
                            }
                          ],
                          "ID": "af0439eb-491a-4788-8a7d-23b6d5b59834"
                        }
                      ]
                    }
                  ],
                  "Comments": "ユーザーグループIDよりメールアレスリストを生成"
                }
              ],
              "ID": "4f740342-46fd-4d49-a1b4-0c5564e8311a"
            }
          ]
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_宛先TO"
                  }
                },
                "value": "%Null%"
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "宛先",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=グループメールアドレスリスト"
                  },
                  "ID": "21af6490a78043cbae94ff9b76777831"
                }
              ],
              "ID": "38a4924f-b202-4962-a13e-335febd9c53e"
            },
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=グループメールアドレスリスト"
                  }
                },
                "value": "%Null%",
                "compareType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "宛先",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_宛先TO&\",\"&グループメールアドレスリスト"
                  },
                  "ID": "fd597cc294ef46f0b2765139a5928dbd"
                }
              ],
              "ID": "1f5ca975-e1d4-4948-ac6c-f232e6b0a6f8"
            },
            {
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "宛先",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_宛先TO"
                  },
                  "ID": "b5eba0e8cadb44be9eec374c4eed3f34"
                }
              ],
              "ID": "402e709d-3b95-447d-b841-b7fb28272c15"
            }
          ],
          "Comments": "宛先設定"
        },
        {
          "$type": "Forguncy.Model.CatchExceptionCommand, ServerDesignerCommon",
          "TryCommandPart": {
            "CommandList": [
              {
                "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                "ParameterName": "添付ファイル文字列",
                "ID": "68aef9ed56e64098a498b60e218aeeca"
              },
              {
                "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                "ParameterName": "添付ファイル数",
                "ParameterValue": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=LEN(P_添付ファイル)-LEN(SUBSTITUTE(P_添付ファイル,\"|\",\"\"))"
                },
                "ID": "a7ae1aca7aae448e84ab74d54c2b5895"
              },
              {
                "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                "ParameterName": "ファイル名開始位置",
                "ParameterValue": "1",
                "ID": "0f4cbc1a25304e8b8e469f590067c88e"
              },
              {
                "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
                "LoopInfo": {
                  "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
                  "LoopCount": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=添付ファイル数"
                  },
                  "LoopIndexParamName": "カウンター",
                  "LoopItemParamName": "Item"
                },
                "CommandList": [
                  {
                    "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                    "ParameterName": "文字数",
                    "ParameterValue": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=IFERROR(FIND(\"|\",P_添付ファイル,ファイル名開始位置),1000)"
                    },
                    "ID": "fe6f04e753d7458890f1867ff9e4450a"
                  },
                  {
                    "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                    "ParameterName": "取得ファイル名",
                    "ParameterValue": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=MID(P_添付ファイル,ファイル名開始位置,文字数-ファイル名開始位置)"
                    },
                    "ID": "80ab278a6e12446e8eec55d86eb73bb3"
                  },
                  {
                    "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                    "ParameterName": "表示ファイル名",
                    "ParameterValue": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=MID(取得ファイル名,38,100)"
                    },
                    "ID": "8299877191e7477a8c4e6884de471761"
                  },
                  {
                    "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                    "ConditionAndCommandPairList": [
                      {
                        "Condition": {
                          "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                          "param": {
                            "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                            "ParamObject": {
                              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                              "SerializeProperty": "=カウンター"
                            }
                          },
                          "value": "1"
                        },
                        "CommandList": [
                          {
                            "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                            "ParameterName": "添付ファイル文字列",
                            "ParameterValue": {
                              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                              "SerializeProperty": "=\"・\"&表示ファイル名"
                            },
                            "ID": "dcd9a16a7b7c4113a45e3781182f556f"
                          }
                        ],
                        "ID": "7b6f3b58-5bd1-4b73-86d1-0ef18d4d6df0"
                      },
                      {
                        "CommandList": [
                          {
                            "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                            "ParameterName": "添付ファイル文字列",
                            "ParameterValue": {
                              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                              "SerializeProperty": "=添付ファイル文字列&CHAR(10)&\"・\"&表示ファイル名"
                            },
                            "ID": "da9166fcfc4c4931a4129a96d9bbbfb8"
                          }
                        ],
                        "ID": "e4eed3b6-d6d9-4a2f-8f75-9af44cd1209f"
                      }
                    ]
                  },
                  {
                    "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                    "ParameterName": "ファイル名開始位置",
                    "ParameterValue": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=文字数+1"
                    },
                    "ID": "d26d188cad7a4375a867ca439c802b84"
                  }
                ]
              },
              {
                "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                "TableName": "t_mail_history",
                "UpdateType": "add",
                "ShowConfirm": false,
                "UpdateBindingValues": [
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "sender_type",
                      "GUID": "e2d44c71-95e5-4dc0-805e-38168baa8d69"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_送信元区分"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "post_type",
                      "GUID": "4ed947b6-3a10-4428-b06c-e74e2017bfc0"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_宛先区分"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "sender_address",
                      "GUID": "ba65d52e-2a73-4aab-8fdf-2ee49cc7434a"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_差出人アドレス"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "to_user_ids",
                      "GUID": "cb1d3aac-e68e-4197-b467-dd88bf5cd4d4"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_TOユーザーIDs"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "to_add_address",
                      "GUID": "69082b2d-d7f5-49a4-95bc-63cb242b3f7e"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_TO追加アドレス"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "to_address",
                      "GUID": "75ef69de-bbe1-498f-937e-dc64b9134394"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=宛先"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "cc_user_ids",
                      "GUID": "9adf1aa2-0fcf-460a-8cd7-b490616feb5f"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_CCユーザーIDs"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "cc_add_address",
                      "GUID": "60ddb4b3-6e12-4ed6-ab37-425ad613f647"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_CC追加アドレス"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "cc_address",
                      "GUID": "7b7aa3b4-a916-4633-9586-f6504e1deedd"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_宛先CC"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "subject",
                      "GUID": "a2ce94b2-f2cb-450a-9f9d-8df506e13cb3"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_件名"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "body",
                      "GUID": "ab36febb-e538-4ef2-a960-3fc01decfd8f"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_本文"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "attachment_files",
                      "GUID": "edd1f894-6145-44d0-b4a5-83857d3414bd"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=添付ファイル文字列"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "billing_no",
                      "GUID": "5e460fa1-0291-4cc0-b9b8-da3df2bbb305"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_請求番号"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "object_order_id",
                      "GUID": "62f72ffe-0cab-4bc3-9595-1e5c2604f395"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_申込ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "survey_id",
                      "GUID": "586b96a1-5522-42c5-9ea8-ecb4306fe491"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_調査ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "surveying_id",
                      "GUID": "7ec71fbb-0bf9-4b26-930b-6f8116628b53"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_測量ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "analysis_id",
                      "GUID": "6db5ff25-8dd0-41a2-8aab-46de586e8786"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_解析ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "compaction_id",
                      "GUID": "93063a80-210c-4725-aca7-7df0cd93eeaa"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_転圧ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "construction_estimate_id",
                      "GUID": "8a417594-7561-49ce-b00f-a87b5659be35"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_工事見積ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "construction_id",
                      "GUID": "84738da1-fae7-4ea9-8df4-8ac150677b31"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_工事ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "warranty_id",
                      "GUID": "e13b687c-1fed-4885-ab1d-c50a27b0c6f6"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_保証ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "external_id",
                      "GUID": "aa25a4f3-870f-4fb9-b61e-d650d0b78d66"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_外販ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "send_user_id",
                      "GUID": "35d85fb1-1bdc-46f3-aabb-9c535b6a15ec"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_送信ユーザーID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "send_date",
                      "GUID": "344da31e-c43b-41a4-85c2-0845006be123"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=NOW()"
                    }
                  }
                ]
              },
              {
                "$type": "Forguncy.Model.SendMailCommand, ServerDesignerCommon",
                "From": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=差出人メールアドレス"
                },
                "EnhancedRecipient": {
                  "CommonValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=宛先"
                  }
                },
                "Subject": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=P_件名"
                },
                "Content": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=P_本文"
                },
                "EnhancedCC": {
                  "CommonValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_宛先CC"
                  }
                },
                "Attachments": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=P_添付ファイル"
                },
                "ID": "19839b754c1e42c89b15647bfc6f99cb"
              }
            ]
          },
          "CatchCommandPart": {
            "CommandList": [
              {
                "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                "ParameterName": "送信者メールドレス",
                "TableValue": {
                  "TableName": "m_user",
                  "OnlyGetValue": true,
                  "TableValueType": 0,
                  "BindingInfos": [
                    {
                      "GUID": "841e6e7a-23fc-4a40-b6d2-d51a9ba2e8fb",
                      "BindingInfo": {
                        "TableName": "m_user",
                        "ColumnName": "mail_address",
                        "GUID": "417a6205-6e99-42ba-9d79-67fd802e9c26"
                      },
                      "ColumnName": "mail_address"
                    }
                  ],
                  "SqlCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "m_user",
                      "ColumnName": "user_id",
                      "GUID": "d1191891-8189-4ee4-af74-2fcb140a452e"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_送信ユーザーID"
                    }
                  }
                },
                "ID": "04bfc2fbc0e34446a870acf8d025ebeb"
              },
              {
                "$type": "Forguncy.Model.SendMailCommand, ServerDesignerCommon",
                "From": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=差出人メールアドレス"
                },
                "EnhancedRecipient": {
                  "CommonValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=送信者メールドレス"
                  }
                },
                "Subject": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=\"【送信エラー】\"&P_件名"
                },
                "Content": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=\"以下の内容はエラーのため送信できませんでした\"&CHAR(10)&\"メールアドレスに間違いないか、またメールサイズに問題無いかご確認ください\"&CHAR(10)&CHAR(10)&P_本文"
                },
                "Attachments": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=P_添付ファイル"
                },
                "ID": "662bbce7216249e8b64cb1666f0e96d0"
              },
              {
                "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                "TableName": "t_mail_history",
                "UpdateType": "add",
                "ShowConfirm": false,
                "UpdateBindingValues": [
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "sender_type",
                      "GUID": "dc8b90cb-c177-476f-b9b8-04a2943825c1"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_送信元区分"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "post_type",
                      "GUID": "627017d4-2809-4138-a448-a39cfca9347d"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_宛先区分"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "sender_address",
                      "GUID": "ca37a11d-1928-4db4-85d0-b2ff3b43b83e"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_差出人アドレス"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "to_user_ids",
                      "GUID": "fc6c0634-d593-4f10-8a53-4303f71fbc3b"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_TOユーザーIDs"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "to_add_address",
                      "GUID": "57ba7534-b69a-48cf-b704-390083080e44"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_TO追加アドレス"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "to_address",
                      "GUID": "15361bed-fb57-44ab-b2a2-d65ccfe2bf80"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_宛先TO"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "cc_user_ids",
                      "GUID": "53894ca9-8ed7-4141-a47e-f5dadb76c514"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_CCユーザーIDs"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "cc_add_address",
                      "GUID": "1da158c0-e62d-40ba-b7f6-1de6ae616eb7"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_CC追加アドレス"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "cc_address",
                      "GUID": "538bcb4d-bbd5-4cfe-ab57-d15c6a23d8a1"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_宛先CC"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "subject",
                      "GUID": "16e32ee0-447b-45c7-a36c-409aadb17aee"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_件名"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "body",
                      "GUID": "aea00409-848b-4cd4-acb5-d2517ef57c8e"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_本文"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "attachment_files",
                      "GUID": "fc909ece-ddac-4b10-9a82-40e865c2c4a5"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=添付ファイル文字列"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "billing_no",
                      "GUID": "71eb81b1-48d1-4023-977e-d5f352a19114"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_請求番号"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "object_order_id",
                      "GUID": "3ec44171-801f-4f03-8da9-a85cdab2b94a"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_申込ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "survey_id",
                      "GUID": "a6bf94fe-955a-4376-b1b9-3b900d422588"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_調査ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "surveying_id",
                      "GUID": "a893aa54-2d50-4aa2-93db-e38509e60e9f"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_測量ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "analysis_id",
                      "GUID": "55a626b6-09b7-4227-8cda-376eafb111b3"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_解析ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "compaction_id",
                      "GUID": "aa8d21de-6957-4c3f-8602-0de9cc4d26f1"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_転圧ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "construction_estimate_id",
                      "GUID": "3c3dfd4a-74c5-4c0e-aff1-683d7f04116b"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_工事見積ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "construction_id",
                      "GUID": "3ed03c1a-54d0-47a1-bc43-943e04256df8"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_工事ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "warranty_id",
                      "GUID": "86fab745-cfd3-460c-ac9b-0928e4bc3873"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_保証ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "external_id",
                      "GUID": "fc8d428c-d9a8-4a2b-beb9-6e03853dfd34"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_外販ID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "send_user_id",
                      "GUID": "f9cae3b4-ef58-42fd-ae9f-a90c4b839a62"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_送信ユーザーID"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "send_date",
                      "GUID": "c2581eb3-4f62-4571-bef0-fa02bd469651"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=NOW()"
                    }
                  },
                  {
                    "BindingInfo": {
                      "TableName": "t_mail_history",
                      "ColumnName": "send_error_flg",
                      "GUID": "ef0b3b99-e03b-4184-818e-03cc92c902df"
                    },
                    "Value": "1"
                  }
                ]
              },
              {
                "$type": "Forguncy.Model.ReturnCommand, ServerDesignerCommon",
                "ErrorCode": "100",
                "Message": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=\"メール送信に失敗しました\"&CHAR(10)&ExceptionMessage"
                }
              }
            ]
          }
        }
      ]
    }
  ]
}