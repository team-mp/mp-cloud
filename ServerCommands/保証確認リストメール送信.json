{
  "Name": "保証確認リストメール送信",
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.SaveLoad.InvokeTriggerSaveData, ServerDesignerCommon",
      "Parameters": [
        {
          "Name": "P_対象事業者ID",
          "DataValidationInfo": {},
          "TestData": "8455"
        }
      ],
      "InvokeTriggerTestData": {
        "UserName": "Administrator"
      }
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "顧客情報",
      "TableValue": {
        "TableName": "m_customer",
        "TableValueType": 1,
        "BindingInfos": [
          {
            "GUID": "428e3d70-08d5-42bd-a1d3-51d4301ffa34",
            "BindingInfo": {
              "TableName": "m_customer",
              "ColumnName": "customer_name",
              "GUID": "ed6b2376-3537-4de2-b162-c4fea6817096"
            },
            "ColumnName": "顧客名"
          },
          {
            "GUID": "5d537756-3f2b-4e30-a8b7-909b9d1eca25",
            "BindingInfo": {
              "TableName": "m_customer",
              "ColumnName": "customer_id",
              "GUID": "8bce4281-3f6d-44d2-8427-9e815a60ee63",
              "RelationBinding": {
                "RelatedTable": "m_customer_default",
                "RelatedColumn": "customer_id",
                "DisplayColumn": "sender_defalut_flg"
              }
            },
            "ColumnName": "差出人既定値フラグ"
          },
          {
            "GUID": "7461697d-9bdf-4a31-b0b1-faa85585639a",
            "BindingInfo": {
              "TableName": "m_customer",
              "ColumnName": "sales_staff_id",
              "GUID": "e0f1a44e-9727-4e22-a709-b50ddd4072e3",
              "RelationBinding": {
                "RelatedTable": "m_user",
                "RelatedColumn": "user_id",
                "DisplayColumn": "mail_address"
              }
            },
            "ColumnName": "営業担当者メールアドレス"
          },
          {
            "GUID": "5d047ac7-a0e6-4c4d-aef8-b5b38f719d0f",
            "BindingInfo": {
              "TableName": "m_customer",
              "ColumnName": "sales_staff_id",
              "GUID": "49fb61c2-8305-4f53-8f79-e8a6c2583442"
            },
            "ColumnName": "営業担当ID"
          },
          {
            "GUID": "02a1fd08-0fd7-440d-a259-02ebbfbb3fa1",
            "BindingInfo": {
              "TableName": "m_customer",
              "ColumnName": "customer_id",
              "GUID": "a12e57a1-fbb9-4765-8b57-4b6bb89247aa",
              "RelationBinding": {
                "RelatedTable": "m_customer_default",
                "RelatedColumn": "customer_id",
                "DisplayColumn": "download_link_apply_flg"
              }
            },
            "ColumnName": "ダウンロードリンク適用フラグ"
          },
          {
            "GUID": "fca96ccb-ede7-4434-8a6c-2a252990b1df",
            "BindingInfo": {
              "TableName": "m_customer",
              "ColumnName": "customer_id",
              "GUID": "6ec6876b-6f54-4493-a981-631b81800b3b",
              "RelationBinding": {
                "RelatedTable": "m_customer_default",
                "RelatedColumn": "customer_id",
                "DisplayColumn": "download_link_type"
              }
            },
            "ColumnName": "ダウンロードリンク区分"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
          "ColumnBindingInfo": {
            "TableName": "m_customer",
            "ColumnName": "customer_id",
            "GUID": "78159949-2015-4771-8790-4fa7ca156a05"
          },
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=P_対象事業者ID"
          }
        }
      },
      "ID": "0f06bffc4d894f8589c130e286b380ae"
    },
    {
      "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
      "ConditionAndCommandPairList": [
        {
          "Condition": {
            "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
            "param": {
              "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
              "ParamObject": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=顧客情報.差出人既定値フラグ"
              }
            },
            "value": "1"
          },
          "CommandList": [
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "V_差出人メールアドレス",
              "TableValue": {
                "TableName": "m_sender_mail_address",
                "OnlyGetValue": true,
                "TableValueType": 0,
                "BindingInfos": [
                  {
                    "GUID": "d6f67219-c02f-4fc5-9810-57b668c830a7",
                    "BindingInfo": {
                      "TableName": "m_sender_mail_address",
                      "ColumnName": "mail_address",
                      "GUID": "424254b7-b895-42b2-a9dc-aa5ed4d10448"
                    },
                    "ColumnName": "mail_address"
                  }
                ],
                "SqlCondition": {
                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                  "ColumnBindingInfo": {
                    "TableName": "m_sender_mail_address",
                    "ColumnName": "sender_id",
                    "GUID": "d5f2756e-d7cd-44ac-aa3a-da30aa02d724"
                  },
                  "Value": "1"
                }
              },
              "ID": "ca1353b07ad04014b337eadded22f19a"
            }
          ],
          "ID": "bb67cd67-36e8-4f7b-980f-132093c0d68c"
        },
        {
          "CommandList": [
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "V_差出人メールアドレス",
              "TableValue": {
                "TableName": "m_environment",
                "OnlyGetValue": true,
                "TableValueType": 0,
                "BindingInfos": [
                  {
                    "GUID": "847409e9-f7ac-40be-838d-5eb037b217ed",
                    "BindingInfo": {
                      "TableName": "m_environment",
                      "ColumnName": "mailsender_address",
                      "GUID": "d7084f0a-1b6c-4241-b9ff-1de4f12c39fa"
                    },
                    "ColumnName": "mailsender_address"
                  }
                ],
                "SqlCondition": {
                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                  "ColumnBindingInfo": {
                    "TableName": "m_environment",
                    "ColumnName": "ID",
                    "GUID": "87def42c-3dd5-4c12-a615-4d89c06ddce7"
                  },
                  "Value": "1"
                }
              },
              "ID": "bb3722adc5f5406388f7ad922d34e0e8"
            }
          ],
          "ID": "3aa4e4cd-9b67-423e-8219-01e49392c820"
        }
      ]
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "メールテンプレート",
      "TableValue": {
        "TableName": "m_mail_template",
        "TableValueType": 1,
        "BindingInfos": [
          {
            "GUID": "23caac23-0513-4bcb-a46b-f9570acfbbd0",
            "BindingInfo": {
              "TableName": "m_mail_template",
              "ColumnName": "template_id",
              "GUID": "7ba7f531-e4bc-4011-9ff1-44a7fd4b29a6"
            },
            "ColumnName": "テンプレートID"
          },
          {
            "GUID": "3566b41a-9631-4bcb-bf9c-2ed7572f572d",
            "BindingInfo": {
              "TableName": "m_mail_template",
              "ColumnName": "post_type",
              "GUID": "d911d290-f311-48f8-ae42-b84a5bcc39b5"
            },
            "ColumnName": "宛先区分"
          },
          {
            "GUID": "bb004894-3e68-4f8f-9db8-8e8b7b801f63",
            "BindingInfo": {
              "TableName": "m_mail_template",
              "ColumnName": "subject",
              "GUID": "61231674-daf0-41c8-9b5e-1cd2d619178c"
            },
            "ColumnName": "件名"
          },
          {
            "GUID": "d92b21f5-4074-4171-9a70-e6b92a599e49",
            "BindingInfo": {
              "TableName": "m_mail_template",
              "ColumnName": "body",
              "GUID": "543196ba-7f55-4903-b8b0-ebf852c71131"
            },
            "ColumnName": "本文"
          },
          {
            "GUID": "2d94ade2-7162-4252-8b55-305d32aaff8f",
            "BindingInfo": {
              "TableName": "m_mail_template",
              "ColumnName": "signature_id",
              "GUID": "6046ad36-b3f2-41be-8bb8-cc512188e417",
              "RelationBinding": {
                "RelatedTable": "m_mail_signature",
                "RelatedColumn": "signature_id",
                "DisplayColumn": "signature"
              }
            },
            "ColumnName": "署名"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
          "ColumnBindingInfo": {
            "TableName": "m_mail_template",
            "ColumnName": "system_button_name",
            "GUID": "be924e55-4589-4924-abb4-353003d9655c"
          },
          "Value": "保証確認リスト通知ボタン"
        }
      },
      "ID": "e356ffa57f434ea183d7204ef03228e7"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "V_確認期限日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(TODAY()+14,\"yyyy/mm/dd\")"
      },
      "ID": "37c6e41233b341dc9261cb0a74961434"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "V_宛先TO",
      "ID": "9c3add59a9434716944ff609437573df"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "V_TOユーザーIDs",
      "ID": "d13c87c31c6e47f7bf48cc77f23d8464"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "V_宛先CC",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=顧客情報.営業担当者メールアドレス"
      },
      "ID": "abc09455d7384319ad5d58fa755352ef"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "V_CCユーザーIDs",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=顧客情報.営業担当ID"
      },
      "ID": "98d45cf11b144bc59e5e933dffaa8421"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "V_本文",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=SUBSTITUTE(SUBSTITUTE(メールテンプレート.本文,\"%order_customer_name%\",顧客情報.顧客名),\"%confirmation_deadline_date%\",V_確認期限日)"
      },
      "ID": "903be92265d948f583067fead779251a"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "申込情報",
      "TableValue": {
        "TableName": "t_object_order",
        "BindingInfos": [
          {
            "GUID": "85085e9c-a219-439b-bc7c-966dba01a066",
            "BindingInfo": {
              "TableName": "t_object_order",
              "ColumnName": "group_type_id",
              "GUID": "dde1f0d1-67ca-4749-b767-973017e50088"
            },
            "ColumnName": "グループ区分"
          },
          {
            "GUID": "e699f086-349d-45a3-a329-a40d6daee399",
            "BindingInfo": {
              "TableName": "t_object_order",
              "ColumnName": "order_user_id",
              "GUID": "5af72207-785b-4af6-bc03-515246b47608",
              "RelationBinding": {
                "RelatedTable": "m_user",
                "RelatedColumn": "user_id",
                "DisplayColumn": "mail_address"
              }
            },
            "ColumnName": "申込担当者メールアドレス"
          },
          {
            "GUID": "13837829-0d09-419c-850e-a508282ee7ae",
            "BindingInfo": {
              "TableName": "t_object_order",
              "ColumnName": "order_user_id",
              "GUID": "87fb577e-3a67-4de6-ad85-4297088d23fb"
            },
            "ColumnName": "申込担当者ID"
          },
          {
            "GUID": "3170b242-14bf-4ab9-a47b-c68e243b1ce8",
            "BindingInfo": {
              "TableName": "t_object_order",
              "ColumnName": "object_user_id",
              "GUID": "90c91f52-28f1-42f5-b66e-3be05f00f310",
              "RelationBinding": {
                "RelatedTable": "m_user",
                "RelatedColumn": "user_id",
                "DisplayColumn": "mail_address"
              }
            },
            "ColumnName": "物件担当者メールアドレス"
          },
          {
            "GUID": "ead354bd-05a9-46f7-a505-8a5056dbc690",
            "BindingInfo": {
              "TableName": "t_object_order",
              "ColumnName": "object_user_id",
              "GUID": "43f1e617-5147-49bc-9142-012028e5e4a4"
            },
            "ColumnName": "物件担当者ID"
          },
          {
            "GUID": "5d0b65fc-9167-4bf1-bc1f-bddad8ea0f2d",
            "BindingInfo": {
              "TableName": "t_object_order",
              "ColumnName": "レコード件数",
              "GUID": "8bfb27d3-4c85-4c9f-a801-03d9ee23a703"
            },
            "ColumnName": "レコード件数"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "SubConditions": [
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_order",
                "ColumnName": "active_flg",
                "GUID": "e24c99f0-2497-4685-912f-64ee0a7502a6"
              },
              "Value": "1"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_order",
                "ColumnName": "order_status_id",
                "GUID": "a7ea5b6d-97d4-4b6d-ab98-0fda2221bc6d",
                "RelationBinding": {
                  "RelatedTable": "m_order_status",
                  "RelatedColumn": "order_status_id",
                  "DisplayColumn": "warranty_confirm_flg"
                }
              },
              "Value": "1"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_order",
                "ColumnName": "対象事業者ID",
                "GUID": "f2e49f1a-311a-4e4d-b499-1c4c1f0407b9"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_対象事業者ID"
              }
            }
          ]
        }
      },
      "ID": "e6e692d221a444bfa69b17b4680850d6"
    },
    {
      "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
      "LoopInfo": {
        "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
        "LoopCount": {
          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
          "SerializeProperty": "=申込情報"
        },
        "LoopItemParamName": "Item"
      },
      "CommandList": [
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=V_宛先TO"
                  }
                },
                "value": "%Null%"
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=Item.グループ区分"
                          }
                        },
                        "value": "2"
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_宛先TO",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=Item.申込担当者メールアドレス"
                          },
                          "ID": "f95aa47d00c848b38c3bc5a1875c538f"
                        },
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_TOユーザーIDs",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=Item.申込担当者ID"
                          },
                          "ID": "37be1fbd5def47ada71de30f0963299a"
                        }
                      ],
                      "ID": "a1281a95-4675-402b-b7b5-a711cfcfe9ef"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_宛先TO",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=Item.物件担当者メールアドレス"
                          },
                          "ID": "5099d426c65a4a11b22e700bdba2c871"
                        },
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_TOユーザーIDs",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=Item.物件担当者ID"
                          },
                          "ID": "b9629e8b4add4dfe89dbc1677b54492c"
                        }
                      ],
                      "ID": "d4663939-a3e2-499b-aba0-979e5912f965"
                    }
                  ]
                }
              ],
              "ID": "f55ae832-85b7-4209-80f6-92597b05d51b"
            },
            {
              "CommandList": [
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=Item.グループ区分"
                          }
                        },
                        "value": "2"
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_宛先TO",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=V_宛先TO&\",\"&Item.申込担当者メールアドレス"
                          },
                          "ID": "723cc375c7504727a1461d8686a8e6da"
                        },
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_TOユーザーIDs",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=V_TOユーザーIDs&\",\"&Item.申込担当者ID"
                          },
                          "ID": "eeb15f687a124179bd2cca49d543e935"
                        }
                      ],
                      "ID": "2dac15f5-8e90-4db1-a4ef-09fa7fe36735"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_宛先TO",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=V_宛先TO&\",\"&Item.物件担当者メールアドレス"
                          },
                          "ID": "fcd61d5937774c4d9803724182364bfb"
                        },
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_TOユーザーIDs",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=V_TOユーザーIDs&\",\"&Item.物件担当者ID"
                          },
                          "ID": "76dabd9f35cf4f53bbb182cb64762a63"
                        }
                      ],
                      "ID": "340aa41b-7d59-4310-91b9-23ca2d9a805d"
                    }
                  ]
                }
              ],
              "ID": "0d43d25c-991b-4ba9-b44a-b9b17ed05bd9"
            }
          ]
        }
      ]
    },
    {
      "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
      "ServerCommandName": "保証確認リスト生成処理",
      "Parameters": [
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_対象事業者ID",
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=P_対象事業者ID"
          }
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_対象事業者名",
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=顧客情報.顧客名"
          }
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_ダウンロードフラグ"
        }
      ],
      "ReturnPropertiesTo": [
        {
          "ResultPropertyName": "R_Tempファイルパス名",
          "ResultTo": {
            "SerializeProperty": "Tempファイルパス名"
          },
          "Remark": "ForguncyのTempフォルダに出力されたファイルパス名"
        }
      ],
      "RefreshAfterFinish": true,
      "CheckDataValidation": true
    },
    {
      "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
      "ConditionAndCommandPairList": [
        {
          "Condition": {
            "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
            "param": {
              "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
              "ParamObject": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=顧客情報.ダウンロードリンク適用フラグ"
              }
            },
            "value": "1"
          },
          "CommandList": [
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "環境設定",
              "TableValue": {
                "TableName": "m_environment",
                "TableValueType": 1,
                "BindingInfos": [
                  {
                    "GUID": "c3427863-1702-4a8e-8c7b-471f5e6a0434",
                    "BindingInfo": {
                      "TableName": "m_environment",
                      "ColumnName": "app_name",
                      "GUID": "42311ebd-e8ba-4f25-8e7c-cc2e64158c91"
                    },
                    "ColumnName": "アプリ名"
                  },
                  {
                    "GUID": "ae51a69e-3f53-4504-860b-149f6c78b2c3",
                    "BindingInfo": {
                      "TableName": "m_environment",
                      "ColumnName": "file_temp_path",
                      "GUID": "d6b23f4f-6746-4fd7-8d31-0f6ad340871f"
                    },
                    "ColumnName": "ファイルTempパス"
                  },
                  {
                    "GUID": "7b5c8d38-c7fa-4b8a-ab50-dc3840c67ab1",
                    "BindingInfo": {
                      "TableName": "m_environment",
                      "ColumnName": "application_url",
                      "GUID": "6bfdfc81-ff27-4be9-9680-799319bedf6c"
                    },
                    "ColumnName": "アプリケーションURL"
                  }
                ],
                "SqlCondition": {
                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                  "ColumnBindingInfo": {
                    "TableName": "m_environment",
                    "ColumnName": "ID",
                    "GUID": "eef23841-3194-41b8-826e-278a06187f27"
                  },
                  "Value": "1"
                }
              },
              "ID": "6ad99f1c9c0748789acb8d7860f187f9"
            },
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "ダウンロードリンクURL",
              "ParameterValue": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=環境設定.アプリケーションURL&\"/ServerCommand/FileDownload\""
              },
              "ID": "723e4d5f9f314d22a8000895a4f791a2"
            },
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "ファイルキー",
              "ParameterValue": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=LOWER(BASE(RANDBETWEEN(0,36^10-1),36,10))"
              },
              "ID": "d5390137581447e1a412e430b7ca495f"
            },
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "リンク用タグ",
              "ParameterValue": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=\"<a href=\"&ダウンロードリンクURL&\"?type=2&filekey=\"&ファイルキー&\">\"&ダウンロードリンクURL&\"?type=2&filekey=\"&ファイルキー&\"</a>\""
              },
              "ID": "9efe91ff017f4849a8ac08234f6a3e17"
            },
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "原型ファイル名",
              "ParameterValue": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=MID(Tempファイルパス名,38,1000)"
              },
              "ID": "dfa6a34e59e9432ab39c5b216c4c6638"
            },
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "ファイルリンク文字列",
              "ParameterValue": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=\"・\"&原型ファイル名&CHAR(10)&リンク用タグ"
              },
              "ID": "a4fd7458b9844867bb96881c6c4b72ff"
            },
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "区切り文字位置",
              "ParameterValue": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=IFERROR(FIND(\"|\",Tempファイルパス名),0)"
              },
              "ID": "d09512a74c52465bbaa017a9ff2db377"
            },
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "ファイル名",
              "ParameterValue": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=LEFT(Tempファイルパス名,区切り文字位置-1)"
              },
              "ID": "44b5bc81af164ac8a05a8e4ac268c3bf"
            },
            {
              "$type": "OperateFilesCommand.CreateFolderCommand, OperateFilesCommand",
              "FolderPath": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=Download_Server_Path&ファイルキー"
              }
            },
            {
              "$type": "Forguncy.Model.Commands.ServerImportExportCSVCommand, ServerDesignerCommon",
              "CSVOperation": 1,
              "FilePath": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=Download_Server_Path&ファイルキー"
              },
              "TableName": "m_environment",
              "Columns": [
                {
                  "BindingColumn": {
                    "TableName": "m_environment",
                    "ColumnName": "ID",
                    "GUID": "cc268fce-03c4-4155-8a2a-621fce7b1134"
                  },
                  "CSVColumnNameOrIndex": "ID",
                  "IsPrimaryKey": true
                }
              ],
              "ImportCSVEncoding": "UTF-8",
              "RowDelimiter": "\\r\\n",
              "ColumnDelimiter": ",",
              "TextQualifier": "\"",
              "Comments": "このファイルはfilekeyの作成日時を識別するために一次的に作成します"
            },
            {
              "$type": "OperateFilesCommand.CopyFileCommand, OperateFilesCommand",
              "FilePath": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=環境設定.ファイルTempパス&環境設定.アプリ名&\"\\Temp\\\"&ファイル名"
              },
              "TargetFolderPath": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=Download_Server_Path&ファイルキー"
              }
            },
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "リンクメッセージ",
              "ParameterValue": "以下のURLより、ファイルのダウンロードが可能です。",
              "ID": "f9c3cc7e533245bfbe361eb2ad6ea92f"
            },
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "リンクメッセージ",
              "ParameterValue": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=リンクメッセージ&CHAR(10)&リンク用タグ"
              },
              "ID": "73675a7e01c14884ac09bb3bfd0f389a"
            },
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "リンクメッセージ",
              "ParameterValue": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=リンクメッセージ&CHAR(10)&\"※有効期限は、\"&TEXT(TODAY()+14,\"yyyy/mm/dd\")&\"までとなります。\""
              },
              "ID": "d7a7cff52e9b414b8397686305660e41"
            },
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "リンクメッセージ",
              "ParameterValue": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=リンクメッセージ&CHAR(10)&\"期限日を超えた場合は、ダウンロード不能となりますので、期限内でのダウンロードをお願いします。\""
              },
              "ID": "560df60f86a54456930404e619ee69bd"
            },
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "V_本文",
              "ParameterValue": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=V_本文&CHAR(10)&CHAR(10)&リンクメッセージ&CHAR(10)&CHAR(10)&メールテンプレート.署名"
              },
              "ID": "bdb18f48ebb34aa085e8bb40d1a31388"
            }
          ],
          "ID": "599fdc13-8c55-4736-9189-a96376728eed"
        },
        {
          "CommandList": [
            {
              "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
              "ParameterName": "V_本文",
              "ParameterValue": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=V_本文&CHAR(10)&CHAR(10)&メールテンプレート.署名"
              },
              "ID": "c5e7b225b73145ff9a3e01a9bfdd9701"
            }
          ],
          "ID": "bf0d6393-f3cd-45d0-a8fa-b5047dfe3781"
        }
      ]
    },
    {
      "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
      "ServerCommandName": "メール送信処理",
      "Parameters": [
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_差出人アドレス",
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=V_差出人メールアドレス"
          }
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_送信元区分",
          "Value": "1"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_宛先区分",
          "Value": "2"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_ユーザーグループKEYs"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_TOユーザーIDs",
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=V_TOユーザーIDs"
          }
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_TO追加アドレス"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_宛先TO",
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=V_宛先TO"
          }
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_CCユーザーIDs",
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=V_CCユーザーIDs"
          }
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_CC追加アドレス"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_宛先CC",
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=V_宛先CC"
          }
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_件名",
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=メールテンプレート.件名"
          }
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_本文",
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=V_本文"
          }
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_添付ファイル",
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=IF(顧客情報.ダウンロードリンク適用フラグ=1,\"\",Tempファイルパス名)"
          }
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_テンプレートID",
          "Value": {
            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
            "SerializeProperty": "=メールテンプレート.テンプレートID"
          }
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_請求番号"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_申込ID"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_調査ID"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_測量ID"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_解析ID"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_転圧ID"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_工事見積ID"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_工事ID"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_保証ID"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_外販ID"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_送信ユーザーID"
        },
        {
          "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
          "ParamName": "P_ダウンロードリンクリスト"
        }
      ],
      "RefreshAfterFinish": true,
      "CheckDataValidation": true
    }
  ]
}