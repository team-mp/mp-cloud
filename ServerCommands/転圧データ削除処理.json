{
  "Name": "転圧データ削除処理",
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.SaveLoad.PostRequestTriggerSaveData, ServerDesignerCommon",
      "Permission": {
        "PermissionData": {
          "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionData, Forguncy.RbacPermission.Core",
          "permissionResource": {
            "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionResource, Forguncy.RbacPermission.Core"
          },
          "permissionBindings": [
            {
              "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionBinding, Forguncy.RbacPermission.Core",
              "roleNames": [
                "FGC_LoginUser"
              ]
            }
          ]
        }
      },
      "Parameters": [
        {
          "Name": "P_申込ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_転圧ID",
          "DataValidationInfo": {}
        }
      ]
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon",
      "CommandList": [
        {
          "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
          "TableName": "t_object_compaction",
          "UpdateType": "delete",
          "ShowConfirm": true,
          "ConfirmText": "本当に削除してもよろしいですか？",
          "RowsToUpdate": 1,
          "RowsToUpdateCondition": {
            "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
            "ColumnBindingInfo": {
              "TableName": "t_object_compaction",
              "ColumnName": "compaction_id",
              "GUID": "491397a0-b317-4ff2-b3b9-8448a7946c73"
            },
            "Value": {
              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
              "SerializeProperty": "=P_転圧ID"
            }
          }
        },
        {
          "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
          "TableName": "t_object_product",
          "UpdateType": "delete",
          "ShowConfirm": true,
          "ConfirmText": "本当に削除してもよろしいですか？",
          "RowsToUpdate": 1,
          "RowsToUpdateCondition": {
            "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
            "ColumnBindingInfo": {
              "TableName": "t_object_product",
              "ColumnName": "compaction_id",
              "GUID": "0236830a-7d8a-44a8-b10b-a33d376057e5"
            },
            "Value": {
              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
              "SerializeProperty": "=P_転圧ID"
            }
          }
        },
        {
          "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
          "ServerCommandName": "転圧後発履歴更新処理",
          "Parameters": [
            {
              "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
              "ParamName": "P_申込ID",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_申込ID"
              }
            },
            {
              "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
              "ParamName": "P_転圧ID",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_転圧ID"
              }
            }
          ],
          "RefreshAfterFinish": true,
          "CheckDataValidation": true
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "最新転圧情報",
          "TableValue": {
            "TableName": "t_object_compaction",
            "TableValueType": 1,
            "BindingInfos": [
              {
                "GUID": "0fc744ef-6b99-4666-92a6-89cf661152db",
                "BindingInfo": {
                  "TableName": "t_object_compaction",
                  "ColumnName": "compaction_id",
                  "GUID": "b4c2bb89-c814-4d92-9b9b-7463f3e26536"
                },
                "ColumnName": "転圧ID"
              }
            ],
            "SqlCondition": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_compaction",
                "ColumnName": "object_order_id",
                "GUID": "13864865-875e-4217-81a9-7b04d9d2a5f3"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_申込ID"
              }
            },
            "TopCount": "1",
            "OrderBySqlCondition": {
              "OrderByColumns": [
                {
                  "ColumnBindingInfo": {
                    "TableName": "t_object_compaction",
                    "ColumnName": "compaction_id",
                    "GUID": "b960ae68-870b-4e2c-9334-4faeef81d71b"
                  },
                  "Order": 1
                }
              ]
            }
          },
          "ID": "ac0b232cde024939b0d745e1165a8c72"
        },
        {
          "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
          "TableName": "t_object_order",
          "ShowConfirm": false,
          "RowsToUpdate": 1,
          "RowsToUpdateCondition": {
            "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
            "ColumnBindingInfo": {
              "TableName": "t_object_order",
              "ColumnName": "object_order_id",
              "GUID": "65634461-b382-4944-a472-7ae8f852046e"
            },
            "Value": {
              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
              "SerializeProperty": "=P_申込ID"
            }
          },
          "UpdateBindingValues": [
            {
              "BindingInfo": {
                "TableName": "t_object_order",
                "ColumnName": "latest_compaction_id",
                "GUID": "3e613f11-630e-4443-be5e-e78c3ba6e716"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=最新転圧情報.転圧ID"
              }
            }
          ]
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=最新転圧情報.転圧ID"
                  }
                },
                "value": "%Null%"
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "申込情報",
                  "TableValue": {
                    "TableName": "t_object_order",
                    "TableValueType": 1,
                    "BindingInfos": [
                      {
                        "GUID": "2f2661dc-bfaa-49af-8774-3a10273bcc2d",
                        "BindingInfo": {
                          "TableName": "t_object_order",
                          "ColumnName": "latest_warranty_id",
                          "GUID": "e340b99a-7ed8-4ad1-b780-d4257e639973"
                        },
                        "ColumnName": "最新保証ID"
                      },
                      {
                        "GUID": "b7e5116c-3681-489a-bf8c-b8764bd91334",
                        "BindingInfo": {
                          "TableName": "t_object_order",
                          "ColumnName": "latest_warranty_id",
                          "GUID": "9cd6017c-896b-41c4-bc0c-21b9a5bf6e52",
                          "RelationBinding": {
                            "RelatedTable": "t_object_warranty",
                            "RelatedColumn": "warranty_id",
                            "DisplayColumn": "warranty_status_id",
                            "NextRelationBinding": {
                              "RelatedTable": "m_warranty_status",
                              "RelatedColumn": "warranty_status_id",
                              "DisplayColumn": "compaction_result_waite_flg"
                            }
                          }
                        },
                        "ColumnName": "転圧結果待ちフラグ"
                      }
                    ],
                    "SqlCondition": {
                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                      "ColumnBindingInfo": {
                        "TableName": "t_object_order",
                        "ColumnName": "object_order_id",
                        "GUID": "5a99dfbd-b388-41bb-a35e-83da4e6544d5"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_申込ID"
                      }
                    },
                    "NullFormulaValueQueryPolicy": 0
                  },
                  "ID": "6d4d6d95f54c40bb848684bf3e580392"
                },
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=申込情報.転圧結果待ちフラグ"
                          }
                        },
                        "value": "1"
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "保証ST",
                          "TableValue": {
                            "TableName": "m_warranty_status",
                            "OnlyGetValue": true,
                            "TableValueType": 0,
                            "BindingInfos": [
                              {
                                "GUID": "0124729d-78dc-430e-920d-85e7b9eb3f08",
                                "BindingInfo": {
                                  "TableName": "m_warranty_status",
                                  "ColumnName": "warranty_status_id",
                                  "GUID": "af7771ac-f7c3-46ec-b9dc-7c692d572a3c"
                                },
                                "ColumnName": "warranty_status_id"
                              }
                            ],
                            "SqlCondition": {
                              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                              "ColumnBindingInfo": {
                                "TableName": "m_warranty_status",
                                "ColumnName": "warranty_check_flg",
                                "GUID": "091ed8e9-2f3f-4e65-9fa7-228f3e4eb108"
                              },
                              "Value": "1"
                            }
                          },
                          "ID": "eaae1fe2b32049aaaeece524be9e75ee",
                          "Comments": "保証確認中"
                        },
                        {
                          "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                          "TableName": "t_object_warranty",
                          "ShowConfirm": false,
                          "RowsToUpdate": 1,
                          "RowsToUpdateCondition": {
                            "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                            "ColumnBindingInfo": {
                              "TableName": "t_object_warranty",
                              "ColumnName": "warranty_id",
                              "GUID": "b6eaa6f3-5468-461c-a7f5-cd0f6eca7b51"
                            },
                            "Value": {
                              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                              "SerializeProperty": "=申込情報.最新保証ID"
                            }
                          },
                          "UpdateBindingValues": [
                            {
                              "BindingInfo": {
                                "TableName": "t_object_warranty",
                                "ColumnName": "warranty_status_id",
                                "GUID": "8eb8eb10-dddb-4198-87e0-dbae05882511"
                              },
                              "Value": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=保証ST"
                              }
                            }
                          ]
                        }
                      ],
                      "ID": "21e50b3d-7447-438e-8d07-00a9fc2c0463"
                    }
                  ]
                }
              ],
              "ID": "dbb34d20-4c68-431a-bfa8-18c1e93e9661"
            }
          ]
        },
        {
          "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
          "ServerCommandName": "最新申込ステータス更新処理",
          "Parameters": [
            {
              "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
              "ParamName": "P_申込ID",
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_申込ID"
              }
            }
          ],
          "ResultErrorCodeTo": {
            "SerializeProperty": "リターンコード"
          },
          "ResultMessageTo": {
            "SerializeProperty": "リターンメッセージ"
          },
          "ReturnPropertiesTo": [
            {
              "ResultPropertyName": "R_申込ステータス更新フラグ"
            },
            {
              "ResultPropertyName": "R_更新済み申込ステータスID"
            }
          ],
          "RefreshAfterFinish": true,
          "CheckDataValidation": true
        }
      ]
    }
  ]
}