{
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.ServerCommands.Models.PostRequestTrigger, ServerDesignerCommon",
      "Permission": {
        "AllowRoles": [
          "FGC_LoginUser"
        ]
      },
      "Parameters": [
        {
          "Name": "P_証明書申請日"
        },
        {
          "Type": 1,
          "ArrayParamItems": [
            {
              "Name": "P_付保ID"
            },
            {
              "Name": "P_選択フラグ"
            }
          ],
          "OnlySendChangedData": true,
          "PrimaryKeys": [
            "付保ID"
          ],
          "Name": "P_証明書申請リスト"
        },
        {
          "Name": "P_証明書申請フラグ"
        },
        {
          "Name": "P_証明書申請解除フラグ"
        }
      ]
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon",
      "CommandList": [
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_証明書申請フラグ"
                  }
                },
                "value": "1"
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "証明書納品待ちみST",
                  "TableValue": {
                    "TableName": "m_insurance_status",
                    "OnlyGetValue": true,
                    "TableValueType": 0,
                    "BindingInfos": [
                      {
                        "BindingInfo": {
                          "TableName": "m_insurance_status",
                          "ColumnName": "insurance_status_id"
                        },
                        "ColumnName": "insurance_status_id"
                      }
                    ],
                    "SqlCondition": {
                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                      "ColumnBindingInfo": {
                        "TableName": "m_insurance_status",
                        "ColumnName": "certificate_delivery_wait_flg"
                      },
                      "Value": "1"
                    }
                  },
                  "ID": "ecd091c626a84f3693894d7441d09b44"
                },
                {
                  "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
                  "LoopInfo": {
                    "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
                    "LoopCount": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_証明書申請リスト.EditRows"
                    },
                    "LoopIndexParamName": "カウンター",
                    "LoopItemParamName": "Item"
                  },
                  "CommandList": [
                    {
                      "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                      "ConditionAndCommandPairList": [
                        {
                          "Condition": {
                            "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                            "param": {
                              "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                              "ParamObject": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=Item.P_選択フラグ"
                              }
                            },
                            "value": "1"
                          },
                          "CommandList": [
                            {
                              "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                              "TableName": "t_object_insurance",
                              "ShowConfirm": false,
                              "ConfirmText": "本当に更新してもよろしいですか？",
                              "RowsToUpdate": 1,
                              "RowsToUpdateCondition": {
                                "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                "ColumnBindingInfo": {
                                  "TableName": "t_object_insurance",
                                  "ColumnName": "insurance_id"
                                },
                                "Value": {
                                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                  "SerializeProperty": "=Item.P_付保ID"
                                }
                              },
                              "UpdateValues": [
                                {
                                  "ColumnName": "insurance_certificate_apply_date",
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=P_証明書申請日"
                                  }
                                },
                                {
                                  "ColumnName": "insurance_cancel_date"
                                },
                                {
                                  "ColumnName": "insurance_status_id",
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=証明書納品待ちみST"
                                  }
                                }
                              ]
                            }
                          ],
                          "ID": "807ac5dc-aede-4e64-a952-7c9ceb01bd0b"
                        }
                      ]
                    }
                  ]
                }
              ],
              "ID": "c7135acf-6bce-4f36-9451-5684576a6a4a"
            }
          ],
          "Comments": "申請の場合"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_証明書申請解除フラグ"
                  }
                },
                "value": "1"
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "証明書申請待ちST",
                  "TableValue": {
                    "TableName": "m_insurance_status",
                    "OnlyGetValue": true,
                    "TableValueType": 0,
                    "BindingInfos": [
                      {
                        "BindingInfo": {
                          "TableName": "m_insurance_status",
                          "ColumnName": "insurance_status_id"
                        },
                        "ColumnName": "insurance_status_id"
                      }
                    ],
                    "SqlCondition": {
                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                      "ColumnBindingInfo": {
                        "TableName": "m_insurance_status",
                        "ColumnName": "certificate_application_wait_flg"
                      },
                      "Value": "1"
                    }
                  },
                  "ID": "ab83fd595c1645c28b16a528b6586a21"
                },
                {
                  "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
                  "LoopInfo": {
                    "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
                    "LoopCount": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_証明書申請リスト.EditRows"
                    },
                    "LoopIndexParamName": "カウンター",
                    "LoopItemParamName": "Item"
                  },
                  "CommandList": [
                    {
                      "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                      "ConditionAndCommandPairList": [
                        {
                          "Condition": {
                            "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                            "param": {
                              "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                              "ParamObject": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=Item.P_選択フラグ"
                              }
                            },
                            "value": "1"
                          },
                          "CommandList": [
                            {
                              "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                              "TableName": "t_object_insurance",
                              "ShowConfirm": false,
                              "ConfirmText": "本当に更新してもよろしいですか？",
                              "RowsToUpdate": 1,
                              "RowsToUpdateCondition": {
                                "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                "ColumnBindingInfo": {
                                  "TableName": "t_object_insurance",
                                  "ColumnName": "insurance_id"
                                },
                                "Value": {
                                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                  "SerializeProperty": "=Item.P_付保ID"
                                }
                              },
                              "UpdateValues": [
                                {
                                  "ColumnName": "insurance_certificate_apply_date"
                                },
                                {
                                  "ColumnName": "insurance_cancel_date"
                                },
                                {
                                  "ColumnName": "insurance_status_id",
                                  "Value": {
                                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                    "SerializeProperty": "=証明書申請待ちST"
                                  }
                                }
                              ]
                            }
                          ],
                          "ID": "fde3aa62-8ac7-4346-bc25-d717f61f0429"
                        }
                      ]
                    }
                  ]
                }
              ],
              "ID": "bb56b1b8-0c58-4073-ad79-ed39f50c6b6c"
            }
          ],
          "Comments": "解除の場合"
        }
      ]
    },
    {
      "$type": "Forguncy.Model.ReturnCommand, ServerDesignerCommon",
      "ErrorCode": "0",
      "CustomReturns": []
    }
  ],
  "Name": "証明書申請一括更新"
}