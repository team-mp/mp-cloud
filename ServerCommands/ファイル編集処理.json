{
  "Name": "ファイル編集処理",
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.SaveLoad.PostRequestTriggerSaveData, ServerDesignerCommon",
      "Permission": {
        "PermissionData": {
          "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionData, Forguncy.RbacPermission.Core",
          "permissionResource": {
            "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionResource, Forguncy.RbacPermission.Core"
          },
          "permissionBindings": [
            {
              "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionBinding, Forguncy.RbacPermission.Core",
              "roleNames": [
                "FGC_LoginUser"
              ]
            }
          ]
        }
      },
      "Parameters": [
        {
          "Name": "P_添付ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_変更後表示フィル名",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_変更後ファイル属性ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_変更後ファイルラベル",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_変更後添付不要フラグ",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_変更後公開フラグ",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_変更後工事見積ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_変更後工法ID",
          "DataValidationInfo": {}
        }
      ]
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon",
      "CommandList": [
        {
          "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
          "ServerCommandName": "登録更新ラベル取得",
          "Parameters": [
            {
              "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
              "ParamName": "P_ユーザーID"
            }
          ],
          "ReturnPropertiesTo": [
            {
              "ResultPropertyName": "R_ラベル名",
              "ResultTo": {
                "SerializeProperty": "最終更新ラベル"
              }
            },
            {
              "ResultPropertyName": "R_外部ユーザーフラグ"
            }
          ],
          "RefreshAfterFinish": true,
          "CheckDataValidation": true
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "添付情報",
          "TableValue": {
            "TableName": "t_object_attachment",
            "TableValueType": 1,
            "BindingInfos": [
              {
                "GUID": "2d24d730-62d0-40b3-ad8d-9ceaee045c9b",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "object_order_id",
                  "GUID": "1e7fa66d-d3d1-433d-8def-c2b0a604874b"
                },
                "ColumnName": "申込ID"
              },
              {
                "GUID": "157f6002-3695-463e-ac9d-2214dadfaa6d",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "file_path_name",
                  "GUID": "d2cf0386-adfe-4319-adab-aa9be5138164"
                },
                "ColumnName": "ファイルパス名"
              },
              {
                "GUID": "eb1a462d-3327-4954-bdae-e3bb924d262b",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "save_file_name",
                  "GUID": "638b73ef-b385-4f4b-91c2-e515b7730999"
                },
                "ColumnName": "保存ファイル名"
              },
              {
                "GUID": "b5cd2b49-7a3a-4748-8bb2-0ba8422af694",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "file_attribute_id",
                  "GUID": "3aa1d9ea-7f04-45c9-b8ab-a4724759692b"
                },
                "ColumnName": "ファイル属性ID"
              },
              {
                "GUID": "bd8521c6-4890-45fa-80f6-9d2cb0d018e1",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "display_file_name",
                  "GUID": "9157b35f-41ee-4070-ad7f-b380c08fda8e"
                },
                "ColumnName": "表示ファイル名"
              },
              {
                "GUID": "849214b5-3e1b-4b23-afc5-5d03955280b4",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "file_label",
                  "GUID": "e34e9e7a-4b5b-4917-b69a-1d413c9dd9a6"
                },
                "ColumnName": "ファイルラベル"
              },
              {
                "GUID": "596b027e-1f6e-463c-b332-51a874e058ac",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "publish_flg",
                  "GUID": "05078570-46d4-4972-a60e-36b7f930267f"
                },
                "ColumnName": "公開フラグ"
              },
              {
                "GUID": "6e68655f-6eac-40e0-92b4-972be8a2d7da",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "no_attachment_required_flg",
                  "GUID": "990f0c07-0002-4fb0-a9ab-cfb71bc2e4a8"
                },
                "ColumnName": "添付不要フラグ"
              },
              {
                "GUID": "bc145264-082e-43c8-9cf2-b22d2e02a81f",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "construction_estimate_id",
                  "GUID": "5e3aa6f8-af3f-42b8-9df7-aaa202cee573"
                },
                "ColumnName": "工事見積ID"
              },
              {
                "GUID": "c9bf91d5-e75b-4a81-874a-d50f706c568c",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "construction_estimate_id",
                  "GUID": "b1481bb2-9e4b-400f-990d-44de55dd78b6",
                  "RelationBinding": {
                    "RelatedTable": "t_object_construction_estimate",
                    "RelatedColumn": "construction_estimate_id",
                    "DisplayColumn": "construction_method_id"
                  }
                },
                "ColumnName": "工法ID"
              }
            ],
            "SqlCondition": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_attachment",
                "ColumnName": "attachment_id",
                "GUID": "0c9499b0-954e-494a-bec3-97844e128246"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_添付ID"
              }
            }
          },
          "ID": "032d86a961fa4969b9891045e7a8bb4f"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                "SubConditions": [
                  {
                    "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                    "param": {
                      "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                      "ParamObject": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後ファイル属性ID"
                      }
                    },
                    "value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=添付情報.ファイル属性ID"
                    },
                    "compareType": 1
                  },
                  {
                    "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                    "param": {
                      "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                      "ParamObject": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後表示フィル名"
                      }
                    },
                    "value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=添付情報.表示ファイル名"
                    },
                    "compareType": 1
                  }
                ],
                "RelationType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "変更前ファイルフルパス名",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=添付情報.ファイルパス名&添付情報.保存ファイル名"
                  },
                  "ID": "05df70e2509a44928cbb8f7a0cbd4bbb"
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "DropBox変更前ファイルフルパス名",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=SUBSTITUTE(変更前ファイルフルパス名,\"C:\\MP-Cloud\\Dropbox\",\"\")"
                  },
                  "ID": "3f90abeafdca4479bb57779d0b676bba"
                },
                {
                  "$type": "OperateFilesCommand.GetFileInformation, OperateFilesCommand",
                  "FilePath": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=変更前ファイルフルパス名"
                  },
                  "FileInfomationType": 1,
                  "ToParameterName": "拡張子",
                  "Comments": "拡張子取得"
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "変更後保存ファイル名",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=TEXT(P_変更後ファイル属性ID,\"000\")&\"_\"&P_変更後表示フィル名"
                  },
                  "ID": "0d11584cd55047fe97537068b8a5e153"
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "変更後保存ファイルフルパス名",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=添付情報.ファイルパス名&変更後保存ファイル名"
                  },
                  "ID": "2cb689f4590f4e0993049ada2865633f"
                },
                {
                  "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
                  "LoopInfo": {
                    "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
                    "LoopCount": "999",
                    "LoopIndexParamName": "カウンター",
                    "LoopItemParamName": "Item"
                  },
                  "CommandList": [
                    {
                      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                      "ParameterName": "登録済み件数",
                      "TableValue": {
                        "TableName": "t_object_attachment",
                        "TableValueType": 3,
                        "SqlCondition": {
                          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                          "SubConditions": [
                            {
                              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                              "ColumnBindingInfo": {
                                "TableName": "t_object_attachment",
                                "ColumnName": "object_order_id",
                                "GUID": "0ab4efbd-7480-488a-b8c2-36d998988b4d"
                              },
                              "Value": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=添付情報.申込ID"
                              }
                            },
                            {
                              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                              "ColumnBindingInfo": {
                                "TableName": "t_object_attachment",
                                "ColumnName": "save_file_name",
                                "GUID": "0ae9faa8-d07c-496e-a990-88180092a142"
                              },
                              "Value": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=変更後保存ファイル名"
                              }
                            }
                          ]
                        }
                      },
                      "ID": "819edbdb390f4f03b5e2bcbf10bf89dd"
                    },
                    {
                      "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                      "ConditionAndCommandPairList": [
                        {
                          "Condition": {
                            "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                            "param": {
                              "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                              "ParamObject": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=登録済み件数"
                              }
                            },
                            "value": "0"
                          },
                          "CommandList": [
                            {
                              "$type": "OperateFilesCommand.GetFileInformation, OperateFilesCommand",
                              "FilePath": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=変更後保存ファイルフルパス名"
                              },
                              "FileInfomationType": 5,
                              "ToParameterName": "ファイル有無"
                            },
                            {
                              "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                              "ConditionAndCommandPairList": [
                                {
                                  "Condition": {
                                    "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                                    "param": {
                                      "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                                      "ParamObject": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=ファイル有無"
                                      }
                                    },
                                    "value": "False"
                                  },
                                  "CommandList": [
                                    {
                                      "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                                      "TableName": "t_object_attachment",
                                      "ShowConfirm": false,
                                      "RowsToUpdate": 1,
                                      "RowsToUpdateCondition": {
                                        "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                        "ColumnBindingInfo": {
                                          "TableName": "t_object_attachment",
                                          "ColumnName": "attachment_id",
                                          "GUID": "8a42436b-c67a-418a-8df3-6e20ae681f80"
                                        },
                                        "Value": {
                                          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                          "SerializeProperty": "=P_添付ID"
                                        }
                                      },
                                      "UpdateBindingValues": [
                                        {
                                          "BindingInfo": {
                                            "TableName": "t_object_attachment",
                                            "ColumnName": "file_attribute_id",
                                            "GUID": "428b684a-1bbd-4c54-b75d-9fafb9bd218a"
                                          },
                                          "Value": {
                                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                            "SerializeProperty": "=P_変更後ファイル属性ID"
                                          }
                                        },
                                        {
                                          "BindingInfo": {
                                            "TableName": "t_object_attachment",
                                            "ColumnName": "display_file_name",
                                            "GUID": "0a90accc-cb1b-4e2e-95f7-a40bce035ccb"
                                          },
                                          "Value": {
                                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                            "SerializeProperty": "=P_変更後表示フィル名"
                                          }
                                        },
                                        {
                                          "BindingInfo": {
                                            "TableName": "t_object_attachment",
                                            "ColumnName": "save_file_name",
                                            "GUID": "1c93bfe1-e4bb-4ec5-928b-a2030e5b207c"
                                          },
                                          "Value": {
                                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                            "SerializeProperty": "=変更後保存ファイル名"
                                          }
                                        },
                                        {
                                          "BindingInfo": {
                                            "TableName": "t_object_attachment",
                                            "ColumnName": "latest_updated_label",
                                            "GUID": "45bb328a-44ee-47a5-9a8d-fe5ab9adaf30"
                                          },
                                          "Value": {
                                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                            "SerializeProperty": "=最終更新ラベル"
                                          }
                                        }
                                      ]
                                    },
                                    {
                                      "$type": "Forguncy.Model.CatchExceptionCommand, ServerDesignerCommon",
                                      "TryCommandPart": {
                                        "CommandList": [
                                          {
                                            "$type": "OperateFilesCommand.CloudStorage.RenameFileCommand, OperateFilesCommand",
                                            "FilePath": {
                                              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                              "SerializeProperty": "=DropBox変更前ファイルフルパス名"
                                            },
                                            "NewName": {
                                              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                              "SerializeProperty": "=変更後保存ファイル名"
                                            },
                                            "Type": "DropboxStrage"
                                          }
                                        ]
                                      },
                                      "CatchCommandPart": {
                                        "CommandList": [
                                          {
                                            "$type": "OperateFilesCommand.RenameFileCommand, OperateFilesCommand",
                                            "FilePath": {
                                              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                              "SerializeProperty": "=変更前ファイルフルパス名"
                                            },
                                            "NewName": {
                                              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                              "SerializeProperty": "=変更後保存ファイル名"
                                            }
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "$type": "Forguncy.Model.EndLoopCommand, ServerDesignerCommon",
                                      "WithinLoop": true
                                    }
                                  ],
                                  "ID": "a2bbc801-d953-4b0f-9a33-cb9662be1f5a"
                                }
                              ]
                            }
                          ],
                          "ID": "bd42246d-c61c-42be-8c6c-41cf2208a57b"
                        }
                      ]
                    },
                    {
                      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                      "ParameterName": "変更後保存ファイル名",
                      "ParameterValue": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=SUBSTITUTE(変更後保存ファイル名,拡張子,\"\")&\"_\"&カウンター&拡張子"
                      },
                      "ID": "95fdeae9942c4589a78213f88f82b927"
                    },
                    {
                      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                      "ParameterName": "変更後保存ファイルフルパス名",
                      "ParameterValue": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=添付情報.ファイルパス名&変更後保存ファイル名"
                      },
                      "ID": "29063659ac8f4f0fb4bb116d418ab611"
                    }
                  ]
                }
              ],
              "Comments": "ファイル名かファイル属性が変更されていたら",
              "ID": "263f7ba7-5336-46c1-b2c0-d70ea0550ddd"
            }
          ],
          "Comments": "ファイル属性、またはファイル名変更の場合"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_変更後ファイルラベル"
                  }
                },
                "value": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=添付情報.ファイルラベル"
                },
                "compareType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=P_変更後ファイルラベル"
                          }
                        },
                        "value": "2,3",
                        "compareType": 12
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_添付不要フラグ",
                          "ParameterValue": "1",
                          "ID": "83870224925b45e1b83a683196fcaa94"
                        }
                      ],
                      "Comments": "NG版の場合",
                      "ID": "f419f795-d439-4033-8c47-10375c6414b3"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_添付不要フラグ",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=添付情報.添付不要フラグ"
                          },
                          "ID": "4af3c1fdc5ec47e2aa0075c70160065d"
                        }
                      ],
                      "ID": "9967f948-7fbd-4e42-b569-45224add6b37"
                    }
                  ]
                },
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=P_変更後ファイルラベル"
                          }
                        },
                        "value": "3"
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_公開フラグ",
                          "ParameterValue": "0",
                          "ID": "ee532d1c8dc24779ad982e6fb8309c36"
                        }
                      ],
                      "Comments": "NG版の場合",
                      "ID": "dedf2562-cd89-4f7f-86aa-9ae39b8dba97"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_公開フラグ",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=添付情報.公開フラグ"
                          },
                          "ID": "d73c9195714c4b4a9b41837c65cca393"
                        }
                      ],
                      "ID": "0ed51b38-1224-4123-b683-cf541a2dbcd1"
                    }
                  ]
                },
                {
                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                  "TableName": "t_object_attachment",
                  "ShowConfirm": false,
                  "RowsToUpdate": 1,
                  "RowsToUpdateCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "t_object_attachment",
                      "ColumnName": "attachment_id",
                      "GUID": "4b4fdabc-3769-4bf5-8ef9-8d33bb306b5b"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_添付ID"
                    }
                  },
                  "UpdateBindingValues": [
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "file_label",
                        "GUID": "319122ed-8cf2-4c2a-8cc5-f7d83f606197"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後ファイルラベル"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "no_attachment_required_flg",
                        "GUID": "722071ce-26cd-4700-947f-7743276d6b9e"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=V_添付不要フラグ"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "publish_flg",
                        "GUID": "95b4d3f5-46cf-4b87-8d23-014ad2bf132f"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=V_公開フラグ"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "latest_updated_label",
                        "GUID": "18766d6b-e832-4b90-9c55-59d2571e14b4"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=最終更新ラベル"
                      }
                    }
                  ]
                }
              ],
              "ID": "48c4c8e7-667b-4b1e-b157-7e0bbcafd76f"
            }
          ],
          "Comments": "ファイルラベル変更の場合"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_変更後公開フラグ"
                  }
                },
                "value": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=添付情報.公開フラグ"
                },
                "compareType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                  "TableName": "t_object_attachment",
                  "ShowConfirm": false,
                  "RowsToUpdate": 1,
                  "RowsToUpdateCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "t_object_attachment",
                      "ColumnName": "attachment_id",
                      "GUID": "4b4fdabc-3769-4bf5-8ef9-8d33bb306b5b"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_添付ID"
                    }
                  },
                  "UpdateBindingValues": [
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "publish_flg",
                        "GUID": "a946ae45-4bbc-4c3e-8ae0-1b739c022e6a"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後公開フラグ"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "latest_updated_label",
                        "GUID": "27a70ff5-a56f-43d8-83b7-f71a2f584195"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=最終更新ラベル"
                      }
                    }
                  ]
                }
              ],
              "ID": "9c60386f-25d0-413f-a7ed-781c4d10cec8"
            }
          ],
          "Comments": "公開フラグ変更の場合"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_変更後添付不要フラグ"
                  }
                },
                "value": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=添付情報.添付不要フラグ"
                },
                "compareType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                  "TableName": "t_object_attachment",
                  "ShowConfirm": false,
                  "RowsToUpdate": 1,
                  "RowsToUpdateCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "t_object_attachment",
                      "ColumnName": "attachment_id",
                      "GUID": "4b4fdabc-3769-4bf5-8ef9-8d33bb306b5b"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_添付ID"
                    }
                  },
                  "UpdateBindingValues": [
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "no_attachment_required_flg",
                        "GUID": "dffe4a43-afcc-47d4-afab-e3bd6cf514ad"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後添付不要フラグ"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "latest_updated_label",
                        "GUID": "e8b0163c-740c-4dee-950f-a5cd74ddfbe2"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=最終更新ラベル"
                      }
                    }
                  ]
                }
              ],
              "ID": "c39c6d52-0ce9-494f-9278-9f9dfaa9f93a"
            }
          ],
          "Comments": "添付不要フラグ変更の場合"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_変更後工事見積ID"
                  }
                },
                "value": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=添付情報.工事見積ID"
                },
                "compareType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                  "TableName": "t_object_attachment",
                  "ShowConfirm": false,
                  "RowsToUpdate": 1,
                  "RowsToUpdateCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "t_object_attachment",
                      "ColumnName": "attachment_id",
                      "GUID": "4b4fdabc-3769-4bf5-8ef9-8d33bb306b5b"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_添付ID"
                    }
                  },
                  "UpdateBindingValues": [
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "construction_estimate_id",
                        "GUID": "cbac11c3-99a7-4059-a867-e28487d16160"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後工事見積ID"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "latest_updated_label",
                        "GUID": "ec4d395a-611f-4a7c-9273-f29b8a04081c"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=最終更新ラベル"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "object_id",
                        "GUID": "bb7d3f93-4bcd-48af-919c-b38c97b34d96"
                      }
                    }
                  ]
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "変更前工事見積添付カウント",
                  "TableValue": {
                    "TableName": "t_object_attachment",
                    "TableValueType": 3,
                    "SqlCondition": {
                      "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                      "SubConditions": [
                        {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "ColumnBindingInfo": {
                            "TableName": "t_object_attachment",
                            "ColumnName": "construction_estimate_id",
                            "GUID": "bd808c3c-e5cf-4483-b0f0-1883bd15e7ed"
                          },
                          "Value": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=添付情報.工事見積ID"
                          }
                        },
                        {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "ColumnBindingInfo": {
                            "TableName": "t_object_attachment",
                            "ColumnName": "active_flg",
                            "GUID": "3c6f1abe-c8ae-4462-ac3a-76bd07ff1757"
                          },
                          "Value": "1"
                        }
                      ]
                    },
                    "NullFormulaValueQueryPolicy": 0
                  },
                  "ID": "1ef3b4695d514e49bc19c5d009967524"
                },
                {
                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                  "TableName": "t_object_construction_estimate",
                  "ShowConfirm": false,
                  "RowsToUpdate": 1,
                  "RowsToUpdateCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "t_object_construction_estimate",
                      "ColumnName": "construction_estimate_id",
                      "GUID": "eeb0fc3c-8ae3-492b-8757-3fe1e5841dea"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=添付情報.工事見積ID"
                    }
                  },
                  "UpdateBindingValues": [
                    {
                      "BindingInfo": {
                        "TableName": "t_object_construction_estimate",
                        "ColumnName": "estimate_file_count",
                        "GUID": "7283c15a-5d4e-4289-b58a-1291af9f51f9"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=変更前工事見積添付カウント"
                      }
                    }
                  ]
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "変更後工事見積添付カウント",
                  "TableValue": {
                    "TableName": "t_object_attachment",
                    "TableValueType": 3,
                    "SqlCondition": {
                      "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                      "SubConditions": [
                        {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "ColumnBindingInfo": {
                            "TableName": "t_object_attachment",
                            "ColumnName": "construction_estimate_id",
                            "GUID": "a092af99-efcd-451e-b977-56a4e02cf533"
                          },
                          "Value": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=P_変更後工事見積ID"
                          }
                        },
                        {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "ColumnBindingInfo": {
                            "TableName": "t_object_attachment",
                            "ColumnName": "active_flg",
                            "GUID": "9cba898d-001b-46f5-8f61-70561025a78e"
                          },
                          "Value": "1"
                        }
                      ]
                    },
                    "NullFormulaValueQueryPolicy": 0
                  },
                  "ID": "846c653194254864972be5ea639c33c6"
                },
                {
                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                  "TableName": "t_object_construction_estimate",
                  "ShowConfirm": false,
                  "RowsToUpdate": 1,
                  "RowsToUpdateCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "t_object_construction_estimate",
                      "ColumnName": "construction_estimate_id",
                      "GUID": "cd89d447-ca21-4901-baad-7f3649903083"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_変更後工事見積ID"
                    }
                  },
                  "UpdateBindingValues": [
                    {
                      "BindingInfo": {
                        "TableName": "t_object_construction_estimate",
                        "ColumnName": "estimate_file_count",
                        "GUID": "90c97f7e-2681-4294-98c4-391f52f2e6ae"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=変更後工事見積添付カウント"
                      }
                    }
                  ]
                }
              ],
              "ID": "8ab9ecad-104f-4037-9a6e-ff24614414f3"
            }
          ],
          "Comments": "工事見積ID変更の場合"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                "SubConditions": [
                  {
                    "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                    "param": {
                      "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                      "ParamObject": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後工法ID"
                      }
                    },
                    "value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=添付情報.工法ID"
                    },
                    "compareType": 1
                  },
                  {
                    "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                    "param": {
                      "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                      "ParamObject": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後工事見積ID"
                      }
                    },
                    "value": "%Null%",
                    "compareType": 1
                  }
                ]
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                  "TableName": "t_object_construction_estimate",
                  "ShowConfirm": false,
                  "RowsToUpdate": 1,
                  "RowsToUpdateCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "t_object_construction_estimate",
                      "ColumnName": "construction_estimate_id",
                      "GUID": "ef8e35a4-ccec-405c-8fe3-9fd70dcf9c21"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_変更後工事見積ID"
                    }
                  },
                  "UpdateBindingValues": [
                    {
                      "BindingInfo": {
                        "TableName": "t_object_construction_estimate",
                        "ColumnName": "construction_method_id",
                        "GUID": "638d71a7-5489-4ae1-a657-6254f885b79a"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後工法ID"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_construction_estimate",
                        "ColumnName": "last_updated_label",
                        "GUID": "1397ca71-a9e1-4add-9b2a-395fbf4df628"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=最終更新ラベル"
                      }
                    }
                  ]
                }
              ],
              "ID": "a496d691-baae-436c-95fc-3ce2557bb76a"
            }
          ],
          "Comments": "工法ID変更の場合"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "添付関連付け情報",
          "TableValue": {
            "TableName": "t_object_attachment_relation",
            "BindingInfos": [
              {
                "GUID": "89ab3203-c115-402a-b396-b6b64883a14f",
                "BindingInfo": {
                  "TableName": "t_object_attachment_relation",
                  "ColumnName": "object_id",
                  "GUID": "106b762c-11b1-470e-8ea3-47a5fab798bb"
                },
                "ColumnName": "物件ID"
              }
            ],
            "SqlCondition": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_attachment_relation",
                "ColumnName": "attachment_id",
                "GUID": "8234994e-f28e-4739-9c1a-1a70ce32dbf0"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_添付ID"
              }
            },
            "NullFormulaValueQueryPolicy": 0
          },
          "ID": "599a893d1ca549b8963cd7f7dccf66f1"
        },
        {
          "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
          "LoopInfo": {
            "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
            "LoopCount": {
              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
              "SerializeProperty": "=添付関連付け情報"
            },
            "LoopItemParamName": "Item添付関連付け"
          },
          "CommandList": [
            {
              "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
              "ServerCommandName": "ファイル数更新処理",
              "Parameters": [
                {
                  "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                  "ParamName": "P_物件IDs",
                  "Value": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=Item添付関連付け.物件ID"
                  }
                }
              ],
              "RefreshAfterFinish": true,
              "CheckDataValidation": true
            }
          ]
        }
      ]
    }
  ]
}