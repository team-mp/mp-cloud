{
  "Name": "ファイル編集処理",
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.SaveLoad.PostRequestTriggerSaveData, ServerDesignerCommon",
      "Permission": {
        "PermissionData": {
          "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionData, Forguncy.RbacPermission.Core",
          "permissionResource": {
            "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionResource, Forguncy.RbacPermission.Core"
          },
          "permissionBindings": [
            {
              "$type": "Forguncy.RbacPermission.Core.Impl.ServerCommand.ServerCommandPermissionBinding, Forguncy.RbacPermission.Core",
              "roleNames": [
                "FGC_LoginUser"
              ]
            }
          ]
        }
      },
      "Parameters": [
        {
          "Name": "P_添付ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_変更後表示フィル名",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_変更後ファイル属性ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_変更後ファイルラベル",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_変更後添付不要フラグ",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_変更後公開フラグ",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_変更後工事見積ID",
          "DataValidationInfo": {}
        },
        {
          "Name": "P_変更後工法ID",
          "DataValidationInfo": {}
        }
      ]
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon",
      "CommandList": [
        {
          "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
          "ServerCommandName": "登録更新ラベル取得",
          "ReturnPropertiesTo": [
            {
              "ResultPropertyName": "R_ラベル名",
              "ResultTo": {
                "SerializeProperty": "最終更新ラベル"
              }
            },
            {
              "ResultPropertyName": "R_外部ユーザーフラグ"
            }
          ],
          "RefreshAfterFinish": true,
          "CheckDataValidation": true
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "添付情報",
          "TableValue": {
            "TableName": "t_object_attachment",
            "TableValueType": 1,
            "BindingInfos": [
              {
                "GUID": "55161fe2-1e17-4170-86c2-adccb9fdbb49",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "object_order_id",
                  "GUID": "1e7fa66d-d3d1-433d-8def-c2b0a604874b"
                },
                "ColumnName": "申込ID"
              },
              {
                "GUID": "af552e74-287f-477c-bf08-156e8a2e2517",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "file_path_name",
                  "GUID": "d2cf0386-adfe-4319-adab-aa9be5138164"
                },
                "ColumnName": "ファイルパス名"
              },
              {
                "GUID": "1d511ac8-1fde-4675-94d2-4c29d1d00173",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "save_file_name",
                  "GUID": "638b73ef-b385-4f4b-91c2-e515b7730999"
                },
                "ColumnName": "保存ファイル名"
              },
              {
                "GUID": "1e085c01-fbb8-4cd0-9bbf-7b0b5ed12322",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "file_attribute_id",
                  "GUID": "3aa1d9ea-7f04-45c9-b8ab-a4724759692b"
                },
                "ColumnName": "ファイル属性ID"
              },
              {
                "GUID": "10b6be81-6f97-456f-b2b6-cebe002c617f",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "display_file_name",
                  "GUID": "9157b35f-41ee-4070-ad7f-b380c08fda8e"
                },
                "ColumnName": "表示ファイル名"
              },
              {
                "GUID": "d78d5856-c2ba-4042-b5d8-bbda336bb45f",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "file_label",
                  "GUID": "e34e9e7a-4b5b-4917-b69a-1d413c9dd9a6"
                },
                "ColumnName": "ファイルラベル"
              },
              {
                "GUID": "b9b2c99c-a870-4945-9198-5d3d022b4ef5",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "publish_flg",
                  "GUID": "05078570-46d4-4972-a60e-36b7f930267f"
                },
                "ColumnName": "公開フラグ"
              },
              {
                "GUID": "181cbc75-c23b-42b9-8681-b3dda3e32d56",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "no_attachment_required_flg",
                  "GUID": "990f0c07-0002-4fb0-a9ab-cfb71bc2e4a8"
                },
                "ColumnName": "添付不要フラグ"
              },
              {
                "GUID": "283b984e-220e-4ce1-aa90-3e2a3d047b31",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "construction_estimate_id",
                  "GUID": "5e3aa6f8-af3f-42b8-9df7-aaa202cee573"
                },
                "ColumnName": "工事見積ID"
              },
              {
                "GUID": "da60be77-227c-4676-a309-45255df124be",
                "BindingInfo": {
                  "TableName": "t_object_attachment",
                  "ColumnName": "construction_estimate_id",
                  "GUID": "b1481bb2-9e4b-400f-990d-44de55dd78b6",
                  "RelationBinding": {
                    "RelatedTable": "t_object_construction_estimate",
                    "RelatedColumn": "construction_estimate_id",
                    "DisplayColumn": "construction_method_id"
                  }
                },
                "ColumnName": "工法ID"
              }
            ],
            "SqlCondition": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_attachment",
                "ColumnName": "attachment_id",
                "GUID": "0c9499b0-954e-494a-bec3-97844e128246"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_添付ID"
              }
            }
          },
          "ID": "4019d3f1aaed420dbe571c0584c3fa29"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                "SubConditions": [
                  {
                    "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                    "param": {
                      "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                      "ParamObject": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後ファイル属性ID"
                      }
                    },
                    "value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=添付情報.ファイル属性ID"
                    },
                    "compareType": 1
                  },
                  {
                    "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                    "param": {
                      "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                      "ParamObject": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後表示フィル名"
                      }
                    },
                    "value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=添付情報.表示ファイル名"
                    },
                    "compareType": 1
                  }
                ],
                "RelationType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "変更前ファイルフルパス名",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=添付情報.ファイルパス名&添付情報.保存ファイル名"
                  },
                  "ID": "d96606c73f064764b7bb3a8f78081d21"
                },
                {
                  "$type": "OperateFilesCommand.GetFileInformation, OperateFilesCommand",
                  "FilePath": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=変更前ファイルフルパス名"
                  },
                  "FileInfomationType": 1,
                  "ToParameterName": "拡張子",
                  "Comments": "拡張子取得"
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "変更後保存ファイル名",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=TEXT(P_変更後ファイル属性ID,\"000\")&\"_\"&P_変更後表示フィル名"
                  },
                  "ID": "95790da44fc249ff922fd83cf6e7178b"
                },
                {
                  "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                  "ParameterName": "変更後保存ファイルフルパス名",
                  "ParameterValue": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=添付情報.ファイルパス名&変更後保存ファイル名"
                  },
                  "ID": "b90ec426fd1e451e98775ee3be39210c"
                },
                {
                  "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
                  "LoopInfo": {
                    "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
                    "LoopCount": "999",
                    "LoopIndexParamName": "カウンター",
                    "LoopItemParamName": "Item"
                  },
                  "CommandList": [
                    {
                      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                      "ParameterName": "登録済み件数",
                      "TableValue": {
                        "TableName": "t_object_attachment",
                        "TableValueType": 3,
                        "SqlCondition": {
                          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                          "SubConditions": [
                            {
                              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                              "ColumnBindingInfo": {
                                "TableName": "t_object_attachment",
                                "ColumnName": "object_order_id",
                                "GUID": "0ab4efbd-7480-488a-b8c2-36d998988b4d"
                              },
                              "Value": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=添付情報.申込ID"
                              }
                            },
                            {
                              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                              "ColumnBindingInfo": {
                                "TableName": "t_object_attachment",
                                "ColumnName": "save_file_name",
                                "GUID": "0ae9faa8-d07c-496e-a990-88180092a142"
                              },
                              "Value": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=変更後保存ファイル名"
                              }
                            }
                          ]
                        }
                      },
                      "ID": "819edbdb390f4f03b5e2bcbf10bf89dd"
                    },
                    {
                      "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                      "ConditionAndCommandPairList": [
                        {
                          "Condition": {
                            "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                            "param": {
                              "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                              "ParamObject": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=登録済み件数"
                              }
                            },
                            "value": "0"
                          },
                          "CommandList": [
                            {
                              "$type": "OperateFilesCommand.GetFileInformation, OperateFilesCommand",
                              "FilePath": {
                                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                "SerializeProperty": "=変更後保存ファイルフルパス名"
                              },
                              "FileInfomationType": 5,
                              "ToParameterName": "ファイル有無"
                            },
                            {
                              "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                              "ConditionAndCommandPairList": [
                                {
                                  "Condition": {
                                    "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                                    "param": {
                                      "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                                      "ParamObject": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=ファイル有無"
                                      }
                                    },
                                    "value": "False"
                                  },
                                  "CommandList": [
                                    {
                                      "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                                      "TableName": "t_object_attachment",
                                      "ShowConfirm": false,
                                      "RowsToUpdate": 1,
                                      "RowsToUpdateCondition": {
                                        "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                                        "ColumnBindingInfo": {
                                          "TableName": "t_object_attachment",
                                          "ColumnName": "attachment_id",
                                          "GUID": "8a42436b-c67a-418a-8df3-6e20ae681f80"
                                        },
                                        "Value": {
                                          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                          "SerializeProperty": "=P_添付ID"
                                        }
                                      },
                                      "UpdateBindingValues": [
                                        {
                                          "BindingInfo": {
                                            "TableName": "t_object_attachment",
                                            "ColumnName": "file_attribute_id",
                                            "GUID": "bb5a64fb-c27b-4e71-a5ce-306fa588cd45"
                                          },
                                          "Value": {
                                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                            "SerializeProperty": "=P_変更後ファイル属性ID"
                                          }
                                        },
                                        {
                                          "BindingInfo": {
                                            "TableName": "t_object_attachment",
                                            "ColumnName": "display_file_name",
                                            "GUID": "916fa94a-1608-4566-97a2-3fdbf30c71c8"
                                          },
                                          "Value": {
                                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                            "SerializeProperty": "=P_変更後表示フィル名"
                                          }
                                        },
                                        {
                                          "BindingInfo": {
                                            "TableName": "t_object_attachment",
                                            "ColumnName": "save_file_name",
                                            "GUID": "a168a421-850c-4390-8d08-6b37d6e64c65"
                                          },
                                          "Value": {
                                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                            "SerializeProperty": "=変更後保存ファイル名"
                                          }
                                        },
                                        {
                                          "BindingInfo": {
                                            "TableName": "t_object_attachment",
                                            "ColumnName": "latest_updated_label",
                                            "GUID": "53661240-bfb7-4d21-ae27-5caa5df64eab"
                                          },
                                          "Value": {
                                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                            "SerializeProperty": "=最終更新ラベル"
                                          }
                                        }
                                      ]
                                    },
                                    {
                                      "$type": "OperateFilesCommand.RenameFileCommand, OperateFilesCommand",
                                      "FilePath": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=変更前ファイルフルパス名"
                                      },
                                      "NewName": {
                                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                                        "SerializeProperty": "=変更後保存ファイル名"
                                      }
                                    },
                                    {
                                      "$type": "Forguncy.Model.EndLoopCommand, ServerDesignerCommon",
                                      "WithinLoop": true
                                    }
                                  ],
                                  "ID": "9a289b05-5fec-43bb-966b-21554d771a4f"
                                }
                              ]
                            }
                          ],
                          "ID": "409ea251-c505-4c89-b90c-7c6b8dcb805a"
                        }
                      ]
                    },
                    {
                      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                      "ParameterName": "変更後保存ファイル名",
                      "ParameterValue": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=SUBSTITUTE(変更後保存ファイル名,拡張子,\"\")&\"_\"&カウンター&拡張子"
                      },
                      "ID": "d9ac796686214eb69dc49cbb49905035"
                    },
                    {
                      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                      "ParameterName": "変更後保存ファイルフルパス名",
                      "ParameterValue": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=添付情報.ファイルパス名&変更後保存ファイル名"
                      },
                      "ID": "2cb54f5a6f6b4c9e8c47e92146c4dcd4"
                    }
                  ]
                }
              ],
              "Comments": "ファイル名かファイル属性が変更されていたら",
              "ID": "6378407b-cde8-457d-897e-de81f8ee6cf6"
            }
          ],
          "Comments": "ファイル属性、またはファイル名変更の場合"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_変更後ファイルラベル"
                  }
                },
                "value": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=添付情報.ファイルラベル"
                },
                "compareType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=P_変更後ファイルラベル"
                          }
                        },
                        "value": "2,3",
                        "compareType": 12
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_添付不要フラグ",
                          "ParameterValue": "1",
                          "ID": "83870224925b45e1b83a683196fcaa94"
                        }
                      ],
                      "Comments": "NG版の場合",
                      "ID": "a1983d55-412b-439b-894b-03b9123365d0"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_添付不要フラグ",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=添付情報.添付不要フラグ"
                          },
                          "ID": "4af3c1fdc5ec47e2aa0075c70160065d"
                        }
                      ],
                      "ID": "545a0cf6-ad67-4d5e-b46e-2af705f3155b"
                    }
                  ]
                },
                {
                  "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
                  "ConditionAndCommandPairList": [
                    {
                      "Condition": {
                        "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                        "param": {
                          "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                          "ParamObject": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=P_変更後ファイルラベル"
                          }
                        },
                        "value": "3"
                      },
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_公開フラグ",
                          "ParameterValue": "0",
                          "ID": "ee532d1c8dc24779ad982e6fb8309c36"
                        }
                      ],
                      "Comments": "NG版の場合",
                      "ID": "9d5dc26e-58d0-41c9-820f-4ef34e939ac0"
                    },
                    {
                      "CommandList": [
                        {
                          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
                          "ParameterName": "V_公開フラグ",
                          "ParameterValue": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=添付情報.公開フラグ"
                          },
                          "ID": "d73c9195714c4b4a9b41837c65cca393"
                        }
                      ],
                      "ID": "3b5f1e96-5a8e-4d5b-98c9-d2c4fd0772bd"
                    }
                  ]
                },
                {
                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                  "TableName": "t_object_attachment",
                  "ShowConfirm": false,
                  "RowsToUpdate": 1,
                  "RowsToUpdateCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "t_object_attachment",
                      "ColumnName": "attachment_id",
                      "GUID": "4b4fdabc-3769-4bf5-8ef9-8d33bb306b5b"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_添付ID"
                    }
                  },
                  "UpdateBindingValues": [
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "file_label",
                        "GUID": "319122ed-8cf2-4c2a-8cc5-f7d83f606197"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後ファイルラベル"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "no_attachment_required_flg",
                        "GUID": "722071ce-26cd-4700-947f-7743276d6b9e"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=V_添付不要フラグ"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "publish_flg",
                        "GUID": "95b4d3f5-46cf-4b87-8d23-014ad2bf132f"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=V_公開フラグ"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "latest_updated_label",
                        "GUID": "18766d6b-e832-4b90-9c55-59d2571e14b4"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=最終更新ラベル"
                      }
                    }
                  ]
                }
              ],
              "ID": "7f46e396-0e1b-4b7c-ba62-5e44d32015fa"
            }
          ],
          "Comments": "ファイルラベル変更の場合"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_変更後公開フラグ"
                  }
                },
                "value": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=添付情報.公開フラグ"
                },
                "compareType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                  "TableName": "t_object_attachment",
                  "ShowConfirm": false,
                  "RowsToUpdate": 1,
                  "RowsToUpdateCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "t_object_attachment",
                      "ColumnName": "attachment_id",
                      "GUID": "4b4fdabc-3769-4bf5-8ef9-8d33bb306b5b"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_添付ID"
                    }
                  },
                  "UpdateBindingValues": [
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "publish_flg",
                        "GUID": "4c577abd-67a0-49a3-a0e6-1a60cadc50c8"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後公開フラグ"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "latest_updated_label",
                        "GUID": "c78f4a34-b404-4445-a710-29383fa43590"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=最終更新ラベル"
                      }
                    }
                  ]
                }
              ],
              "ID": "972d3365-4f6f-4f48-be14-8c7762a5cc0c"
            }
          ],
          "Comments": "公開フラグ変更の場合"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_変更後添付不要フラグ"
                  }
                },
                "value": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=添付情報.添付不要フラグ"
                },
                "compareType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                  "TableName": "t_object_attachment",
                  "ShowConfirm": false,
                  "RowsToUpdate": 1,
                  "RowsToUpdateCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "t_object_attachment",
                      "ColumnName": "attachment_id",
                      "GUID": "4b4fdabc-3769-4bf5-8ef9-8d33bb306b5b"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_添付ID"
                    }
                  },
                  "UpdateBindingValues": [
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "no_attachment_required_flg",
                        "GUID": "dffe4a43-afcc-47d4-afab-e3bd6cf514ad"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後添付不要フラグ"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "latest_updated_label",
                        "GUID": "e8b0163c-740c-4dee-950f-a5cd74ddfbe2"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=最終更新ラベル"
                      }
                    }
                  ]
                }
              ],
              "ID": "1f1ea881-e04f-438a-a1ee-012b12b316c4"
            }
          ],
          "Comments": "添付不要フラグ変更の場合"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=P_変更後工事見積ID"
                  }
                },
                "value": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=添付情報.工事見積ID"
                },
                "compareType": 1
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                  "TableName": "t_object_attachment",
                  "ShowConfirm": false,
                  "RowsToUpdate": 1,
                  "RowsToUpdateCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "t_object_attachment",
                      "ColumnName": "attachment_id",
                      "GUID": "4b4fdabc-3769-4bf5-8ef9-8d33bb306b5b"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_添付ID"
                    }
                  },
                  "UpdateBindingValues": [
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "construction_estimate_id",
                        "GUID": "00f8655c-48c1-48e3-9830-265e89bce945"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後工事見積ID"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_attachment",
                        "ColumnName": "latest_updated_label",
                        "GUID": "9f315329-e121-41fe-b85f-47a135ae98f5"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=最終更新ラベル"
                      }
                    }
                  ]
                }
              ],
              "ID": "0cd330e3-b84b-4a93-88ee-b6be0f9a94aa"
            }
          ],
          "Comments": "工事見積ID変更の場合"
        },
        {
          "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
          "ConditionAndCommandPairList": [
            {
              "Condition": {
                "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                "SubConditions": [
                  {
                    "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                    "param": {
                      "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                      "ParamObject": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後工法ID"
                      }
                    },
                    "value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=添付情報.工法ID"
                    },
                    "compareType": 1
                  },
                  {
                    "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                    "param": {
                      "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                      "ParamObject": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後工事見積ID"
                      }
                    },
                    "value": "%Null%",
                    "compareType": 1
                  }
                ]
              },
              "CommandList": [
                {
                  "$type": "Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",
                  "TableName": "t_object_construction_estimate",
                  "ShowConfirm": false,
                  "RowsToUpdate": 1,
                  "RowsToUpdateCondition": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "ColumnBindingInfo": {
                      "TableName": "t_object_construction_estimate",
                      "ColumnName": "construction_estimate_id",
                      "GUID": "ef8e35a4-ccec-405c-8fe3-9fd70dcf9c21"
                    },
                    "Value": {
                      "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                      "SerializeProperty": "=P_変更後工事見積ID"
                    }
                  },
                  "UpdateBindingValues": [
                    {
                      "BindingInfo": {
                        "TableName": "t_object_construction_estimate",
                        "ColumnName": "construction_method_id",
                        "GUID": "638d71a7-5489-4ae1-a657-6254f885b79a"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=P_変更後工法ID"
                      }
                    },
                    {
                      "BindingInfo": {
                        "TableName": "t_object_construction_estimate",
                        "ColumnName": "last_updated_label",
                        "GUID": "1397ca71-a9e1-4add-9b2a-395fbf4df628"
                      },
                      "Value": {
                        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                        "SerializeProperty": "=最終更新ラベル"
                      }
                    }
                  ]
                }
              ],
              "ID": "9b4bc306-a407-479e-8377-0906526bd91c"
            }
          ],
          "Comments": "工法ID変更の場合"
        },
        {
          "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
          "ParameterName": "添付関連付け情報",
          "TableValue": {
            "TableName": "t_object_attachment_relation",
            "BindingInfos": [
              {
                "GUID": "6fb3fe49-d523-4730-bc46-e5e11e6266b3",
                "BindingInfo": {
                  "TableName": "t_object_attachment_relation",
                  "ColumnName": "object_id",
                  "GUID": "106b762c-11b1-470e-8ea3-47a5fab798bb"
                },
                "ColumnName": "物件ID"
              }
            ],
            "SqlCondition": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "t_object_attachment_relation",
                "ColumnName": "attachment_id",
                "GUID": "8234994e-f28e-4739-9c1a-1a70ce32dbf0"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=P_添付ID"
              }
            },
            "NullFormulaValueQueryPolicy": 0
          },
          "ID": "e59ac11862f14acf860a3acd6bac407a"
        },
        {
          "$type": "Forguncy.Model.LoopCommand, ServerDesignerCommon",
          "LoopInfo": {
            "$type": "Forguncy.Model.CountLoopInfo, ServerDesignerCommon",
            "LoopCount": {
              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
              "SerializeProperty": "=添付関連付け情報"
            },
            "LoopItemParamName": "Item添付関連付け"
          },
          "CommandList": [
            {
              "$type": "Forguncy.Model.RequestServerCommand, ServerDesignerCommon",
              "ServerCommandName": "ファイル数更新処理",
              "Parameters": [
                {
                  "$type": "Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon",
                  "ParamName": "P_物件IDs",
                  "Value": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=Item添付関連付け.物件ID"
                  }
                }
              ],
              "RefreshAfterFinish": true,
              "CheckDataValidation": true
            }
          ]
        }
      ]
    }
  ]
}